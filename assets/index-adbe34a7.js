var by=Object.defineProperty;var _y=(e,t,n)=>t in e?by(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var cl=(e,t,n)=>(_y(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function rn(){}function wy(e,t){for(const n in t)e[n]=t[n];return e}function am(e){return e()}function td(){return Object.create(null)}function Qo(e){e.forEach(am)}function cm(e){return typeof e=="function"}function Dn(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function $y(e){return Object.keys(e).length===0}function Ey(e,t,n,r){if(e){const s=lm(e,t,n,r);return e[0](s)}}function lm(e,t,n,r){return e[1]&&r?wy(n.ctx.slice(),e[1](r(t))):n.ctx}function xy(e,t,n,r){if(e[2]&&r){const s=e[2](r(n));if(t.dirty===void 0)return s;if(typeof s=="object"){const o=[],i=Math.max(t.dirty.length,s.length);for(let a=0;a<i;a+=1)o[a]=t.dirty[a]|s[a];return o}return t.dirty|s}return t.dirty}function Ay(e,t,n,r,s,o){if(s){const i=lm(t,n,r,o);e.p(i,s)}}function Ty(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let r=0;r<n;r++)t[r]=-1;return t}return-1}function nd(e){return e??""}function Qe(e,t){e.appendChild(t)}function en(e,t,n){e.insertBefore(t,n||null)}function Ht(e){e.parentNode&&e.parentNode.removeChild(e)}function Et(e){return document.createElement(e)}function Nn(e){return document.createTextNode(e)}function bt(){return Nn(" ")}function Da(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function dt(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Sy(e){let t;return{p(...n){t=n,t.forEach(r=>e.push(r))},r(){t.forEach(n=>e.splice(e.indexOf(n),1))}}}function fm(e){return e===""?null:+e}function Py(e){return Array.from(e.childNodes)}function jo(e,t){t=""+t,e.data!==t&&(e.data=t)}function Ca(e,t){e.value=t??""}let Ho;function Xo(e){Ho=e}function Oy(){if(!Ho)throw new Error("Function called outside component initialization");return Ho}function Cy(e){Oy().$$.on_mount.push(e)}const Gs=[],jt=[];let Bs=[];const wf=[],My=Promise.resolve();let $f=!1;function Ly(){$f||($f=!0,My.then(um))}function Ef(e){Bs.push(e)}function an(e){wf.push(e)}const ll=new Set;let As=0;function um(){if(As!==0)return;const e=Ho;do{try{for(;As<Gs.length;){const t=Gs[As];As++,Xo(t),ky(t.$$)}}catch(t){throw Gs.length=0,As=0,t}for(Xo(null),Gs.length=0,As=0;jt.length;)jt.pop()();for(let t=0;t<Bs.length;t+=1){const n=Bs[t];ll.has(n)||(ll.add(n),n())}Bs.length=0}while(Gs.length);for(;wf.length;)wf.pop()();$f=!1,ll.clear(),Xo(e)}function ky(e){if(e.fragment!==null){e.update(),Qo(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ef)}}function Ry(e){const t=[],n=[];Bs.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),Bs=t}const Ta=new Set;let es;function fl(){es={r:0,c:[],p:es}}function ul(){es.r||Qo(es.c),es=es.p}function it(e,t){e&&e.i&&(Ta.delete(e),e.i(t))}function ut(e,t,n,r){if(e&&e.o){if(Ta.has(e))return;Ta.add(e),es.c.push(()=>{Ta.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function cn(e,t,n){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function _t(e){e&&e.c()}function mt(e,t,n){const{fragment:r,after_update:s}=e.$$;r&&r.m(t,n),Ef(()=>{const o=e.$$.on_mount.map(am).filter(cm);e.$$.on_destroy?e.$$.on_destroy.push(...o):Qo(o),e.$$.on_mount=[]}),s.forEach(Ef)}function vt(e,t){const n=e.$$;n.fragment!==null&&(Ry(n.after_update),Qo(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Fy(e,t){e.$$.dirty[0]===-1&&(Gs.push(e),Ly(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Bn(e,t,n,r,s,o,i,a=[-1]){const c=Ho;Xo(e);const l=e.$$={fragment:null,ctx:[],props:o,update:rn,not_equal:s,bound:td(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:td(),dirty:a,skip_bound:!1,root:t.target||c.$$.root};i&&i(l.root);let u=!1;if(l.ctx=n?n(e,t.props||{},(d,h,...m)=>{const w=m.length?m[0]:h;return l.ctx&&s(l.ctx[d],l.ctx[d]=w)&&(!l.skip_bound&&l.bound[d]&&l.bound[d](w),u&&Fy(e,d)),h}):[],l.update(),u=!0,Qo(l.before_update),l.fragment=r?r(l.ctx):!1,t.target){if(t.hydrate){const d=Py(t.target);l.fragment&&l.fragment.l(d),d.forEach(Ht)}else l.fragment&&l.fragment.c();t.intro&&it(e.$$.fragment),mt(e,t.target,t.anchor),um()}Xo(c)}class In{constructor(){cl(this,"$$");cl(this,"$$set")}$destroy(){vt(this,1),this.$destroy=rn}$on(t,n){if(!cm(n))return rn;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(t){this.$$set&&!$y(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Gy="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Gy);function Ny(e){let t;return{c(){t=Et("div"),t.innerHTML='<h1 class="svelte-1chc8t1">Box generator</h1> <p>A simple tool that can be used to generate custom-sized boxes/containers for 3D-printing</p>',dt(t,"class","container svelte-1chc8t1")},m(n,r){en(n,t,r)},p:rn,i:rn,o:rn,d(n){n&&Ht(t)}}}class Dy extends In{constructor(t){super(),Bn(this,t,null,Ny,Dn,{})}}var By=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Iy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Vy=zy;function zy(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var Uy=qy;function qy(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}var Xy=jy;function jy(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}var dm=Hy;function Hy(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var Yy=Wy;function Wy(e,t){if(e===t){var n=t[1],r=t[2],s=t[3],o=t[6],i=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=s,e[13]=i,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}var Zy=Qy;function Qy(e,t){var n=t[0],r=t[1],s=t[2],o=t[3],i=t[4],a=t[5],c=t[6],l=t[7],u=t[8],d=t[9],h=t[10],m=t[11],w=t[12],p=t[13],y=t[14],P=t[15],F=n*a-r*i,L=n*c-s*i,k=n*l-o*i,T=r*c-s*a,R=r*l-o*a,B=s*l-o*c,W=u*p-d*w,se=u*y-h*w,fe=u*P-m*w,ce=d*y-h*p,Oe=d*P-m*p,De=h*P-m*y,we=F*De-L*Oe+k*ce+T*fe-R*se+B*W;return we?(we=1/we,e[0]=(a*De-c*Oe+l*ce)*we,e[1]=(s*Oe-r*De-o*ce)*we,e[2]=(p*B-y*R+P*T)*we,e[3]=(h*R-d*B-m*T)*we,e[4]=(c*fe-i*De-l*se)*we,e[5]=(n*De-s*fe+o*se)*we,e[6]=(y*k-w*B-P*L)*we,e[7]=(u*B-h*k+m*L)*we,e[8]=(i*Oe-a*fe+l*W)*we,e[9]=(r*fe-n*Oe-o*W)*we,e[10]=(w*R-p*k+P*F)*we,e[11]=(d*k-u*R-m*F)*we,e[12]=(a*se-i*ce-c*W)*we,e[13]=(n*ce-r*se+s*W)*we,e[14]=(p*L-w*T-y*F)*we,e[15]=(u*T-d*L+h*F)*we,e):null}var Ky=Jy;function Jy(e,t){var n=t[0],r=t[1],s=t[2],o=t[3],i=t[4],a=t[5],c=t[6],l=t[7],u=t[8],d=t[9],h=t[10],m=t[11],w=t[12],p=t[13],y=t[14],P=t[15];return e[0]=a*(h*P-m*y)-d*(c*P-l*y)+p*(c*m-l*h),e[1]=-(r*(h*P-m*y)-d*(s*P-o*y)+p*(s*m-o*h)),e[2]=r*(c*P-l*y)-a*(s*P-o*y)+p*(s*l-o*c),e[3]=-(r*(c*m-l*h)-a*(s*m-o*h)+d*(s*l-o*c)),e[4]=-(i*(h*P-m*y)-u*(c*P-l*y)+w*(c*m-l*h)),e[5]=n*(h*P-m*y)-u*(s*P-o*y)+w*(s*m-o*h),e[6]=-(n*(c*P-l*y)-i*(s*P-o*y)+w*(s*l-o*c)),e[7]=n*(c*m-l*h)-i*(s*m-o*h)+u*(s*l-o*c),e[8]=i*(d*P-m*p)-u*(a*P-l*p)+w*(a*m-l*d),e[9]=-(n*(d*P-m*p)-u*(r*P-o*p)+w*(r*m-o*d)),e[10]=n*(a*P-l*p)-i*(r*P-o*p)+w*(r*l-o*a),e[11]=-(n*(a*m-l*d)-i*(r*m-o*d)+u*(r*l-o*a)),e[12]=-(i*(d*y-h*p)-u*(a*y-c*p)+w*(a*h-c*d)),e[13]=n*(d*y-h*p)-u*(r*y-s*p)+w*(r*h-s*d),e[14]=-(n*(a*y-c*p)-i*(r*y-s*p)+w*(r*c-s*a)),e[15]=n*(a*h-c*d)-i*(r*h-s*d)+u*(r*c-s*a),e}var e5=t5;function t5(e){var t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],i=e[5],a=e[6],c=e[7],l=e[8],u=e[9],d=e[10],h=e[11],m=e[12],w=e[13],p=e[14],y=e[15],P=t*i-n*o,F=t*a-r*o,L=t*c-s*o,k=n*a-r*i,T=n*c-s*i,R=r*c-s*a,B=l*w-u*m,W=l*p-d*m,se=l*y-h*m,fe=u*p-d*w,ce=u*y-h*w,Oe=d*y-h*p;return P*Oe-F*ce+L*fe+k*se-T*W+R*B}var n5=r5;function r5(e,t,n){var r=t[0],s=t[1],o=t[2],i=t[3],a=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=t[9],m=t[10],w=t[11],p=t[12],y=t[13],P=t[14],F=t[15],L=n[0],k=n[1],T=n[2],R=n[3];return e[0]=L*r+k*a+T*d+R*p,e[1]=L*s+k*c+T*h+R*y,e[2]=L*o+k*l+T*m+R*P,e[3]=L*i+k*u+T*w+R*F,L=n[4],k=n[5],T=n[6],R=n[7],e[4]=L*r+k*a+T*d+R*p,e[5]=L*s+k*c+T*h+R*y,e[6]=L*o+k*l+T*m+R*P,e[7]=L*i+k*u+T*w+R*F,L=n[8],k=n[9],T=n[10],R=n[11],e[8]=L*r+k*a+T*d+R*p,e[9]=L*s+k*c+T*h+R*y,e[10]=L*o+k*l+T*m+R*P,e[11]=L*i+k*u+T*w+R*F,L=n[12],k=n[13],T=n[14],R=n[15],e[12]=L*r+k*a+T*d+R*p,e[13]=L*s+k*c+T*h+R*y,e[14]=L*o+k*l+T*m+R*P,e[15]=L*i+k*u+T*w+R*F,e}var s5=o5;function o5(e,t,n){var r=n[0],s=n[1],o=n[2],i,a,c,l,u,d,h,m,w,p,y,P;return t===e?(e[12]=t[0]*r+t[4]*s+t[8]*o+t[12],e[13]=t[1]*r+t[5]*s+t[9]*o+t[13],e[14]=t[2]*r+t[6]*s+t[10]*o+t[14],e[15]=t[3]*r+t[7]*s+t[11]*o+t[15]):(i=t[0],a=t[1],c=t[2],l=t[3],u=t[4],d=t[5],h=t[6],m=t[7],w=t[8],p=t[9],y=t[10],P=t[11],e[0]=i,e[1]=a,e[2]=c,e[3]=l,e[4]=u,e[5]=d,e[6]=h,e[7]=m,e[8]=w,e[9]=p,e[10]=y,e[11]=P,e[12]=i*r+u*s+w*o+t[12],e[13]=a*r+d*s+p*o+t[13],e[14]=c*r+h*s+y*o+t[14],e[15]=l*r+m*s+P*o+t[15]),e}var i5=a5;function a5(e,t,n){var r=n[0],s=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}var c5=l5;function l5(e,t,n,r){var s=r[0],o=r[1],i=r[2],a=Math.sqrt(s*s+o*o+i*i),c,l,u,d,h,m,w,p,y,P,F,L,k,T,R,B,W,se,fe,ce,Oe,De,we,Xe;return Math.abs(a)<1e-6?null:(a=1/a,s*=a,o*=a,i*=a,c=Math.sin(n),l=Math.cos(n),u=1-l,d=t[0],h=t[1],m=t[2],w=t[3],p=t[4],y=t[5],P=t[6],F=t[7],L=t[8],k=t[9],T=t[10],R=t[11],B=s*s*u+l,W=o*s*u+i*c,se=i*s*u-o*c,fe=s*o*u-i*c,ce=o*o*u+l,Oe=i*o*u+s*c,De=s*i*u+o*c,we=o*i*u-s*c,Xe=i*i*u+l,e[0]=d*B+p*W+L*se,e[1]=h*B+y*W+k*se,e[2]=m*B+P*W+T*se,e[3]=w*B+F*W+R*se,e[4]=d*fe+p*ce+L*Oe,e[5]=h*fe+y*ce+k*Oe,e[6]=m*fe+P*ce+T*Oe,e[7]=w*fe+F*ce+R*Oe,e[8]=d*De+p*we+L*Xe,e[9]=h*De+y*we+k*Xe,e[10]=m*De+P*we+T*Xe,e[11]=w*De+F*we+R*Xe,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}var f5=u5;function u5(e,t,n){var r=Math.sin(n),s=Math.cos(n),o=t[4],i=t[5],a=t[6],c=t[7],l=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*s+l*r,e[5]=i*s+u*r,e[6]=a*s+d*r,e[7]=c*s+h*r,e[8]=l*s-o*r,e[9]=u*s-i*r,e[10]=d*s-a*r,e[11]=h*s-c*r,e}var d5=h5;function h5(e,t,n){var r=Math.sin(n),s=Math.cos(n),o=t[0],i=t[1],a=t[2],c=t[3],l=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*s-l*r,e[1]=i*s-u*r,e[2]=a*s-d*r,e[3]=c*s-h*r,e[8]=o*r+l*s,e[9]=i*r+u*s,e[10]=a*r+d*s,e[11]=c*r+h*s,e}var m5=v5;function v5(e,t,n){var r=Math.sin(n),s=Math.cos(n),o=t[0],i=t[1],a=t[2],c=t[3],l=t[4],u=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*s+l*r,e[1]=i*s+u*r,e[2]=a*s+d*r,e[3]=c*s+h*r,e[4]=l*s-o*r,e[5]=u*s-i*r,e[6]=d*s-a*r,e[7]=h*s-c*r,e}var p5=g5;function g5(e,t,n){var r,s,o,i=n[0],a=n[1],c=n[2],l=Math.sqrt(i*i+a*a+c*c);return Math.abs(l)<1e-6?null:(l=1/l,i*=l,a*=l,c*=l,r=Math.sin(t),s=Math.cos(t),o=1-s,e[0]=i*i*o+s,e[1]=a*i*o+c*r,e[2]=c*i*o-a*r,e[3]=0,e[4]=i*a*o-c*r,e[5]=a*a*o+s,e[6]=c*a*o+i*r,e[7]=0,e[8]=i*c*o+a*r,e[9]=a*c*o-i*r,e[10]=c*c*o+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}var y5=b5;function b5(e,t,n){var r=t[0],s=t[1],o=t[2],i=t[3],a=r+r,c=s+s,l=o+o,u=r*a,d=r*c,h=r*l,m=s*c,w=s*l,p=o*l,y=i*a,P=i*c,F=i*l;return e[0]=1-(m+p),e[1]=d+F,e[2]=h-P,e[3]=0,e[4]=d-F,e[5]=1-(u+p),e[6]=w+y,e[7]=0,e[8]=h+P,e[9]=w-y,e[10]=1-(u+m),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}var _5=w5;function w5(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var $5=E5;function E5(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}var x5=A5;function A5(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var T5=S5;function S5(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var P5=O5;function O5(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var C5=M5;function M5(e,t){var n=t[0],r=t[1],s=t[2],o=t[3],i=n+n,a=r+r,c=s+s,l=n*i,u=r*i,d=r*a,h=s*i,m=s*a,w=s*c,p=o*i,y=o*a,P=o*c;return e[0]=1-d-w,e[1]=u+P,e[2]=h-y,e[3]=0,e[4]=u-P,e[5]=1-l-w,e[6]=m+p,e[7]=0,e[8]=h+y,e[9]=m-p,e[10]=1-l-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var L5=k5;function k5(e,t,n,r,s,o,i){var a=1/(n-t),c=1/(s-r),l=1/(o-i);return e[0]=o*2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*c,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(s+r)*c,e[10]=(i+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=i*o*2*l,e[15]=0,e}var R5=F5;function F5(e,t,n,r,s){var o=1/Math.tan(t/2),i=1/(r-s);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(s+r)*i,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*s*r*i,e[15]=0,e}var G5=N5;function N5(e,t,n,r){var s=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),i=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),c=2/(i+a),l=2/(s+o);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((i-a)*c*.5),e[9]=(s-o)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}var D5=B5;function B5(e,t,n,r,s,o,i){var a=1/(t-n),c=1/(r-s),l=1/(o-i);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*a,e[13]=(s+r)*c,e[14]=(i+o)*l,e[15]=1,e}var I5=dm,V5=z5;function z5(e,t,n,r){var s,o,i,a,c,l,u,d,h,m,w=t[0],p=t[1],y=t[2],P=r[0],F=r[1],L=r[2],k=n[0],T=n[1],R=n[2];return Math.abs(w-k)<1e-6&&Math.abs(p-T)<1e-6&&Math.abs(y-R)<1e-6?I5(e):(u=w-k,d=p-T,h=y-R,m=1/Math.sqrt(u*u+d*d+h*h),u*=m,d*=m,h*=m,s=F*h-L*d,o=L*u-P*h,i=P*d-F*u,m=Math.sqrt(s*s+o*o+i*i),m?(m=1/m,s*=m,o*=m,i*=m):(s=0,o=0,i=0),a=d*i-h*o,c=h*s-u*i,l=u*o-d*s,m=Math.sqrt(a*a+c*c+l*l),m?(m=1/m,a*=m,c*=m,l*=m):(a=0,c=0,l=0),e[0]=s,e[1]=a,e[2]=u,e[3]=0,e[4]=o,e[5]=c,e[6]=d,e[7]=0,e[8]=i,e[9]=l,e[10]=h,e[11]=0,e[12]=-(s*w+o*p+i*y),e[13]=-(a*w+c*p+l*y),e[14]=-(u*w+d*p+h*y),e[15]=1,e)}var U5=q5;function q5(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}var Mn={create:Vy,clone:Uy,copy:Xy,identity:dm,transpose:Yy,invert:Zy,adjoint:Ky,determinant:e5,multiply:n5,translate:s5,scale:i5,rotate:c5,rotateX:f5,rotateY:d5,rotateZ:m5,fromRotation:p5,fromRotationTranslation:y5,fromScaling:_5,fromTranslation:$5,fromXRotation:x5,fromYRotation:T5,fromZRotation:P5,fromQuat:C5,frustum:L5,perspective:R5,perspectiveFromFieldOfView:G5,ortho:D5,lookAt:V5,str:U5};const dl=Mn,X5=(e,t={})=>{const{fbo:n}=t,r={cull:{enable:!0},context:{lightDirection:[.2,.2,1]},uniforms:{view:(s,o)=>o.camera.view,eye:(s,o)=>o.camera.position,projection:(s,o)=>o.camera.projection,camNear:(s,o)=>o.camera.near,camFar:(s,o)=>o.camera.far,invertedView:(s,o)=>dl.invert([],o.camera.view),lightPosition:(s,o)=>o&&o.rendering&&o.rendering.lightPosition?o.rendering.lightPosition:[100,200,100],lightDirection:(s,o)=>o&&o.rendering&&o.rendering.lightDirection?o.rendering.lightDirection:s.lightDirection||[0,0,0],lightView:s=>dl.lookAt([],s.lightDirection,[0,0,0],[0,0,1]),lightProjection:dl.ortho([],-25,-25,-20,20,-25,25),lightColor:(s,o)=>o&&o.rendering&&o.rendering.lightColor?o.rendering.lightColor:[1,.8,0],ambientLightAmount:(s,o)=>o&&o.rendering&&o.rendering.ambientLightAmount?o.rendering.ambientLightAmount:.3,diffuseLightAmount:(s,o)=>o&&o.rendering&&o.rendering.diffuseLightAmount?o&&o.rendering&&o.rendering.diffuseLightAmount:.89,specularLightAmount:(s,o)=>o&&o.rendering&&o.rendering.specularLightAmount?o.rendering.specularLightAmount:.16,uMaterialShininess:(s,o)=>o&&o.rendering&&o.rendering.materialShininess?o.rendering.materialShininess:8,materialAmbient:[.5,.8,.3],materialDiffuse:[.5,.8,.3],materialSpecular:[.5,.8,.3]},framebuffer:n};return e(Object.assign({},r,t.extras))};var j5=X5,Ba={background:[1,1,1,1],meshColor:[0,.6,1,1],lightColor:[1,1,1,1],lightDirection:[.2,.2,1],lightPosition:[100,200,100],ambientLightAmount:.3,diffuseLightAmount:.89,specularLightAmount:.16,materialShininess:8},hl={exports:{}},rd;function H5(){return rd||(rd=1,function(e,t){(function(n,r){e.exports=r()})(By,function(){var n=function(f){return f instanceof Uint8Array||f instanceof Uint16Array||f instanceof Uint32Array||f instanceof Int8Array||f instanceof Int16Array||f instanceof Int32Array||f instanceof Float32Array||f instanceof Float64Array||f instanceof Uint8ClampedArray},r=function(f,g){for(var S=Object.keys(g),X=0;X<S.length;++X)f[S[X]]=g[S[X]];return f},s=`
`;function o(f){return typeof atob<"u"?atob(f):"base64:"+f}function i(f){var g=new Error("(regl) "+f);throw console.error(g),g}function a(f,g){f||i(g)}function c(f){return f?": "+f:""}function l(f,g,S){f in g||i("unknown parameter ("+f+")"+c(S)+". possible values: "+Object.keys(g).join())}function u(f,g){n(f)||i("invalid parameter type"+c(g)+". must be a typed array")}function d(f,g){switch(g){case"number":return typeof f=="number";case"object":return typeof f=="object";case"string":return typeof f=="string";case"boolean":return typeof f=="boolean";case"function":return typeof f=="function";case"undefined":return typeof f>"u";case"symbol":return typeof f=="symbol"}}function h(f,g,S){d(f,g)||i("invalid parameter type"+c(S)+". expected "+g+", got "+typeof f)}function m(f,g){f>=0&&(f|0)===f||i("invalid parameter type, ("+f+")"+c(g)+". must be a nonnegative integer")}function w(f,g,S){g.indexOf(f)<0&&i("invalid value"+c(S)+". must be one of: "+g)}var p=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function y(f){Object.keys(f).forEach(function(g){p.indexOf(g)<0&&i('invalid regl constructor argument "'+g+'". must be one of '+p)})}function P(f,g){for(f=f+"";f.length<g;)f=" "+f;return f}function F(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function L(f,g){this.number=f,this.line=g,this.errors=[]}function k(f,g,S){this.file=f,this.line=g,this.message=S}function T(){var f=new Error,g=(f.stack||f).toString(),S=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(g);if(S)return S[1];var X=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(g);return X?X[1]:"unknown"}function R(){var f=new Error,g=(f.stack||f).toString(),S=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(g);if(S)return S[1];var X=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(g);return X?X[1]:"unknown"}function B(f,g){var S=f.split(`
`),X=1,J=0,q={unknown:new F,0:new F};q.unknown.name=q[0].name=g||T(),q.unknown.lines.push(new L(0,""));for(var Y=0;Y<S.length;++Y){var ie=S[Y],oe=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(ie);if(oe)switch(oe[1]){case"line":var he=/(\d+)(\s+\d+)?/.exec(oe[2]);he&&(X=he[1]|0,he[2]&&(J=he[2]|0,J in q||(q[J]=new F)));break;case"define":var ve=/SHADER_NAME(_B64)?\s+(.*)$/.exec(oe[2]);ve&&(q[J].name=ve[1]?o(ve[2]):ve[2]);break}q[J].lines.push(new L(X++,ie))}return Object.keys(q).forEach(function(me){var ye=q[me];ye.lines.forEach(function(ae){ye.index[ae.number]=ae})}),q}function W(f){var g=[];return f.split(`
`).forEach(function(S){if(!(S.length<5)){var X=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(S);X?g.push(new k(X[1]|0,X[2]|0,X[3].trim())):S.length>0&&g.push(new k("unknown",0,S))}}),g}function se(f,g){g.forEach(function(S){var X=f[S.file];if(X){var J=X.index[S.line];if(J){J.errors.push(S),X.hasErrors=!0;return}}f.unknown.hasErrors=!0,f.unknown.lines[0].errors.push(S)})}function fe(f,g,S,X,J){if(!f.getShaderParameter(g,f.COMPILE_STATUS)){var q=f.getShaderInfoLog(g),Y=X===f.FRAGMENT_SHADER?"fragment":"vertex";gt(S,"string",Y+" shader source must be a string",J);var ie=B(S,J),oe=W(q);se(ie,oe),Object.keys(ie).forEach(function(he){var ve=ie[he];if(!ve.hasErrors)return;var me=[""],ye=[""];function ae(de,D){me.push(de),ye.push(D||"")}ae("file number "+he+": "+ve.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ve.lines.forEach(function(de){if(de.errors.length>0){ae(P(de.number,4)+"|  ","background-color:yellow; font-weight:bold"),ae(de.line+s,"color:red; background-color:yellow; font-weight:bold");var D=0;de.errors.forEach(function(H){var ue=H.message,Se=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ue);if(Se){var re=Se[1];switch(ue=Se[2],re){case"assign":re="=";break}D=Math.max(de.line.indexOf(re,D),0)}else D=0;ae(P("| ",6)),ae(P("^^^",D+3)+s,"font-weight:bold"),ae(P("| ",6)),ae(ue+s,"font-weight:bold")}),ae(P("| ",6)+s)}else ae(P(de.number,4)+"|  "),ae(de.line+s,"color:red")}),typeof document<"u"&&!window.chrome?(ye[0]=me.join("%c"),console.log.apply(console,ye)):console.log(me.join(""))}),a.raise("Error compiling "+Y+" shader, "+ie[0].name)}}function ce(f,g,S,X,J){if(!f.getProgramParameter(g,f.LINK_STATUS)){var q=f.getProgramInfoLog(g),Y=B(S,J),ie=B(X,J),oe='Error linking program with vertex shader, "'+ie[0].name+'", and fragment shader "'+Y[0].name+'"';typeof document<"u"?console.log("%c"+oe+s+"%c"+q,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(oe+s+q),a.raise(oe)}}function Oe(f){f._commandRef=T()}function De(f,g,S,X){Oe(f);function J(oe){return oe?X.id(oe):0}f._fragId=J(f.static.frag),f._vertId=J(f.static.vert);function q(oe,he){Object.keys(he).forEach(function(ve){oe[X.id(ve)]=!0})}var Y=f._uniformSet={};q(Y,g.static),q(Y,g.dynamic);var ie=f._attributeSet={};q(ie,S.static),q(ie,S.dynamic),f._hasCount="count"in f.static||"count"in f.dynamic||"elements"in f.static||"elements"in f.dynamic}function we(f,g){var S=R();i(f+" in command "+(g||T())+(S==="unknown"?"":" called from "+S))}function Xe(f,g,S){f||we(g,S||T())}function Fe(f,g,S,X){f in g||we("unknown parameter ("+f+")"+c(S)+". possible values: "+Object.keys(g).join(),X||T())}function gt(f,g,S,X){d(f,g)||we("invalid parameter type"+c(S)+". expected "+g+", got "+typeof f,X||T())}function kt(f){f()}function Ln(f,g,S){f.texture?w(f.texture._texture.internalformat,g,"unsupported texture format for attachment"):w(f.renderbuffer._renderbuffer.format,S,"unsupported renderbuffer format for attachment")}var qt=33071,Pn=9728,$n=9984,on=9985,rr=9986,oi=9987,Vn=5120,Zs=5121,ii=5122,ur=5123,ai=5124,zn=5125,is=5126,Qs=32819,kn=32820,as=33635,Ks=34042,Un=36193,tn={};tn[Vn]=tn[Zs]=1,tn[ii]=tn[ur]=tn[Un]=tn[as]=tn[Qs]=tn[kn]=2,tn[ai]=tn[zn]=tn[is]=tn[Ks]=4;function Cr(f,g){return f===kn||f===Qs||f===as?2:f===Ks?4:tn[f]*g}function Mr(f){return!(f&f-1)&&!!f}function qn(f,g,S){var X,J=g.width,q=g.height,Y=g.channels;a(J>0&&J<=S.maxTextureSize&&q>0&&q<=S.maxTextureSize,"invalid texture shape"),(f.wrapS!==qt||f.wrapT!==qt)&&a(Mr(J)&&Mr(q),"incompatible wrap mode for texture, both width and height must be power of 2"),g.mipmask===1?J!==1&&q!==1&&a(f.minFilter!==$n&&f.minFilter!==rr&&f.minFilter!==on&&f.minFilter!==oi,"min filter requires mipmap"):(a(Mr(J)&&Mr(q),"texture must be a square power of 2 to support mipmapping"),a(g.mipmask===(J<<1)-1,"missing or incomplete mipmap data")),g.type===is&&(S.extensions.indexOf("oes_texture_float_linear")<0&&a(f.minFilter===Pn&&f.magFilter===Pn,"filter not supported, must enable oes_texture_float_linear"),a(!f.genMipmaps,"mipmap generation not supported with float textures"));var ie=g.images;for(X=0;X<16;++X)if(ie[X]){var oe=J>>X,he=q>>X;a(g.mipmask&1<<X,"missing mipmap data");var ve=ie[X];if(a(ve.width===oe&&ve.height===he,"invalid shape for mip images"),a(ve.format===g.format&&ve.internalformat===g.internalformat&&ve.type===g.type,"incompatible type for mip image"),!ve.compressed)if(ve.data){var me=Math.ceil(Cr(ve.type,Y)*oe/ve.unpackAlignment)*ve.unpackAlignment;a(ve.data.byteLength===me*he,"invalid data for image, buffer size is inconsistent with image format")}else ve.element||ve.copy}else f.genMipmaps||a((g.mipmask&1<<X)===0,"extra mipmap data");g.compressed&&a(!f.genMipmaps,"mipmap generation for compressed images not supported")}function ci(f,g,S,X){var J=f.width,q=f.height,Y=f.channels;a(J>0&&J<=X.maxTextureSize&&q>0&&q<=X.maxTextureSize,"invalid texture shape"),a(J===q,"cube map must be square"),a(g.wrapS===qt&&g.wrapT===qt,"wrap mode not supported by cube map");for(var ie=0;ie<S.length;++ie){var oe=S[ie];a(oe.width===J&&oe.height===q,"inconsistent cube map face shape"),g.genMipmaps&&(a(!oe.compressed,"can not generate mipmap for compressed textures"),a(oe.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var he=oe.images,ve=0;ve<16;++ve){var me=he[ve];if(me){var ye=J>>ve,ae=q>>ve;a(oe.mipmask&1<<ve,"missing mipmap data"),a(me.width===ye&&me.height===ae,"invalid shape for mip images"),a(me.format===f.format&&me.internalformat===f.internalformat&&me.type===f.type,"incompatible type for mip image"),me.compressed||(me.data?a(me.data.byteLength===ye*ae*Math.max(Cr(me.type,Y),me.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):me.element||me.copy)}}}}var b=r(a,{optional:kt,raise:i,commandRaise:we,command:Xe,parameter:l,commandParameter:Fe,constructor:y,type:h,commandType:gt,isTypedArray:u,nni:m,oneOf:w,shaderError:fe,linkError:ce,callSite:R,saveCommandRef:Oe,saveDrawInfo:De,framebufferFormat:Ln,guessCommand:T,texture2D:qn,textureCube:ci}),li=0,ic=0,fi=5,ac=6;function Xn(f,g){this.id=li++,this.type=f,this.data=g}function Js(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function vn(f){if(f.length===0)return[];var g=f.charAt(0),S=f.charAt(f.length-1);if(f.length>1&&g===S&&(g==='"'||g==="'"))return['"'+Js(f.substr(1,f.length-2))+'"'];var X=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(f);if(X)return vn(f.substr(0,X.index)).concat(vn(X[1])).concat(vn(f.substr(X.index+X[0].length)));var J=f.split(".");if(J.length===1)return['"'+Js(f)+'"'];for(var q=[],Y=0;Y<J.length;++Y)q=q.concat(vn(J[Y]));return q}function eo(f){return"["+vn(f).join("][")+"]"}function cc(f,g){return new Xn(f,eo(g+""))}function ui(f){return typeof f=="function"&&!f._reglType||f instanceof Xn}function Gt(f,g){if(typeof f=="function")return new Xn(ic,f);if(typeof f=="number"||typeof f=="boolean")return new Xn(fi,f);if(Array.isArray(f))return new Xn(ac,f.map(function(S,X){return Gt(S,g+"["+X+"]")}));if(f instanceof Xn)return f;b(!1,"invalid option type in uniform "+g)}var ln={DynamicVariable:Xn,define:cc,isDynamic:ui,unbox:Gt,accessor:eo},cs={next:typeof requestAnimationFrame=="function"?function(f){return requestAnimationFrame(f)}:function(f){return setTimeout(f,16)},cancel:typeof cancelAnimationFrame=="function"?function(f){return cancelAnimationFrame(f)}:clearTimeout},di=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function hi(){var f={"":0},g=[""];return{id:function(S){var X=f[S];return X||(X=f[S]=g.length,g.push(S),X)},str:function(S){return g[S]}}}function lc(f,g,S){var X=document.createElement("canvas");r(X.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),f.appendChild(X),f===document.body&&(X.style.position="absolute",r(f.style,{margin:0,padding:0}));function J(){var ie=window.innerWidth,oe=window.innerHeight;if(f!==document.body){var he=X.getBoundingClientRect();ie=he.right-he.left,oe=he.bottom-he.top}X.width=S*ie,X.height=S*oe}var q;f!==document.body&&typeof ResizeObserver=="function"?(q=new ResizeObserver(function(){setTimeout(J)}),q.observe(f)):window.addEventListener("resize",J,!1);function Y(){q?q.disconnect():window.removeEventListener("resize",J),f.removeChild(X)}return J(),{canvas:X,onDestroy:Y}}function mi(f,g){function S(X){try{return f.getContext(X,g)}catch{return null}}return S("webgl")||S("experimental-webgl")||S("webgl-experimental")}function fc(f){return typeof f.nodeName=="string"&&typeof f.appendChild=="function"&&typeof f.getBoundingClientRect=="function"}function vi(f){return typeof f.drawArrays=="function"||typeof f.drawElements=="function"}function pi(f){return typeof f=="string"?f.split():(b(Array.isArray(f),"invalid extension array"),f)}function to(f){return typeof f=="string"?(b(typeof document<"u","not supported outside of DOM"),document.querySelector(f)):f}function uc(f){var g=f||{},S,X,J,q,Y={},ie=[],oe=[],he=typeof window>"u"?1:window.devicePixelRatio,ve=!1,me=function(de){de&&b.raise(de)},ye=function(){};if(typeof g=="string"?(b(typeof document<"u","selector queries only supported in DOM enviroments"),S=document.querySelector(g),b(S,"invalid query string for element")):typeof g=="object"?fc(g)?S=g:vi(g)?(q=g,J=q.canvas):(b.constructor(g),"gl"in g?q=g.gl:"canvas"in g?J=to(g.canvas):"container"in g&&(X=to(g.container)),"attributes"in g&&(Y=g.attributes,b.type(Y,"object","invalid context attributes")),"extensions"in g&&(ie=pi(g.extensions)),"optionalExtensions"in g&&(oe=pi(g.optionalExtensions)),"onDone"in g&&(b.type(g.onDone,"function","invalid or missing onDone callback"),me=g.onDone),"profile"in g&&(ve=!!g.profile),"pixelRatio"in g&&(he=+g.pixelRatio,b(he>0,"invalid pixel ratio"))):b.raise("invalid arguments to regl"),S&&(S.nodeName.toLowerCase()==="canvas"?J=S:X=S),!q){if(!J){b(typeof document<"u","must manually specify webgl context outside of DOM environments");var ae=lc(X||document.body,me,he);if(!ae)return null;J=ae.canvas,ye=ae.onDestroy}Y.premultipliedAlpha===void 0&&(Y.premultipliedAlpha=!0),q=mi(J,Y)}return q?{gl:q,canvas:J,container:X,extensions:ie,optionalExtensions:oe,pixelRatio:he,profile:ve,onDone:me,onDestroy:ye}:(ye(),me("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function gi(f,g){var S={};function X(Y){b.type(Y,"string","extension name must be string");var ie=Y.toLowerCase(),oe;try{oe=S[ie]=f.getExtension(ie)}catch{}return!!oe}for(var J=0;J<g.extensions.length;++J){var q=g.extensions[J];if(!X(q))return g.onDestroy(),g.onDone('"'+q+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return g.optionalExtensions.forEach(X),{extensions:S,restore:function(){Object.keys(S).forEach(function(Y){if(S[Y]&&!X(Y))throw new Error("(regl): error restoring extension "+Y)})}}}function pe(f,g){for(var S=Array(f),X=0;X<f;++X)S[X]=g(X);return S}var ht=5120,no=5121,yi=5122,bi=5123,_i=5124,wi=5125,$i=5126;function ro(f){for(var g=16;g<=1<<28;g*=16)if(f<=g)return g;return 0}function ls(f){var g,S;return g=(f>65535)<<4,f>>>=g,S=(f>255)<<3,f>>>=S,g|=S,S=(f>15)<<2,f>>>=S,g|=S,S=(f>3)<<1,f>>>=S,g|=S,g|f>>1}function so(){var f=pe(8,function(){return[]});function g(q){var Y=ro(q),ie=f[ls(Y)>>2];return ie.length>0?ie.pop():new ArrayBuffer(Y)}function S(q){f[ls(q.byteLength)>>2].push(q)}function X(q,Y){var ie=null;switch(q){case ht:ie=new Int8Array(g(Y),0,Y);break;case no:ie=new Uint8Array(g(Y),0,Y);break;case yi:ie=new Int16Array(g(2*Y),0,Y);break;case bi:ie=new Uint16Array(g(2*Y),0,Y);break;case _i:ie=new Int32Array(g(4*Y),0,Y);break;case wi:ie=new Uint32Array(g(4*Y),0,Y);break;case $i:ie=new Float32Array(g(4*Y),0,Y);break;default:return null}return ie.length!==Y?ie.subarray(0,Y):ie}function J(q){S(q.buffer)}return{alloc:g,free:S,allocType:X,freeType:J}}var St=so();St.zero=so();var Ei=3408,xi=3410,Ai=3411,oo=3412,io=3413,ao=3414,Lp=3415,kp=33901,Rp=33902,Fp=3379,Gp=3386,Np=34921,Dp=36347,Bp=36348,Ip=35661,Vp=35660,zp=34930,Up=36349,qp=34076,Xp=34024,jp=7936,Hp=7937,Yp=7938,Wp=35724,Zp=34047,Qp=36063,Kp=34852,Ti=3553,uu=34067,Jp=34069,eg=33984,co=6408,dc=5126,du=5121,hc=36160,tg=36053,ng=36064,rg=16384,sg=function(f,g){var S=1;g.ext_texture_filter_anisotropic&&(S=f.getParameter(Zp));var X=1,J=1;g.webgl_draw_buffers&&(X=f.getParameter(Kp),J=f.getParameter(Qp));var q=!!g.oes_texture_float;if(q){var Y=f.createTexture();f.bindTexture(Ti,Y),f.texImage2D(Ti,0,co,1,1,0,co,dc,null);var ie=f.createFramebuffer();if(f.bindFramebuffer(hc,ie),f.framebufferTexture2D(hc,ng,Ti,Y,0),f.bindTexture(Ti,null),f.checkFramebufferStatus(hc)!==tg)q=!1;else{f.viewport(0,0,1,1),f.clearColor(1,0,0,1),f.clear(rg);var oe=St.allocType(dc,4);f.readPixels(0,0,1,1,co,dc,oe),f.getError()?q=!1:(f.deleteFramebuffer(ie),f.deleteTexture(Y),q=oe[0]===1),St.freeType(oe)}}var he=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ve=!0;if(!he){var me=f.createTexture(),ye=St.allocType(du,36);f.activeTexture(eg),f.bindTexture(uu,me),f.texImage2D(Jp,0,co,3,3,0,co,du,ye),St.freeType(ye),f.bindTexture(uu,null),f.deleteTexture(me),ve=!f.getError()}return{colorBits:[f.getParameter(xi),f.getParameter(Ai),f.getParameter(oo),f.getParameter(io)],depthBits:f.getParameter(ao),stencilBits:f.getParameter(Lp),subpixelBits:f.getParameter(Ei),extensions:Object.keys(g).filter(function(ae){return!!g[ae]}),maxAnisotropic:S,maxDrawbuffers:X,maxColorAttachments:J,pointSizeDims:f.getParameter(kp),lineWidthDims:f.getParameter(Rp),maxViewportDims:f.getParameter(Gp),maxCombinedTextureUnits:f.getParameter(Ip),maxCubeMapSize:f.getParameter(qp),maxRenderbufferSize:f.getParameter(Xp),maxTextureUnits:f.getParameter(zp),maxTextureSize:f.getParameter(Fp),maxAttributes:f.getParameter(Np),maxVertexUniforms:f.getParameter(Dp),maxVertexTextureUnits:f.getParameter(Vp),maxVaryingVectors:f.getParameter(Bp),maxFragmentUniforms:f.getParameter(Up),glsl:f.getParameter(Wp),renderer:f.getParameter(Hp),vendor:f.getParameter(jp),version:f.getParameter(Yp),readFloat:q,npotTextureCube:ve}};function Rn(f){return!!f&&typeof f=="object"&&Array.isArray(f.shape)&&Array.isArray(f.stride)&&typeof f.offset=="number"&&f.shape.length===f.stride.length&&(Array.isArray(f.data)||n(f.data))}var En=function(f){return Object.keys(f).map(function(g){return f[g]})},Si={shape:cg,flatten:ag};function og(f,g,S){for(var X=0;X<g;++X)S[X]=f[X]}function ig(f,g,S,X){for(var J=0,q=0;q<g;++q)for(var Y=f[q],ie=0;ie<S;++ie)X[J++]=Y[ie]}function hu(f,g,S,X,J,q){for(var Y=q,ie=0;ie<g;++ie)for(var oe=f[ie],he=0;he<S;++he)for(var ve=oe[he],me=0;me<X;++me)J[Y++]=ve[me]}function mu(f,g,S,X,J){for(var q=1,Y=S+1;Y<g.length;++Y)q*=g[Y];var ie=g[S];if(g.length-S===4){var oe=g[S+1],he=g[S+2],ve=g[S+3];for(Y=0;Y<ie;++Y)hu(f[Y],oe,he,ve,X,J),J+=q}else for(Y=0;Y<ie;++Y)mu(f[Y],g,S+1,X,J),J+=q}function ag(f,g,S,X){var J=1;if(g.length)for(var q=0;q<g.length;++q)J*=g[q];else J=0;var Y=X||St.allocType(S,J);switch(g.length){case 0:break;case 1:og(f,g[0],Y);break;case 2:ig(f,g[0],g[1],Y);break;case 3:hu(f,g[0],g[1],g[2],Y,0);break;default:mu(f,g,0,Y,0)}return Y}function cg(f){for(var g=[],S=f;S.length;S=S[0])g.push(S.length);return g}var mc={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},lg=5120,fg=5122,ug=5124,dg=5121,hg=5123,mg=5125,vg=5126,pg=5126,Lr={int8:lg,int16:fg,int32:ug,uint8:dg,uint16:hg,uint32:mg,float:vg,float32:pg},gg=35048,yg=35040,Pi={dynamic:gg,stream:yg,static:35044},vc=Si.flatten,vu=Si.shape,pu=35044,bg=35040,pc=5121,gc=5126,dr=[];dr[5120]=1,dr[5122]=2,dr[5124]=4,dr[5121]=1,dr[5123]=2,dr[5125]=4,dr[5126]=4;function Oi(f){return mc[Object.prototype.toString.call(f)]|0}function gu(f,g){for(var S=0;S<g.length;++S)f[S]=g[S]}function yu(f,g,S,X,J,q,Y){for(var ie=0,oe=0;oe<S;++oe)for(var he=0;he<X;++he)f[ie++]=g[J*oe+q*he+Y]}function _g(f,g,S,X){var J=0,q={};function Y(D){this.id=J++,this.buffer=f.createBuffer(),this.type=D,this.usage=pu,this.byteLength=0,this.dimension=1,this.dtype=pc,this.persistentData=null,S.profile&&(this.stats={size:0})}Y.prototype.bind=function(){f.bindBuffer(this.type,this.buffer)},Y.prototype.destroy=function(){ye(this)};var ie=[];function oe(D,H){var ue=ie.pop();return ue||(ue=new Y(D)),ue.bind(),me(ue,H,bg,0,1,!1),ue}function he(D){ie.push(D)}function ve(D,H,ue){D.byteLength=H.byteLength,f.bufferData(D.type,H,ue)}function me(D,H,ue,Se,re,Ae){var Ee;if(D.usage=ue,Array.isArray(H)){if(D.dtype=Se||gc,H.length>0){var Ne;if(Array.isArray(H[0])){Ee=vu(H);for(var ee=1,K=1;K<Ee.length;++K)ee*=Ee[K];D.dimension=ee,Ne=vc(H,Ee,D.dtype),ve(D,Ne,ue),Ae?D.persistentData=Ne:St.freeType(Ne)}else if(typeof H[0]=="number"){D.dimension=re;var Me=St.allocType(D.dtype,H.length);gu(Me,H),ve(D,Me,ue),Ae?D.persistentData=Me:St.freeType(Me)}else n(H[0])?(D.dimension=H[0].length,D.dtype=Se||Oi(H[0])||gc,Ne=vc(H,[H.length,H[0].length],D.dtype),ve(D,Ne,ue),Ae?D.persistentData=Ne:St.freeType(Ne)):b.raise("invalid buffer data")}}else if(n(H))D.dtype=Se||Oi(H),D.dimension=re,ve(D,H,ue),Ae&&(D.persistentData=new Uint8Array(new Uint8Array(H.buffer)));else if(Rn(H)){Ee=H.shape;var be=H.stride,le=H.offset,_e=0,$e=0,He=0,je=0;Ee.length===1?(_e=Ee[0],$e=1,He=be[0],je=0):Ee.length===2?(_e=Ee[0],$e=Ee[1],He=be[0],je=be[1]):b.raise("invalid shape"),D.dtype=Se||Oi(H.data)||gc,D.dimension=$e;var xe=St.allocType(D.dtype,_e*$e);yu(xe,H.data,_e,$e,He,je,le),ve(D,xe,ue),Ae?D.persistentData=xe:St.freeType(xe)}else H instanceof ArrayBuffer?(D.dtype=pc,D.dimension=re,ve(D,H,ue),Ae&&(D.persistentData=new Uint8Array(new Uint8Array(H)))):b.raise("invalid buffer data")}function ye(D){g.bufferCount--,X(D);var H=D.buffer;b(H,"buffer must not be deleted already"),f.deleteBuffer(H),D.buffer=null,delete q[D.id]}function ae(D,H,ue,Se){g.bufferCount++;var re=new Y(H);q[re.id]=re;function Ae(ee){var K=pu,Me=null,be=0,le=0,_e=1;return Array.isArray(ee)||n(ee)||Rn(ee)||ee instanceof ArrayBuffer?Me=ee:typeof ee=="number"?be=ee|0:ee&&(b.type(ee,"object","buffer arguments must be an object, a number or an array"),"data"in ee&&(b(Me===null||Array.isArray(Me)||n(Me)||Rn(Me),"invalid data for buffer"),Me=ee.data),"usage"in ee&&(b.parameter(ee.usage,Pi,"invalid buffer usage"),K=Pi[ee.usage]),"type"in ee&&(b.parameter(ee.type,Lr,"invalid buffer type"),le=Lr[ee.type]),"dimension"in ee&&(b.type(ee.dimension,"number","invalid dimension"),_e=ee.dimension|0),"length"in ee&&(b.nni(be,"buffer length must be a nonnegative integer"),be=ee.length|0)),re.bind(),Me?me(re,Me,K,le,_e,Se):(be&&f.bufferData(re.type,be,K),re.dtype=le||pc,re.usage=K,re.dimension=_e,re.byteLength=be),S.profile&&(re.stats.size=re.byteLength*dr[re.dtype]),Ae}function Ee(ee,K){b(K+ee.byteLength<=re.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+ee.byteLength+" starting from offset "+K+" to a buffer of size "+re.byteLength),f.bufferSubData(re.type,K,ee)}function Ne(ee,K){var Me=(K||0)|0,be;if(re.bind(),n(ee)||ee instanceof ArrayBuffer)Ee(ee,Me);else if(Array.isArray(ee)){if(ee.length>0)if(typeof ee[0]=="number"){var le=St.allocType(re.dtype,ee.length);gu(le,ee),Ee(le,Me),St.freeType(le)}else if(Array.isArray(ee[0])||n(ee[0])){be=vu(ee);var _e=vc(ee,be,re.dtype);Ee(_e,Me),St.freeType(_e)}else b.raise("invalid buffer data")}else if(Rn(ee)){be=ee.shape;var $e=ee.stride,He=0,je=0,xe=0,Te=0;be.length===1?(He=be[0],je=1,xe=$e[0],Te=0):be.length===2?(He=be[0],je=be[1],xe=$e[0],Te=$e[1]):b.raise("invalid shape");var Ie=Array.isArray(ee.data)?re.dtype:Oi(ee.data),Ye=St.allocType(Ie,He*je);yu(Ye,ee.data,He,je,xe,Te,ee.offset),Ee(Ye,Me),St.freeType(Ye)}else b.raise("invalid data for buffer subdata");return Ae}return ue||Ae(D),Ae._reglType="buffer",Ae._buffer=re,Ae.subdata=Ne,S.profile&&(Ae.stats=re.stats),Ae.destroy=function(){ye(re)},Ae}function de(){En(q).forEach(function(D){D.buffer=f.createBuffer(),f.bindBuffer(D.type,D.buffer),f.bufferData(D.type,D.persistentData||D.byteLength,D.usage)})}return S.profile&&(g.getTotalBufferSize=function(){var D=0;return Object.keys(q).forEach(function(H){D+=q[H].stats.size}),D}),{create:ae,createStream:oe,destroyStream:he,clear:function(){En(q).forEach(ye),ie.forEach(ye)},getBuffer:function(D){return D&&D._buffer instanceof Y?D._buffer:null},restore:de,_initBuffer:me}}var wg=0,$g=0,Eg=1,xg=1,Ag=4,Tg=4,hr={points:wg,point:$g,lines:Eg,line:xg,triangles:Ag,triangle:Tg,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Sg=0,Pg=1,lo=4,Og=5120,fs=5121,bu=5122,us=5123,_u=5124,kr=5125,yc=34963,Cg=35040,Mg=35044;function Lg(f,g,S,X){var J={},q=0,Y={uint8:fs,uint16:us};g.oes_element_index_uint&&(Y.uint32=kr);function ie(de){this.id=q++,J[this.id]=this,this.buffer=de,this.primType=lo,this.vertCount=0,this.type=0}ie.prototype.bind=function(){this.buffer.bind()};var oe=[];function he(de){var D=oe.pop();return D||(D=new ie(S.create(null,yc,!0,!1)._buffer)),me(D,de,Cg,-1,-1,0,0),D}function ve(de){oe.push(de)}function me(de,D,H,ue,Se,re,Ae){de.buffer.bind();var Ee;if(D){var Ne=Ae;!Ae&&(!n(D)||Rn(D)&&!n(D.data))&&(Ne=g.oes_element_index_uint?kr:us),S._initBuffer(de.buffer,D,H,Ne,3)}else f.bufferData(yc,re,H),de.buffer.dtype=Ee||fs,de.buffer.usage=H,de.buffer.dimension=3,de.buffer.byteLength=re;if(Ee=Ae,!Ae){switch(de.buffer.dtype){case fs:case Og:Ee=fs;break;case us:case bu:Ee=us;break;case kr:case _u:Ee=kr;break;default:b.raise("unsupported type for element array")}de.buffer.dtype=Ee}de.type=Ee,b(Ee!==kr||!!g.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var ee=Se;ee<0&&(ee=de.buffer.byteLength,Ee===us?ee>>=1:Ee===kr&&(ee>>=2)),de.vertCount=ee;var K=ue;if(ue<0){K=lo;var Me=de.buffer.dimension;Me===1&&(K=Sg),Me===2&&(K=Pg),Me===3&&(K=lo)}de.primType=K}function ye(de){X.elementsCount--,b(de.buffer!==null,"must not double destroy elements"),delete J[de.id],de.buffer.destroy(),de.buffer=null}function ae(de,D){var H=S.create(null,yc,!0),ue=new ie(H._buffer);X.elementsCount++;function Se(re){if(!re)H(),ue.primType=lo,ue.vertCount=0,ue.type=fs;else if(typeof re=="number")H(re),ue.primType=lo,ue.vertCount=re|0,ue.type=fs;else{var Ae=null,Ee=Mg,Ne=-1,ee=-1,K=0,Me=0;Array.isArray(re)||n(re)||Rn(re)?Ae=re:(b.type(re,"object","invalid arguments for elements"),"data"in re&&(Ae=re.data,b(Array.isArray(Ae)||n(Ae)||Rn(Ae),"invalid data for element buffer")),"usage"in re&&(b.parameter(re.usage,Pi,"invalid element buffer usage"),Ee=Pi[re.usage]),"primitive"in re&&(b.parameter(re.primitive,hr,"invalid element buffer primitive"),Ne=hr[re.primitive]),"count"in re&&(b(typeof re.count=="number"&&re.count>=0,"invalid vertex count for elements"),ee=re.count|0),"type"in re&&(b.parameter(re.type,Y,"invalid buffer type"),Me=Y[re.type]),"length"in re?K=re.length|0:(K=ee,Me===us||Me===bu?K*=2:(Me===kr||Me===_u)&&(K*=4))),me(ue,Ae,Ee,Ne,ee,K,Me)}return Se}return Se(de),Se._reglType="elements",Se._elements=ue,Se.subdata=function(re,Ae){return H.subdata(re,Ae),Se},Se.destroy=function(){ye(ue)},Se}return{create:ae,createStream:he,destroyStream:ve,getElements:function(de){return typeof de=="function"&&de._elements instanceof ie?de._elements:null},clear:function(){En(J).forEach(ye)}}}var wu=new Float32Array(1),kg=new Uint32Array(wu.buffer),Rg=5123;function $u(f){for(var g=St.allocType(Rg,f.length),S=0;S<f.length;++S)if(isNaN(f[S]))g[S]=65535;else if(f[S]===1/0)g[S]=31744;else if(f[S]===-1/0)g[S]=64512;else{wu[0]=f[S];var X=kg[0],J=X>>>31<<15,q=(X<<1>>>24)-127,Y=X>>13&1024-1;if(q<-24)g[S]=J;else if(q<-14){var ie=-14-q;g[S]=J+(Y+1024>>ie)}else q>15?g[S]=J+31744:g[S]=J+(q+15<<10)+Y}return g}function At(f){return Array.isArray(f)||n(f)}var Eu=function(f){return!(f&f-1)&&!!f},Fg=34467,jn=3553,bc=34067,Ci=34069,Rr=6408,_c=6406,Mi=6407,fo=6409,Li=6410,xu=32854,wc=32855,Au=36194,Gg=32819,Ng=32820,Dg=33635,Bg=34042,$c=6402,ki=34041,Ec=35904,xc=35906,ds=36193,Ac=33776,Tc=33777,Sc=33778,Pc=33779,Tu=35986,Su=35987,Pu=34798,Ou=35840,Cu=35841,Mu=35842,Lu=35843,ku=36196,hs=5121,Oc=5123,Cc=5125,uo=5126,Ig=10242,Vg=10243,zg=10497,Mc=33071,Ug=33648,qg=10240,Xg=10241,Lc=9728,jg=9729,kc=9984,Ru=9985,Fu=9986,Rc=9987,Hg=33170,Ri=4352,Yg=4353,Wg=4354,Zg=34046,Qg=3317,Kg=37440,Jg=37441,e2=37443,Gu=37444,ho=33984,t2=[kc,Fu,Ru,Rc],Fi=[0,fo,Li,Mi,Rr],On={};On[fo]=On[_c]=On[$c]=1,On[ki]=On[Li]=2,On[Mi]=On[Ec]=3,On[Rr]=On[xc]=4;function ms(f){return"[object "+f+"]"}var Nu=ms("HTMLCanvasElement"),Du=ms("OffscreenCanvas"),Bu=ms("CanvasRenderingContext2D"),Iu=ms("ImageBitmap"),Vu=ms("HTMLImageElement"),zu=ms("HTMLVideoElement"),n2=Object.keys(mc).concat([Nu,Du,Bu,Iu,Vu,zu]),vs=[];vs[hs]=1,vs[uo]=4,vs[ds]=2,vs[Oc]=2,vs[Cc]=4;var Wt=[];Wt[xu]=2,Wt[wc]=2,Wt[Au]=2,Wt[ki]=4,Wt[Ac]=.5,Wt[Tc]=.5,Wt[Sc]=1,Wt[Pc]=1,Wt[Tu]=.5,Wt[Su]=1,Wt[Pu]=1,Wt[Ou]=.5,Wt[Cu]=.25,Wt[Mu]=.5,Wt[Lu]=.25,Wt[ku]=.5;function Uu(f){return Array.isArray(f)&&(f.length===0||typeof f[0]=="number")}function qu(f){if(!Array.isArray(f))return!1;var g=f.length;return!(g===0||!At(f[0]))}function Fr(f){return Object.prototype.toString.call(f)}function Xu(f){return Fr(f)===Nu}function ju(f){return Fr(f)===Du}function r2(f){return Fr(f)===Bu}function s2(f){return Fr(f)===Iu}function o2(f){return Fr(f)===Vu}function i2(f){return Fr(f)===zu}function Fc(f){if(!f)return!1;var g=Fr(f);return n2.indexOf(g)>=0?!0:Uu(f)||qu(f)||Rn(f)}function Hu(f){return mc[Object.prototype.toString.call(f)]|0}function a2(f,g){var S=g.length;switch(f.type){case hs:case Oc:case Cc:case uo:var X=St.allocType(f.type,S);X.set(g),f.data=X;break;case ds:f.data=$u(g);break;default:b.raise("unsupported texture type, must specify a typed array")}}function Yu(f,g){return St.allocType(f.type===ds?uo:f.type,g)}function Wu(f,g){f.type===ds?(f.data=$u(g),St.freeType(g)):f.data=g}function c2(f,g,S,X,J,q){for(var Y=f.width,ie=f.height,oe=f.channels,he=Y*ie*oe,ve=Yu(f,he),me=0,ye=0;ye<ie;++ye)for(var ae=0;ae<Y;++ae)for(var de=0;de<oe;++de)ve[me++]=g[S*ae+X*ye+J*de+q];Wu(f,ve)}function Gi(f,g,S,X,J,q){var Y;if(typeof Wt[f]<"u"?Y=Wt[f]:Y=On[f]*vs[g],q&&(Y*=6),J){for(var ie=0,oe=S;oe>=1;)ie+=Y*oe*oe,oe/=2;return ie}else return Y*S*X}function l2(f,g,S,X,J,q,Y){var ie={"don't care":Ri,"dont care":Ri,nice:Wg,fast:Yg},oe={repeat:zg,clamp:Mc,mirror:Ug},he={nearest:Lc,linear:jg},ve=r({mipmap:Rc,"nearest mipmap nearest":kc,"linear mipmap nearest":Ru,"nearest mipmap linear":Fu,"linear mipmap linear":Rc},he),me={none:0,browser:Gu},ye={uint8:hs,rgba4:Gg,rgb565:Dg,"rgb5 a1":Ng},ae={alpha:_c,luminance:fo,"luminance alpha":Li,rgb:Mi,rgba:Rr,rgba4:xu,"rgb5 a1":wc,rgb565:Au},de={};g.ext_srgb&&(ae.srgb=Ec,ae.srgba=xc),g.oes_texture_float&&(ye.float32=ye.float=uo),g.oes_texture_half_float&&(ye.float16=ye["half float"]=ds),g.webgl_depth_texture&&(r(ae,{depth:$c,"depth stencil":ki}),r(ye,{uint16:Oc,uint32:Cc,"depth stencil":Bg})),g.webgl_compressed_texture_s3tc&&r(de,{"rgb s3tc dxt1":Ac,"rgba s3tc dxt1":Tc,"rgba s3tc dxt3":Sc,"rgba s3tc dxt5":Pc}),g.webgl_compressed_texture_atc&&r(de,{"rgb atc":Tu,"rgba atc explicit alpha":Su,"rgba atc interpolated alpha":Pu}),g.webgl_compressed_texture_pvrtc&&r(de,{"rgb pvrtc 4bppv1":Ou,"rgb pvrtc 2bppv1":Cu,"rgba pvrtc 4bppv1":Mu,"rgba pvrtc 2bppv1":Lu}),g.webgl_compressed_texture_etc1&&(de["rgb etc1"]=ku);var D=Array.prototype.slice.call(f.getParameter(Fg));Object.keys(de).forEach(function(x){var j=de[x];D.indexOf(j)>=0&&(ae[x]=j)});var H=Object.keys(ae);S.textureFormats=H;var ue=[];Object.keys(ae).forEach(function(x){var j=ae[x];ue[j]=x});var Se=[];Object.keys(ye).forEach(function(x){var j=ye[x];Se[j]=x});var re=[];Object.keys(he).forEach(function(x){var j=he[x];re[j]=x});var Ae=[];Object.keys(ve).forEach(function(x){var j=ve[x];Ae[j]=x});var Ee=[];Object.keys(oe).forEach(function(x){var j=oe[x];Ee[j]=x});var Ne=H.reduce(function(x,j){var U=ae[j];return U===fo||U===_c||U===fo||U===Li||U===$c||U===ki||g.ext_srgb&&(U===Ec||U===xc)?x[U]=U:U===wc||j.indexOf("rgba")>=0?x[U]=Rr:x[U]=Mi,x},{});function ee(){this.internalformat=Rr,this.format=Rr,this.type=hs,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Gu,this.width=0,this.height=0,this.channels=0}function K(x,j){x.internalformat=j.internalformat,x.format=j.format,x.type=j.type,x.compressed=j.compressed,x.premultiplyAlpha=j.premultiplyAlpha,x.flipY=j.flipY,x.unpackAlignment=j.unpackAlignment,x.colorSpace=j.colorSpace,x.width=j.width,x.height=j.height,x.channels=j.channels}function Me(x,j){if(!(typeof j!="object"||!j)){if("premultiplyAlpha"in j&&(b.type(j.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),x.premultiplyAlpha=j.premultiplyAlpha),"flipY"in j&&(b.type(j.flipY,"boolean","invalid texture flip"),x.flipY=j.flipY),"alignment"in j&&(b.oneOf(j.alignment,[1,2,4,8],"invalid texture unpack alignment"),x.unpackAlignment=j.alignment),"colorSpace"in j&&(b.parameter(j.colorSpace,me,"invalid colorSpace"),x.colorSpace=me[j.colorSpace]),"type"in j){var U=j.type;b(g.oes_texture_float||!(U==="float"||U==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),b(g.oes_texture_half_float||!(U==="half float"||U==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),b(g.webgl_depth_texture||!(U==="uint16"||U==="uint32"||U==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),b.parameter(U,ye,"invalid texture type"),x.type=ye[U]}var Ce=x.width,Ke=x.height,_=x.channels,v=!1;"shape"in j?(b(Array.isArray(j.shape)&&j.shape.length>=2,"shape must be an array"),Ce=j.shape[0],Ke=j.shape[1],j.shape.length===3&&(_=j.shape[2],b(_>0&&_<=4,"invalid number of channels"),v=!0),b(Ce>=0&&Ce<=S.maxTextureSize,"invalid width"),b(Ke>=0&&Ke<=S.maxTextureSize,"invalid height")):("radius"in j&&(Ce=Ke=j.radius,b(Ce>=0&&Ce<=S.maxTextureSize,"invalid radius")),"width"in j&&(Ce=j.width,b(Ce>=0&&Ce<=S.maxTextureSize,"invalid width")),"height"in j&&(Ke=j.height,b(Ke>=0&&Ke<=S.maxTextureSize,"invalid height")),"channels"in j&&(_=j.channels,b(_>0&&_<=4,"invalid number of channels"),v=!0)),x.width=Ce|0,x.height=Ke|0,x.channels=_|0;var O=!1;if("format"in j){var N=j.format;b(g.webgl_depth_texture||!(N==="depth"||N==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),b.parameter(N,ae,"invalid texture format");var I=x.internalformat=ae[N];x.format=Ne[I],N in ye&&("type"in j||(x.type=ye[N])),N in de&&(x.compressed=!0),O=!0}!v&&O?x.channels=On[x.format]:v&&!O?x.channels!==Fi[x.format]&&(x.format=x.internalformat=Fi[x.channels]):O&&v&&b(x.channels===On[x.format],"number of channels inconsistent with specified format")}}function be(x){f.pixelStorei(Kg,x.flipY),f.pixelStorei(Jg,x.premultiplyAlpha),f.pixelStorei(e2,x.colorSpace),f.pixelStorei(Qg,x.unpackAlignment)}function le(){ee.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function _e(x,j){var U=null;if(Fc(j)?U=j:j&&(b.type(j,"object","invalid pixel data type"),Me(x,j),"x"in j&&(x.xOffset=j.x|0),"y"in j&&(x.yOffset=j.y|0),Fc(j.data)&&(U=j.data)),b(!x.compressed||U instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),j.copy){b(!U,"can not specify copy and data field for the same texture");var Ce=J.viewportWidth,Ke=J.viewportHeight;x.width=x.width||Ce-x.xOffset,x.height=x.height||Ke-x.yOffset,x.needsCopy=!0,b(x.xOffset>=0&&x.xOffset<Ce&&x.yOffset>=0&&x.yOffset<Ke&&x.width>0&&x.width<=Ce&&x.height>0&&x.height<=Ke,"copy texture read out of bounds")}else if(!U)x.width=x.width||1,x.height=x.height||1,x.channels=x.channels||4;else if(n(U))x.channels=x.channels||4,x.data=U,!("type"in j)&&x.type===hs&&(x.type=Hu(U));else if(Uu(U))x.channels=x.channels||4,a2(x,U),x.alignment=1,x.needsFree=!0;else if(Rn(U)){var _=U.data;!Array.isArray(_)&&x.type===hs&&(x.type=Hu(_));var v=U.shape,O=U.stride,N,I,M,C,G,$;v.length===3?(M=v[2],$=O[2]):(b(v.length===2,"invalid ndarray pixel data, must be 2 or 3D"),M=1,$=1),N=v[0],I=v[1],C=O[0],G=O[1],x.alignment=1,x.width=N,x.height=I,x.channels=M,x.format=x.internalformat=Fi[M],x.needsFree=!0,c2(x,_,C,G,$,U.offset)}else if(Xu(U)||ju(U)||r2(U))Xu(U)||ju(U)?x.element=U:x.element=U.canvas,x.width=x.element.width,x.height=x.element.height,x.channels=4;else if(s2(U))x.element=U,x.width=U.width,x.height=U.height,x.channels=4;else if(o2(U))x.element=U,x.width=U.naturalWidth,x.height=U.naturalHeight,x.channels=4;else if(i2(U))x.element=U,x.width=U.videoWidth,x.height=U.videoHeight,x.channels=4;else if(qu(U)){var A=x.width||U[0].length,E=x.height||U.length,z=x.channels;At(U[0][0])?z=z||U[0][0].length:z=z||1;for(var V=Si.shape(U),Q=1,te=0;te<V.length;++te)Q*=V[te];var ge=Yu(x,Q);Si.flatten(U,V,"",ge),Wu(x,ge),x.alignment=1,x.width=A,x.height=E,x.channels=z,x.format=x.internalformat=Fi[z],x.needsFree=!0}x.type===uo?b(S.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):x.type===ds&&b(S.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function $e(x,j,U){var Ce=x.element,Ke=x.data,_=x.internalformat,v=x.format,O=x.type,N=x.width,I=x.height;be(x),Ce?f.texImage2D(j,U,v,v,O,Ce):x.compressed?f.compressedTexImage2D(j,U,_,N,I,0,Ke):x.needsCopy?(X(),f.copyTexImage2D(j,U,v,x.xOffset,x.yOffset,N,I,0)):f.texImage2D(j,U,v,N,I,0,v,O,Ke||null)}function He(x,j,U,Ce,Ke){var _=x.element,v=x.data,O=x.internalformat,N=x.format,I=x.type,M=x.width,C=x.height;be(x),_?f.texSubImage2D(j,Ke,U,Ce,N,I,_):x.compressed?f.compressedTexSubImage2D(j,Ke,U,Ce,O,M,C,v):x.needsCopy?(X(),f.copyTexSubImage2D(j,Ke,U,Ce,x.xOffset,x.yOffset,M,C)):f.texSubImage2D(j,Ke,U,Ce,M,C,N,I,v)}var je=[];function xe(){return je.pop()||new le}function Te(x){x.needsFree&&St.freeType(x.data),le.call(x),je.push(x)}function Ie(){ee.call(this),this.genMipmaps=!1,this.mipmapHint=Ri,this.mipmask=0,this.images=Array(16)}function Ye(x,j,U){var Ce=x.images[0]=xe();x.mipmask=1,Ce.width=x.width=j,Ce.height=x.height=U,Ce.channels=x.channels=4}function tt(x,j){var U=null;if(Fc(j))U=x.images[0]=xe(),K(U,x),_e(U,j),x.mipmask=1;else if(Me(x,j),Array.isArray(j.mipmap))for(var Ce=j.mipmap,Ke=0;Ke<Ce.length;++Ke)U=x.images[Ke]=xe(),K(U,x),U.width>>=Ke,U.height>>=Ke,_e(U,Ce[Ke]),x.mipmask|=1<<Ke;else U=x.images[0]=xe(),K(U,x),_e(U,j),x.mipmask=1;K(x,x.images[0]),x.compressed&&(x.internalformat===Ac||x.internalformat===Tc||x.internalformat===Sc||x.internalformat===Pc)&&b(x.width%4===0&&x.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Tt(x,j){for(var U=x.images,Ce=0;Ce<U.length;++Ce){if(!U[Ce])return;$e(U[Ce],j,Ce)}}var Pt=[];function rt(){var x=Pt.pop()||new Ie;ee.call(x),x.mipmask=0;for(var j=0;j<16;++j)x.images[j]=null;return x}function Nt(x){for(var j=x.images,U=0;U<j.length;++U)j[U]&&Te(j[U]),j[U]=null;Pt.push(x)}function yt(){this.minFilter=Lc,this.magFilter=Lc,this.wrapS=Mc,this.wrapT=Mc,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ri}function Ft(x,j){if("min"in j){var U=j.min;b.parameter(U,ve),x.minFilter=ve[U],t2.indexOf(x.minFilter)>=0&&!("faces"in j)&&(x.genMipmaps=!0)}if("mag"in j){var Ce=j.mag;b.parameter(Ce,he),x.magFilter=he[Ce]}var Ke=x.wrapS,_=x.wrapT;if("wrap"in j){var v=j.wrap;typeof v=="string"?(b.parameter(v,oe),Ke=_=oe[v]):Array.isArray(v)&&(b.parameter(v[0],oe),b.parameter(v[1],oe),Ke=oe[v[0]],_=oe[v[1]])}else{if("wrapS"in j){var O=j.wrapS;b.parameter(O,oe),Ke=oe[O]}if("wrapT"in j){var N=j.wrapT;b.parameter(N,oe),_=oe[N]}}if(x.wrapS=Ke,x.wrapT=_,"anisotropic"in j){var I=j.anisotropic;b(typeof I=="number"&&I>=1&&I<=S.maxAnisotropic,"aniso samples must be between 1 and "),x.anisotropic=j.anisotropic}if("mipmap"in j){var M=!1;switch(typeof j.mipmap){case"string":b.parameter(j.mipmap,ie,"invalid mipmap hint"),x.mipmapHint=ie[j.mipmap],x.genMipmaps=!0,M=!0;break;case"boolean":M=x.genMipmaps=j.mipmap;break;case"object":b(Array.isArray(j.mipmap),"invalid mipmap type"),x.genMipmaps=!1,M=!0;break;default:b.raise("invalid mipmap type")}M&&!("min"in j)&&(x.minFilter=kc)}}function Dt(x,j){f.texParameteri(j,Xg,x.minFilter),f.texParameteri(j,qg,x.magFilter),f.texParameteri(j,Ig,x.wrapS),f.texParameteri(j,Vg,x.wrapT),g.ext_texture_filter_anisotropic&&f.texParameteri(j,Zg,x.anisotropic),x.genMipmaps&&(f.hint(Hg,x.mipmapHint),f.generateMipmap(j))}var Bt=0,Xt={},Zt=S.maxTextureUnits,Ct=Array(Zt).map(function(){return null});function We(x){ee.call(this),this.mipmask=0,this.internalformat=Rr,this.id=Bt++,this.refCount=1,this.target=x,this.texture=f.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new yt,Y.profile&&(this.stats={size:0})}function Qt(x){f.activeTexture(ho),f.bindTexture(x.target,x.texture)}function lt(){var x=Ct[0];x?f.bindTexture(x.target,x.texture):f.bindTexture(jn,null)}function Be(x){var j=x.texture;b(j,"must not double destroy texture");var U=x.unit,Ce=x.target;U>=0&&(f.activeTexture(ho+U),f.bindTexture(Ce,null),Ct[U]=null),f.deleteTexture(j),x.texture=null,x.params=null,x.pixels=null,x.refCount=0,delete Xt[x.id],q.textureCount--}r(We.prototype,{bind:function(){var x=this;x.bindCount+=1;var j=x.unit;if(j<0){for(var U=0;U<Zt;++U){var Ce=Ct[U];if(Ce){if(Ce.bindCount>0)continue;Ce.unit=-1}Ct[U]=x,j=U;break}j>=Zt&&b.raise("insufficient number of texture units"),Y.profile&&q.maxTextureUnits<j+1&&(q.maxTextureUnits=j+1),x.unit=j,f.activeTexture(ho+j),f.bindTexture(x.target,x.texture)}return j},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Be(this)}});function nt(x,j){var U=new We(jn);Xt[U.id]=U,q.textureCount++;function Ce(v,O){var N=U.texInfo;yt.call(N);var I=rt();return typeof v=="number"?typeof O=="number"?Ye(I,v|0,O|0):Ye(I,v|0,v|0):v?(b.type(v,"object","invalid arguments to regl.texture"),Ft(N,v),tt(I,v)):Ye(I,1,1),N.genMipmaps&&(I.mipmask=(I.width<<1)-1),U.mipmask=I.mipmask,K(U,I),b.texture2D(N,I,S),U.internalformat=I.internalformat,Ce.width=I.width,Ce.height=I.height,Qt(U),Tt(I,jn),Dt(N,jn),lt(),Nt(I),Y.profile&&(U.stats.size=Gi(U.internalformat,U.type,I.width,I.height,N.genMipmaps,!1)),Ce.format=ue[U.internalformat],Ce.type=Se[U.type],Ce.mag=re[N.magFilter],Ce.min=Ae[N.minFilter],Ce.wrapS=Ee[N.wrapS],Ce.wrapT=Ee[N.wrapT],Ce}function Ke(v,O,N,I){b(!!v,"must specify image data");var M=O|0,C=N|0,G=I|0,$=xe();return K($,U),$.width=0,$.height=0,_e($,v),$.width=$.width||(U.width>>G)-M,$.height=$.height||(U.height>>G)-C,b(U.type===$.type&&U.format===$.format&&U.internalformat===$.internalformat,"incompatible format for texture.subimage"),b(M>=0&&C>=0&&M+$.width<=U.width&&C+$.height<=U.height,"texture.subimage write out of bounds"),b(U.mipmask&1<<G,"missing mipmap data"),b($.data||$.element||$.needsCopy,"missing image data"),Qt(U),He($,jn,M,C,G),lt(),Te($),Ce}function _(v,O){var N=v|0,I=O|0||N;if(N===U.width&&I===U.height)return Ce;Ce.width=U.width=N,Ce.height=U.height=I,Qt(U);for(var M=0;U.mipmask>>M;++M){var C=N>>M,G=I>>M;if(!C||!G)break;f.texImage2D(jn,M,U.format,C,G,0,U.format,U.type,null)}return lt(),Y.profile&&(U.stats.size=Gi(U.internalformat,U.type,N,I,!1,!1)),Ce}return Ce(x,j),Ce.subimage=Ke,Ce.resize=_,Ce._reglType="texture2d",Ce._texture=U,Y.profile&&(Ce.stats=U.stats),Ce.destroy=function(){U.decRef()},Ce}function ot(x,j,U,Ce,Ke,_){var v=new We(bc);Xt[v.id]=v,q.cubeCount++;var O=new Array(6);function N(C,G,$,A,E,z){var V,Q=v.texInfo;for(yt.call(Q),V=0;V<6;++V)O[V]=rt();if(typeof C=="number"||!C){var te=C|0||1;for(V=0;V<6;++V)Ye(O[V],te,te)}else if(typeof C=="object")if(G)tt(O[0],C),tt(O[1],G),tt(O[2],$),tt(O[3],A),tt(O[4],E),tt(O[5],z);else if(Ft(Q,C),Me(v,C),"faces"in C){var ge=C.faces;for(b(Array.isArray(ge)&&ge.length===6,"cube faces must be a length 6 array"),V=0;V<6;++V)b(typeof ge[V]=="object"&&!!ge[V],"invalid input for cube map face"),K(O[V],v),tt(O[V],ge[V])}else for(V=0;V<6;++V)tt(O[V],C);else b.raise("invalid arguments to cube map");for(K(v,O[0]),b.optional(function(){S.npotTextureCube||b(Eu(v.width)&&Eu(v.height),"your browser does not support non power or two texture dimensions")}),Q.genMipmaps?v.mipmask=(O[0].width<<1)-1:v.mipmask=O[0].mipmask,b.textureCube(v,Q,O,S),v.internalformat=O[0].internalformat,N.width=O[0].width,N.height=O[0].height,Qt(v),V=0;V<6;++V)Tt(O[V],Ci+V);for(Dt(Q,bc),lt(),Y.profile&&(v.stats.size=Gi(v.internalformat,v.type,N.width,N.height,Q.genMipmaps,!0)),N.format=ue[v.internalformat],N.type=Se[v.type],N.mag=re[Q.magFilter],N.min=Ae[Q.minFilter],N.wrapS=Ee[Q.wrapS],N.wrapT=Ee[Q.wrapT],V=0;V<6;++V)Nt(O[V]);return N}function I(C,G,$,A,E){b(!!G,"must specify image data"),b(typeof C=="number"&&C===(C|0)&&C>=0&&C<6,"invalid face");var z=$|0,V=A|0,Q=E|0,te=xe();return K(te,v),te.width=0,te.height=0,_e(te,G),te.width=te.width||(v.width>>Q)-z,te.height=te.height||(v.height>>Q)-V,b(v.type===te.type&&v.format===te.format&&v.internalformat===te.internalformat,"incompatible format for texture.subimage"),b(z>=0&&V>=0&&z+te.width<=v.width&&V+te.height<=v.height,"texture.subimage write out of bounds"),b(v.mipmask&1<<Q,"missing mipmap data"),b(te.data||te.element||te.needsCopy,"missing image data"),Qt(v),He(te,Ci+C,z,V,Q),lt(),Te(te),N}function M(C){var G=C|0;if(G!==v.width){N.width=v.width=G,N.height=v.height=G,Qt(v);for(var $=0;$<6;++$)for(var A=0;v.mipmask>>A;++A)f.texImage2D(Ci+$,A,v.format,G>>A,G>>A,0,v.format,v.type,null);return lt(),Y.profile&&(v.stats.size=Gi(v.internalformat,v.type,N.width,N.height,!1,!0)),N}}return N(x,j,U,Ce,Ke,_),N.subimage=I,N.resize=M,N._reglType="textureCube",N._texture=v,Y.profile&&(N.stats=v.stats),N.destroy=function(){v.decRef()},N}function Mt(){for(var x=0;x<Zt;++x)f.activeTexture(ho+x),f.bindTexture(jn,null),Ct[x]=null;En(Xt).forEach(Be),q.cubeCount=0,q.textureCount=0}Y.profile&&(q.getTotalTextureSize=function(){var x=0;return Object.keys(Xt).forEach(function(j){x+=Xt[j].stats.size}),x});function Yn(){for(var x=0;x<Zt;++x){var j=Ct[x];j&&(j.bindCount=0,j.unit=-1,Ct[x]=null)}En(Xt).forEach(function(U){U.texture=f.createTexture(),f.bindTexture(U.target,U.texture);for(var Ce=0;Ce<32;++Ce)if(U.mipmask&1<<Ce)if(U.target===jn)f.texImage2D(jn,Ce,U.internalformat,U.width>>Ce,U.height>>Ce,0,U.internalformat,U.type,null);else for(var Ke=0;Ke<6;++Ke)f.texImage2D(Ci+Ke,Ce,U.internalformat,U.width>>Ce,U.height>>Ce,0,U.internalformat,U.type,null);Dt(U.texInfo,U.target)})}function zr(){for(var x=0;x<Zt;++x){var j=Ct[x];j&&(j.bindCount=0,j.unit=-1,Ct[x]=null),f.activeTexture(ho+x),f.bindTexture(jn,null),f.bindTexture(bc,null)}}return{create2D:nt,createCube:ot,clear:Mt,getTexture:function(x){return null},restore:Yn,refresh:zr}}var mr=36161,Ni=32854,Zu=32855,Qu=36194,Ku=33189,Ju=36168,e1=34041,t1=35907,n1=34836,r1=34842,s1=34843,Fn=[];Fn[Ni]=2,Fn[Zu]=2,Fn[Qu]=2,Fn[Ku]=2,Fn[Ju]=1,Fn[e1]=4,Fn[t1]=4,Fn[n1]=16,Fn[r1]=8,Fn[s1]=6;function o1(f,g,S){return Fn[f]*g*S}var f2=function(f,g,S,X,J){var q={rgba4:Ni,rgb565:Qu,"rgb5 a1":Zu,depth:Ku,stencil:Ju,"depth stencil":e1};g.ext_srgb&&(q.srgba=t1),g.ext_color_buffer_half_float&&(q.rgba16f=r1,q.rgb16f=s1),g.webgl_color_buffer_float&&(q.rgba32f=n1);var Y=[];Object.keys(q).forEach(function(ae){var de=q[ae];Y[de]=ae});var ie=0,oe={};function he(ae){this.id=ie++,this.refCount=1,this.renderbuffer=ae,this.format=Ni,this.width=0,this.height=0,J.profile&&(this.stats={size:0})}he.prototype.decRef=function(){--this.refCount<=0&&ve(this)};function ve(ae){var de=ae.renderbuffer;b(de,"must not double destroy renderbuffer"),f.bindRenderbuffer(mr,null),f.deleteRenderbuffer(de),ae.renderbuffer=null,ae.refCount=0,delete oe[ae.id],X.renderbufferCount--}function me(ae,de){var D=new he(f.createRenderbuffer());oe[D.id]=D,X.renderbufferCount++;function H(Se,re){var Ae=0,Ee=0,Ne=Ni;if(typeof Se=="object"&&Se){var ee=Se;if("shape"in ee){var K=ee.shape;b(Array.isArray(K)&&K.length>=2,"invalid renderbuffer shape"),Ae=K[0]|0,Ee=K[1]|0}else"radius"in ee&&(Ae=Ee=ee.radius|0),"width"in ee&&(Ae=ee.width|0),"height"in ee&&(Ee=ee.height|0);"format"in ee&&(b.parameter(ee.format,q,"invalid renderbuffer format"),Ne=q[ee.format])}else typeof Se=="number"?(Ae=Se|0,typeof re=="number"?Ee=re|0:Ee=Ae):Se?b.raise("invalid arguments to renderbuffer constructor"):Ae=Ee=1;if(b(Ae>0&&Ee>0&&Ae<=S.maxRenderbufferSize&&Ee<=S.maxRenderbufferSize,"invalid renderbuffer size"),!(Ae===D.width&&Ee===D.height&&Ne===D.format))return H.width=D.width=Ae,H.height=D.height=Ee,D.format=Ne,f.bindRenderbuffer(mr,D.renderbuffer),f.renderbufferStorage(mr,Ne,Ae,Ee),b(f.getError()===0,"invalid render buffer format"),J.profile&&(D.stats.size=o1(D.format,D.width,D.height)),H.format=Y[D.format],H}function ue(Se,re){var Ae=Se|0,Ee=re|0||Ae;return Ae===D.width&&Ee===D.height||(b(Ae>0&&Ee>0&&Ae<=S.maxRenderbufferSize&&Ee<=S.maxRenderbufferSize,"invalid renderbuffer size"),H.width=D.width=Ae,H.height=D.height=Ee,f.bindRenderbuffer(mr,D.renderbuffer),f.renderbufferStorage(mr,D.format,Ae,Ee),b(f.getError()===0,"invalid render buffer format"),J.profile&&(D.stats.size=o1(D.format,D.width,D.height))),H}return H(ae,de),H.resize=ue,H._reglType="renderbuffer",H._renderbuffer=D,J.profile&&(H.stats=D.stats),H.destroy=function(){D.decRef()},H}J.profile&&(X.getTotalRenderbufferSize=function(){var ae=0;return Object.keys(oe).forEach(function(de){ae+=oe[de].stats.size}),ae});function ye(){En(oe).forEach(function(ae){ae.renderbuffer=f.createRenderbuffer(),f.bindRenderbuffer(mr,ae.renderbuffer),f.renderbufferStorage(mr,ae.format,ae.width,ae.height)}),f.bindRenderbuffer(mr,null)}return{create:me,clear:function(){En(oe).forEach(ve)},restore:ye}},sr=36160,Gc=36161,Gr=3553,Di=34069,i1=36064,a1=36096,c1=36128,l1=33306,f1=36053,u2=36054,d2=36055,h2=36057,m2=36061,v2=36193,p2=5121,g2=5126,u1=6407,d1=6408,y2=6402,b2=[u1,d1],Nc=[];Nc[d1]=4,Nc[u1]=3;var Bi=[];Bi[p2]=1,Bi[g2]=4,Bi[v2]=2;var _2=32854,w2=32855,$2=36194,E2=33189,x2=36168,h1=34041,A2=35907,T2=34836,S2=34842,P2=34843,O2=[_2,w2,$2,A2,S2,P2,T2],ps={};ps[f1]="complete",ps[u2]="incomplete attachment",ps[h2]="incomplete dimensions",ps[d2]="incomplete, missing attachment",ps[m2]="unsupported";function C2(f,g,S,X,J,q){var Y={cur:null,next:null,dirty:!1,setFBO:null},ie=["rgba"],oe=["rgba4","rgb565","rgb5 a1"];g.ext_srgb&&oe.push("srgba"),g.ext_color_buffer_half_float&&oe.push("rgba16f","rgb16f"),g.webgl_color_buffer_float&&oe.push("rgba32f");var he=["uint8"];g.oes_texture_half_float&&he.push("half float","float16"),g.oes_texture_float&&he.push("float","float32");function ve(le,_e,$e){this.target=le,this.texture=_e,this.renderbuffer=$e;var He=0,je=0;_e?(He=_e.width,je=_e.height):$e&&(He=$e.width,je=$e.height),this.width=He,this.height=je}function me(le){le&&(le.texture&&le.texture._texture.decRef(),le.renderbuffer&&le.renderbuffer._renderbuffer.decRef())}function ye(le,_e,$e){if(le)if(le.texture){var He=le.texture._texture,je=Math.max(1,He.width),xe=Math.max(1,He.height);b(je===_e&&xe===$e,"inconsistent width/height for supplied texture"),He.refCount+=1}else{var Te=le.renderbuffer._renderbuffer;b(Te.width===_e&&Te.height===$e,"inconsistent width/height for renderbuffer"),Te.refCount+=1}}function ae(le,_e){_e&&(_e.texture?f.framebufferTexture2D(sr,le,_e.target,_e.texture._texture.texture,0):f.framebufferRenderbuffer(sr,le,Gc,_e.renderbuffer._renderbuffer.renderbuffer))}function de(le){var _e=Gr,$e=null,He=null,je=le;typeof le=="object"&&(je=le.data,"target"in le&&(_e=le.target|0)),b.type(je,"function","invalid attachment data");var xe=je._reglType;return xe==="texture2d"?($e=je,b(_e===Gr)):xe==="textureCube"?($e=je,b(_e>=Di&&_e<Di+6,"invalid cube map target")):xe==="renderbuffer"?(He=je,_e=Gc):b.raise("invalid regl object for attachment"),new ve(_e,$e,He)}function D(le,_e,$e,He,je){if($e){var xe=X.create2D({width:le,height:_e,format:He,type:je});return xe._texture.refCount=0,new ve(Gr,xe,null)}else{var Te=J.create({width:le,height:_e,format:He});return Te._renderbuffer.refCount=0,new ve(Gc,null,Te)}}function H(le){return le&&(le.texture||le.renderbuffer)}function ue(le,_e,$e){le&&(le.texture?le.texture.resize(_e,$e):le.renderbuffer&&le.renderbuffer.resize(_e,$e),le.width=_e,le.height=$e)}var Se=0,re={};function Ae(){this.id=Se++,re[this.id]=this,this.framebuffer=f.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ee(le){le.colorAttachments.forEach(me),me(le.depthAttachment),me(le.stencilAttachment),me(le.depthStencilAttachment)}function Ne(le){var _e=le.framebuffer;b(_e,"must not double destroy framebuffer"),f.deleteFramebuffer(_e),le.framebuffer=null,q.framebufferCount--,delete re[le.id]}function ee(le){var _e;f.bindFramebuffer(sr,le.framebuffer);var $e=le.colorAttachments;for(_e=0;_e<$e.length;++_e)ae(i1+_e,$e[_e]);for(_e=$e.length;_e<S.maxColorAttachments;++_e)f.framebufferTexture2D(sr,i1+_e,Gr,null,0);f.framebufferTexture2D(sr,l1,Gr,null,0),f.framebufferTexture2D(sr,a1,Gr,null,0),f.framebufferTexture2D(sr,c1,Gr,null,0),ae(a1,le.depthAttachment),ae(c1,le.stencilAttachment),ae(l1,le.depthStencilAttachment);var He=f.checkFramebufferStatus(sr);!f.isContextLost()&&He!==f1&&b.raise("framebuffer configuration not supported, status = "+ps[He]),f.bindFramebuffer(sr,Y.next?Y.next.framebuffer:null),Y.cur=Y.next,f.getError()}function K(le,_e){var $e=new Ae;q.framebufferCount++;function He(xe,Te){var Ie;b(Y.next!==$e,"can not update framebuffer which is currently in use");var Ye=0,tt=0,Tt=!0,Pt=!0,rt=null,Nt=!0,yt="rgba",Ft="uint8",Dt=1,Bt=null,Xt=null,Zt=null,Ct=!1;if(typeof xe=="number")Ye=xe|0,tt=Te|0||Ye;else if(!xe)Ye=tt=1;else{b.type(xe,"object","invalid arguments for framebuffer");var We=xe;if("shape"in We){var Qt=We.shape;b(Array.isArray(Qt)&&Qt.length>=2,"invalid shape for framebuffer"),Ye=Qt[0],tt=Qt[1]}else"radius"in We&&(Ye=tt=We.radius),"width"in We&&(Ye=We.width),"height"in We&&(tt=We.height);("color"in We||"colors"in We)&&(rt=We.color||We.colors,Array.isArray(rt)&&b(rt.length===1||g.webgl_draw_buffers,"multiple render targets not supported")),rt||("colorCount"in We&&(Dt=We.colorCount|0,b(Dt>0,"invalid color buffer count")),"colorTexture"in We&&(Nt=!!We.colorTexture,yt="rgba4"),"colorType"in We&&(Ft=We.colorType,Nt?(b(g.oes_texture_float||!(Ft==="float"||Ft==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),b(g.oes_texture_half_float||!(Ft==="half float"||Ft==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ft==="half float"||Ft==="float16"?(b(g.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),yt="rgba16f"):(Ft==="float"||Ft==="float32")&&(b(g.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),yt="rgba32f"),b.oneOf(Ft,he,"invalid color type")),"colorFormat"in We&&(yt=We.colorFormat,ie.indexOf(yt)>=0?Nt=!0:oe.indexOf(yt)>=0?Nt=!1:b.optional(function(){Nt?b.oneOf(We.colorFormat,ie,"invalid color format for texture"):b.oneOf(We.colorFormat,oe,"invalid color format for renderbuffer")}))),("depthTexture"in We||"depthStencilTexture"in We)&&(Ct=!!(We.depthTexture||We.depthStencilTexture),b(!Ct||g.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in We&&(typeof We.depth=="boolean"?Tt=We.depth:(Bt=We.depth,Pt=!1)),"stencil"in We&&(typeof We.stencil=="boolean"?Pt=We.stencil:(Xt=We.stencil,Tt=!1)),"depthStencil"in We&&(typeof We.depthStencil=="boolean"?Tt=Pt=We.depthStencil:(Zt=We.depthStencil,Tt=!1,Pt=!1))}var lt=null,Be=null,nt=null,ot=null;if(Array.isArray(rt))lt=rt.map(de);else if(rt)lt=[de(rt)];else for(lt=new Array(Dt),Ie=0;Ie<Dt;++Ie)lt[Ie]=D(Ye,tt,Nt,yt,Ft);b(g.webgl_draw_buffers||lt.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),b(lt.length<=S.maxColorAttachments,"too many color attachments, not supported"),Ye=Ye||lt[0].width,tt=tt||lt[0].height,Bt?Be=de(Bt):Tt&&!Pt&&(Be=D(Ye,tt,Ct,"depth","uint32")),Xt?nt=de(Xt):Pt&&!Tt&&(nt=D(Ye,tt,!1,"stencil","uint8")),Zt?ot=de(Zt):!Bt&&!Xt&&Pt&&Tt&&(ot=D(Ye,tt,Ct,"depth stencil","depth stencil")),b(!!Bt+!!Xt+!!Zt<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Mt=null;for(Ie=0;Ie<lt.length;++Ie)if(ye(lt[Ie],Ye,tt),b(!lt[Ie]||lt[Ie].texture&&b2.indexOf(lt[Ie].texture._texture.format)>=0||lt[Ie].renderbuffer&&O2.indexOf(lt[Ie].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ie+" is invalid"),lt[Ie]&&lt[Ie].texture){var Yn=Nc[lt[Ie].texture._texture.format]*Bi[lt[Ie].texture._texture.type];Mt===null?Mt=Yn:b(Mt===Yn,"all color attachments much have the same number of bits per pixel.")}return ye(Be,Ye,tt),b(!Be||Be.texture&&Be.texture._texture.format===y2||Be.renderbuffer&&Be.renderbuffer._renderbuffer.format===E2,"invalid depth attachment for framebuffer object"),ye(nt,Ye,tt),b(!nt||nt.renderbuffer&&nt.renderbuffer._renderbuffer.format===x2,"invalid stencil attachment for framebuffer object"),ye(ot,Ye,tt),b(!ot||ot.texture&&ot.texture._texture.format===h1||ot.renderbuffer&&ot.renderbuffer._renderbuffer.format===h1,"invalid depth-stencil attachment for framebuffer object"),Ee($e),$e.width=Ye,$e.height=tt,$e.colorAttachments=lt,$e.depthAttachment=Be,$e.stencilAttachment=nt,$e.depthStencilAttachment=ot,He.color=lt.map(H),He.depth=H(Be),He.stencil=H(nt),He.depthStencil=H(ot),He.width=$e.width,He.height=$e.height,ee($e),He}function je(xe,Te){b(Y.next!==$e,"can not resize a framebuffer which is currently in use");var Ie=Math.max(xe|0,1),Ye=Math.max(Te|0||Ie,1);if(Ie===$e.width&&Ye===$e.height)return He;for(var tt=$e.colorAttachments,Tt=0;Tt<tt.length;++Tt)ue(tt[Tt],Ie,Ye);return ue($e.depthAttachment,Ie,Ye),ue($e.stencilAttachment,Ie,Ye),ue($e.depthStencilAttachment,Ie,Ye),$e.width=He.width=Ie,$e.height=He.height=Ye,ee($e),He}return He(le,_e),r(He,{resize:je,_reglType:"framebuffer",_framebuffer:$e,destroy:function(){Ne($e),Ee($e)},use:function(xe){Y.setFBO({framebuffer:He},xe)}})}function Me(le){var _e=Array(6);function $e(je){var xe;b(_e.indexOf(Y.next)<0,"can not update framebuffer which is currently in use");var Te={color:null},Ie=0,Ye=null,tt="rgba",Tt="uint8",Pt=1;if(typeof je=="number")Ie=je|0;else if(!je)Ie=1;else{b.type(je,"object","invalid arguments for framebuffer");var rt=je;if("shape"in rt){var Nt=rt.shape;b(Array.isArray(Nt)&&Nt.length>=2,"invalid shape for framebuffer"),b(Nt[0]===Nt[1],"cube framebuffer must be square"),Ie=Nt[0]}else"radius"in rt&&(Ie=rt.radius|0),"width"in rt?(Ie=rt.width|0,"height"in rt&&b(rt.height===Ie,"must be square")):"height"in rt&&(Ie=rt.height|0);("color"in rt||"colors"in rt)&&(Ye=rt.color||rt.colors,Array.isArray(Ye)&&b(Ye.length===1||g.webgl_draw_buffers,"multiple render targets not supported")),Ye||("colorCount"in rt&&(Pt=rt.colorCount|0,b(Pt>0,"invalid color buffer count")),"colorType"in rt&&(b.oneOf(rt.colorType,he,"invalid color type"),Tt=rt.colorType),"colorFormat"in rt&&(tt=rt.colorFormat,b.oneOf(rt.colorFormat,ie,"invalid color format for texture"))),"depth"in rt&&(Te.depth=rt.depth),"stencil"in rt&&(Te.stencil=rt.stencil),"depthStencil"in rt&&(Te.depthStencil=rt.depthStencil)}var yt;if(Ye)if(Array.isArray(Ye))for(yt=[],xe=0;xe<Ye.length;++xe)yt[xe]=Ye[xe];else yt=[Ye];else{yt=Array(Pt);var Ft={radius:Ie,format:tt,type:Tt};for(xe=0;xe<Pt;++xe)yt[xe]=X.createCube(Ft)}for(Te.color=Array(yt.length),xe=0;xe<yt.length;++xe){var Dt=yt[xe];b(typeof Dt=="function"&&Dt._reglType==="textureCube","invalid cube map"),Ie=Ie||Dt.width,b(Dt.width===Ie&&Dt.height===Ie,"invalid cube map shape"),Te.color[xe]={target:Di,data:yt[xe]}}for(xe=0;xe<6;++xe){for(var Bt=0;Bt<yt.length;++Bt)Te.color[Bt].target=Di+xe;xe>0&&(Te.depth=_e[0].depth,Te.stencil=_e[0].stencil,Te.depthStencil=_e[0].depthStencil),_e[xe]?_e[xe](Te):_e[xe]=K(Te)}return r($e,{width:Ie,height:Ie,color:yt})}function He(je){var xe,Te=je|0;if(b(Te>0&&Te<=S.maxCubeMapSize,"invalid radius for cube fbo"),Te===$e.width)return $e;var Ie=$e.color;for(xe=0;xe<Ie.length;++xe)Ie[xe].resize(Te);for(xe=0;xe<6;++xe)_e[xe].resize(Te);return $e.width=$e.height=Te,$e}return $e(le),r($e,{faces:_e,resize:He,_reglType:"framebufferCube",destroy:function(){_e.forEach(function(je){je.destroy()})}})}function be(){Y.cur=null,Y.next=null,Y.dirty=!0,En(re).forEach(function(le){le.framebuffer=f.createFramebuffer(),ee(le)})}return r(Y,{getFramebuffer:function(le){if(typeof le=="function"&&le._reglType==="framebuffer"){var _e=le._framebuffer;if(_e instanceof Ae)return _e}return null},create:K,createCube:Me,clear:function(){En(re).forEach(Ne)},restore:be})}var M2=5126,m1=34962,Ii=34963,v1=["attributes","elements","offset","count","primitive","instances"];function Dc(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=M2,this.offset=0,this.stride=0,this.divisor=0}function L2(f,g,S,X,J,q,Y){for(var ie=S.maxAttributes,oe=new Array(ie),he=0;he<ie;++he)oe[he]=new Dc;var ve=0,me={},ye={Record:Dc,scope:{},state:oe,currentVAO:null,targetVAO:null,restore:de()?Ee:function(){},createVAO:Ne,getVAO:H,destroyBuffer:ae,setVAO:de()?ue:Se,clear:de()?re:function(){}};function ae(ee){for(var K=0;K<oe.length;++K){var Me=oe[K];Me.buffer===ee&&(f.disableVertexAttribArray(K),Me.buffer=null)}}function de(){return g.oes_vertex_array_object}function D(){return g.angle_instanced_arrays}function H(ee){return typeof ee=="function"&&ee._vao?ee._vao:null}function ue(ee){if(ee!==ye.currentVAO){var K=de();ee?K.bindVertexArrayOES(ee.vao):K.bindVertexArrayOES(null),ye.currentVAO=ee}}function Se(ee){if(ee!==ye.currentVAO){if(ee)ee.bindAttrs();else{for(var K=D(),Me=0;Me<oe.length;++Me){var be=oe[Me];be.buffer?(f.enableVertexAttribArray(Me),be.buffer.bind(),f.vertexAttribPointer(Me,be.size,be.type,be.normalized,be.stride,be.offfset),K&&be.divisor&&K.vertexAttribDivisorANGLE(Me,be.divisor)):(f.disableVertexAttribArray(Me),f.vertexAttrib4f(Me,be.x,be.y,be.z,be.w))}Y.elements?f.bindBuffer(Ii,Y.elements.buffer.buffer):f.bindBuffer(Ii,null)}ye.currentVAO=ee}}function re(){En(me).forEach(function(ee){ee.destroy()})}function Ae(){this.id=++ve,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var ee=de();ee?this.vao=ee.createVertexArrayOES():this.vao=null,me[this.id]=this,this.buffers=[]}Ae.prototype.bindAttrs=function(){for(var ee=D(),K=this.attributes,Me=0;Me<K.length;++Me){var be=K[Me];be.buffer?(f.enableVertexAttribArray(Me),f.bindBuffer(m1,be.buffer.buffer),f.vertexAttribPointer(Me,be.size,be.type,be.normalized,be.stride,be.offset),ee&&be.divisor&&ee.vertexAttribDivisorANGLE(Me,be.divisor)):(f.disableVertexAttribArray(Me),f.vertexAttrib4f(Me,be.x,be.y,be.z,be.w))}for(var le=K.length;le<ie;++le)f.disableVertexAttribArray(le);var _e=q.getElements(this.elements);_e?f.bindBuffer(Ii,_e.buffer.buffer):f.bindBuffer(Ii,null)},Ae.prototype.refresh=function(){var ee=de();ee&&(ee.bindVertexArrayOES(this.vao),this.bindAttrs(),ye.currentVAO=null,ee.bindVertexArrayOES(null))},Ae.prototype.destroy=function(){if(this.vao){var ee=de();this===ye.currentVAO&&(ye.currentVAO=null,ee.bindVertexArrayOES(null)),ee.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),me[this.id]&&(delete me[this.id],X.vaoCount-=1)};function Ee(){var ee=de();ee&&En(me).forEach(function(K){K.refresh()})}function Ne(ee){var K=new Ae;X.vaoCount+=1;function Me(be){var le;if(Array.isArray(be))le=be,K.elements&&K.ownsElements&&K.elements.destroy(),K.elements=null,K.ownsElements=!1,K.offset=0,K.count=0,K.instances=-1,K.primitive=4;else{if(b(typeof be=="object","invalid arguments for create vao"),b("attributes"in be,"must specify attributes for vao"),be.elements){var _e=be.elements;K.ownsElements?typeof _e=="function"&&_e._reglType==="elements"?(K.elements.destroy(),K.ownsElements=!1):(K.elements(_e),K.ownsElements=!1):q.getElements(be.elements)?(K.elements=be.elements,K.ownsElements=!1):(K.elements=q.create(be.elements),K.ownsElements=!0)}else K.elements=null,K.ownsElements=!1;le=be.attributes,K.offset=0,K.count=-1,K.instances=-1,K.primitive=4,K.elements&&(K.count=K.elements._elements.vertCount,K.primitive=K.elements._elements.primType),"offset"in be&&(K.offset=be.offset|0),"count"in be&&(K.count=be.count|0),"instances"in be&&(K.instances=be.instances|0),"primitive"in be&&(b(be.primitive in hr,"bad primitive type: "+be.primitive),K.primitive=hr[be.primitive]),b.optional(()=>{for(var Tt=Object.keys(be),Pt=0;Pt<Tt.length;++Pt)b(v1.indexOf(Tt[Pt])>=0,'invalid option for vao: "'+Tt[Pt]+'" valid options are '+v1)}),b(Array.isArray(le),"attributes must be an array")}b(le.length<ie,"too many attributes"),b(le.length>0,"must specify at least one attribute");var $e={},He=K.attributes;He.length=le.length;for(var je=0;je<le.length;++je){var xe=le[je],Te=He[je]=new Dc,Ie=xe.data||xe;if(Array.isArray(Ie)||n(Ie)||Rn(Ie)){var Ye;K.buffers[je]&&(Ye=K.buffers[je],n(Ie)&&Ye._buffer.byteLength>=Ie.byteLength?Ye.subdata(Ie):(Ye.destroy(),K.buffers[je]=null)),K.buffers[je]||(Ye=K.buffers[je]=J.create(xe,m1,!1,!0)),Te.buffer=J.getBuffer(Ye),Te.size=Te.buffer.dimension|0,Te.normalized=!1,Te.type=Te.buffer.dtype,Te.offset=0,Te.stride=0,Te.divisor=0,Te.state=1,$e[je]=1}else J.getBuffer(xe)?(Te.buffer=J.getBuffer(xe),Te.size=Te.buffer.dimension|0,Te.normalized=!1,Te.type=Te.buffer.dtype,Te.offset=0,Te.stride=0,Te.divisor=0,Te.state=1):J.getBuffer(xe.buffer)?(Te.buffer=J.getBuffer(xe.buffer),Te.size=(+xe.size||Te.buffer.dimension)|0,Te.normalized=!!xe.normalized||!1,"type"in xe?(b.parameter(xe.type,Lr,"invalid buffer type"),Te.type=Lr[xe.type]):Te.type=Te.buffer.dtype,Te.offset=(xe.offset||0)|0,Te.stride=(xe.stride||0)|0,Te.divisor=(xe.divisor||0)|0,Te.state=1,b(Te.size>=1&&Te.size<=4,"size must be between 1 and 4"),b(Te.offset>=0,"invalid offset"),b(Te.stride>=0&&Te.stride<=255,"stride must be between 0 and 255"),b(Te.divisor>=0,"divisor must be positive"),b(!Te.divisor||!!g.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in xe?(b(je>0,"first attribute must not be a constant"),Te.x=+xe.x||0,Te.y=+xe.y||0,Te.z=+xe.z||0,Te.w=+xe.w||0,Te.state=2):b(!1,"invalid attribute spec for location "+je)}for(var tt=0;tt<K.buffers.length;++tt)!$e[tt]&&K.buffers[tt]&&(K.buffers[tt].destroy(),K.buffers[tt]=null);return K.refresh(),Me}return Me.destroy=function(){for(var be=0;be<K.buffers.length;++be)K.buffers[be]&&K.buffers[be].destroy();K.buffers.length=0,K.ownsElements&&(K.elements.destroy(),K.elements=null,K.ownsElements=!1),K.destroy()},Me._vao=K,Me._reglType="vao",Me(ee)}return ye}var p1=35632,k2=35633,R2=35718,F2=35721;function G2(f,g,S,X){var J={},q={};function Y(D,H,ue,Se){this.name=D,this.id=H,this.location=ue,this.info=Se}function ie(D,H){for(var ue=0;ue<D.length;++ue)if(D[ue].id===H.id){D[ue].location=H.location;return}D.push(H)}function oe(D,H,ue){var Se=D===p1?J:q,re=Se[H];if(!re){var Ae=g.str(H);re=f.createShader(D),f.shaderSource(re,Ae),f.compileShader(re),b.shaderError(f,re,Ae,D,ue),Se[H]=re}return re}var he={},ve=[],me=0;function ye(D,H){this.id=me++,this.fragId=D,this.vertId=H,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,X.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function ae(D,H,ue){var Se,re,Ae=oe(p1,D.fragId),Ee=oe(k2,D.vertId),Ne=D.program=f.createProgram();if(f.attachShader(Ne,Ae),f.attachShader(Ne,Ee),ue)for(Se=0;Se<ue.length;++Se){var ee=ue[Se];f.bindAttribLocation(Ne,ee[0],ee[1])}f.linkProgram(Ne),b.linkError(f,Ne,g.str(D.fragId),g.str(D.vertId),H);var K=f.getProgramParameter(Ne,R2);X.profile&&(D.stats.uniformsCount=K);var Me=D.uniforms;for(Se=0;Se<K;++Se)if(re=f.getActiveUniform(Ne,Se),re){if(re.size>1)for(var be=0;be<re.size;++be){var le=re.name.replace("[0]","["+be+"]");ie(Me,new Y(le,g.id(le),f.getUniformLocation(Ne,le),re))}var _e=re.name;re.size>1&&(_e=_e.replace("[0]","")),ie(Me,new Y(_e,g.id(_e),f.getUniformLocation(Ne,_e),re))}var $e=f.getProgramParameter(Ne,F2);X.profile&&(D.stats.attributesCount=$e);var He=D.attributes;for(Se=0;Se<$e;++Se)re=f.getActiveAttrib(Ne,Se),re&&ie(He,new Y(re.name,g.id(re.name),f.getAttribLocation(Ne,re.name),re))}X.profile&&(S.getMaxUniformsCount=function(){var D=0;return ve.forEach(function(H){H.stats.uniformsCount>D&&(D=H.stats.uniformsCount)}),D},S.getMaxAttributesCount=function(){var D=0;return ve.forEach(function(H){H.stats.attributesCount>D&&(D=H.stats.attributesCount)}),D});function de(){J={},q={};for(var D=0;D<ve.length;++D)ae(ve[D],null,ve[D].attributes.map(function(H){return[H.location,H.name]}))}return{clear:function(){var D=f.deleteShader.bind(f);En(J).forEach(D),J={},En(q).forEach(D),q={},ve.forEach(function(H){f.deleteProgram(H.program)}),ve.length=0,he={},S.shaderCount=0},program:function(D,H,ue,Se){b.command(D>=0,"missing vertex shader",ue),b.command(H>=0,"missing fragment shader",ue);var re=he[H];re||(re=he[H]={});var Ae=re[D];if(Ae&&(Ae.refCount++,!Se))return Ae;var Ee=new ye(H,D);return S.shaderCount++,ae(Ee,ue,Se),Ae||(re[D]=Ee),ve.push(Ee),r(Ee,{destroy:function(){if(Ee.refCount--,Ee.refCount<=0){f.deleteProgram(Ee.program);var Ne=ve.indexOf(Ee);ve.splice(Ne,1),S.shaderCount--}re[Ee.vertId].refCount<=0&&(f.deleteShader(q[Ee.vertId]),delete q[Ee.vertId],delete he[Ee.fragId][Ee.vertId]),Object.keys(he[Ee.fragId]).length||(f.deleteShader(J[Ee.fragId]),delete J[Ee.fragId],delete he[Ee.fragId])}})},restore:de,shader:oe,frag:-1,vert:-1}}var N2=6408,mo=5121,D2=3333,Vi=5126;function B2(f,g,S,X,J,q,Y){function ie(ve){var me;g.next===null?(b(J.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),me=mo):(b(g.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),me=g.next.colorAttachments[0].texture._texture.type,b.optional(function(){q.oes_texture_float?(b(me===mo||me===Vi,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),me===Vi&&b(Y.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):b(me===mo,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var ye=0,ae=0,de=X.framebufferWidth,D=X.framebufferHeight,H=null;n(ve)?H=ve:ve&&(b.type(ve,"object","invalid arguments to regl.read()"),ye=ve.x|0,ae=ve.y|0,b(ye>=0&&ye<X.framebufferWidth,"invalid x offset for regl.read"),b(ae>=0&&ae<X.framebufferHeight,"invalid y offset for regl.read"),de=(ve.width||X.framebufferWidth-ye)|0,D=(ve.height||X.framebufferHeight-ae)|0,H=ve.data||null),H&&(me===mo?b(H instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):me===Vi&&b(H instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),b(de>0&&de+ye<=X.framebufferWidth,"invalid width for read pixels"),b(D>0&&D+ae<=X.framebufferHeight,"invalid height for read pixels"),S();var ue=de*D*4;return H||(me===mo?H=new Uint8Array(ue):me===Vi&&(H=H||new Float32Array(ue))),b.isTypedArray(H,"data buffer for regl.read() must be a typedarray"),b(H.byteLength>=ue,"data buffer for regl.read() too small"),f.pixelStorei(D2,4),f.readPixels(ye,ae,de,D,N2,me,H),H}function oe(ve){var me;return g.setFBO({framebuffer:ve.framebuffer},function(){me=ie(ve)}),me}function he(ve){return!ve||!("framebuffer"in ve)?ie(ve):oe(ve)}return he}function gs(f){return Array.prototype.slice.call(f)}function ys(f){return gs(f).join("")}function I2(){var f=0,g=[],S=[];function X(me){for(var ye=0;ye<S.length;++ye)if(S[ye]===me)return g[ye];var ae="g"+f++;return g.push(ae),S.push(me),ae}function J(){var me=[];function ye(){me.push.apply(me,gs(arguments))}var ae=[];function de(){var D="v"+f++;return ae.push(D),arguments.length>0&&(me.push(D,"="),me.push.apply(me,gs(arguments)),me.push(";")),D}return r(ye,{def:de,toString:function(){return ys([ae.length>0?"var "+ae.join(",")+";":"",ys(me)])}})}function q(){var me=J(),ye=J(),ae=me.toString,de=ye.toString;function D(H,ue){ye(H,ue,"=",me.def(H,ue),";")}return r(function(){me.apply(me,gs(arguments))},{def:me.def,entry:me,exit:ye,save:D,set:function(H,ue,Se){D(H,ue),me(H,ue,"=",Se,";")},toString:function(){return ae()+de()}})}function Y(){var me=ys(arguments),ye=q(),ae=q(),de=ye.toString,D=ae.toString;return r(ye,{then:function(){return ye.apply(ye,gs(arguments)),this},else:function(){return ae.apply(ae,gs(arguments)),this},toString:function(){var H=D();return H&&(H="else{"+H+"}"),ys(["if(",me,"){",de(),"}",H])}})}var ie=J(),oe={};function he(me,ye){var ae=[];function de(){var re="a"+ae.length;return ae.push(re),re}ye=ye||0;for(var D=0;D<ye;++D)de();var H=q(),ue=H.toString,Se=oe[me]=r(H,{arg:de,toString:function(){return ys(["function(",ae.join(),"){",ue(),"}"])}});return Se}function ve(){var me=['"use strict";',ie,"return {"];Object.keys(oe).forEach(function(de){me.push('"',de,'":',oe[de].toString(),",")}),me.push("}");var ye=ys(me).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),ae=Function.apply(null,g.concat(ye));return ae.apply(null,S)}return{global:ie,link:X,block:J,proc:he,scope:q,cond:Y,compile:ve}}var bs="xyzw".split(""),g1=5121,_s=1,Bc=2,Ic=0,Vc=1,zc=2,Uc=3,zi=4,y1=5,b1=6,_1="dither",w1="blend.enable",$1="blend.color",qc="blend.equation",Xc="blend.func",E1="depth.enable",x1="depth.func",A1="depth.range",T1="depth.mask",jc="colorMask",S1="cull.enable",P1="cull.face",Hc="frontFace",Yc="lineWidth",O1="polygonOffset.enable",Wc="polygonOffset.offset",C1="sample.alpha",M1="sample.enable",Zc="sample.coverage",L1="stencil.enable",k1="stencil.mask",Qc="stencil.func",Kc="stencil.opFront",vo="stencil.opBack",R1="scissor.enable",Ui="scissor.box",or="viewport",po="profile",Nr="framebuffer",go="vert",yo="frag",Dr="elements",Br="primitive",Ir="count",qi="offset",Xi="instances",bo="vao",Jc="Width",el="Height",ws=Nr+Jc,$s=Nr+el,V2=or+Jc,z2=or+el,F1="drawingBuffer",G1=F1+Jc,N1=F1+el,U2=[Xc,qc,Qc,Kc,vo,Zc,or,Ui,Wc],Es=34962,tl=34963,q2=35632,X2=35633,D1=3553,j2=34067,H2=2884,Y2=3042,W2=3024,Z2=2960,Q2=2929,K2=3089,J2=32823,ey=32926,ty=32928,nl=5126,ji=35664,Hi=35665,Yi=35666,rl=5124,Wi=35667,Zi=35668,Qi=35669,sl=35670,Ki=35671,Ji=35672,ea=35673,_o=35674,wo=35675,$o=35676,Eo=35678,xo=35680,ol=4,Ao=1028,Vr=1029,B1=2304,il=2305,ny=32775,ry=32776,sy=519,vr=7680,I1=0,V1=1,z1=32774,oy=513,U1=36160,iy=36064,Hn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},q1=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],xs={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},pr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},X1={frag:q2,vert:X2},al={cw:B1,ccw:il};function ta(f){return Array.isArray(f)||n(f)||Rn(f)}function j1(f){return f.sort(function(g,S){return g===or?-1:S===or?1:g<S?-1:1})}function Vt(f,g,S,X){this.thisDep=f,this.contextDep=g,this.propDep=S,this.append=X}function gr(f){return f&&!(f.thisDep||f.contextDep||f.propDep)}function Rt(f){return new Vt(!1,!1,!1,f)}function pn(f,g){var S=f.type;if(S===Ic){var X=f.data.length;return new Vt(!0,X>=1,X>=2,g)}else if(S===zi){var J=f.data;return new Vt(J.thisDep,J.contextDep,J.propDep,g)}else{if(S===y1)return new Vt(!1,!1,!1,g);if(S===b1){for(var q=!1,Y=!1,ie=!1,oe=0;oe<f.data.length;++oe){var he=f.data[oe];if(he.type===Vc)ie=!0;else if(he.type===zc)Y=!0;else if(he.type===Uc)q=!0;else if(he.type===Ic){q=!0;var ve=he.data;ve>=1&&(Y=!0),ve>=2&&(ie=!0)}else he.type===zi&&(q=q||he.data.thisDep,Y=Y||he.data.contextDep,ie=ie||he.data.propDep)}return new Vt(q,Y,ie,g)}else return new Vt(S===Uc,S===zc,S===Vc,g)}}var H1=new Vt(!1,!1,!1,function(){});function ay(f,g,S,X,J,q,Y,ie,oe,he,ve,me,ye,ae,de){var D=he.Record,H={add:32774,subtract:32778,"reverse subtract":32779};S.ext_blend_minmax&&(H.min=ny,H.max=ry);var ue=S.angle_instanced_arrays,Se=S.webgl_draw_buffers,re=S.oes_vertex_array_object,Ae={dirty:!0,profile:de.profile},Ee={},Ne=[],ee={},K={};function Me(_){return _.replace(".","_")}function be(_,v,O){var N=Me(_);Ne.push(_),Ee[N]=Ae[N]=!!O,ee[N]=v}function le(_,v,O){var N=Me(_);Ne.push(_),Array.isArray(O)?(Ae[N]=O.slice(),Ee[N]=O.slice()):Ae[N]=Ee[N]=O,K[N]=v}be(_1,W2),be(w1,Y2),le($1,"blendColor",[0,0,0,0]),le(qc,"blendEquationSeparate",[z1,z1]),le(Xc,"blendFuncSeparate",[V1,I1,V1,I1]),be(E1,Q2,!0),le(x1,"depthFunc",oy),le(A1,"depthRange",[0,1]),le(T1,"depthMask",!0),le(jc,jc,[!0,!0,!0,!0]),be(S1,H2),le(P1,"cullFace",Vr),le(Hc,Hc,il),le(Yc,Yc,1),be(O1,J2),le(Wc,"polygonOffset",[0,0]),be(C1,ey),be(M1,ty),le(Zc,"sampleCoverage",[1,!1]),be(L1,Z2),le(k1,"stencilMask",-1),le(Qc,"stencilFunc",[sy,0,-1]),le(Kc,"stencilOpSeparate",[Ao,vr,vr,vr]),le(vo,"stencilOpSeparate",[Vr,vr,vr,vr]),be(R1,K2),le(Ui,"scissor",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]),le(or,or,[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);var _e={gl:f,context:ye,strings:g,next:Ee,current:Ae,draw:me,elements:q,buffer:J,shader:ve,attributes:he.state,vao:he,uniforms:oe,framebuffer:ie,extensions:S,timer:ae,isBufferArgs:ta},$e={primTypes:hr,compareFuncs:xs,blendFuncs:Hn,blendEquations:H,stencilOps:pr,glTypes:Lr,orientationType:al};b.optional(function(){_e.isArrayLike=At}),Se&&($e.backBuffer=[Vr],$e.drawBuffer=pe(X.maxDrawbuffers,function(_){return _===0?[0]:pe(_,function(v){return iy+v})}));var He=0;function je(){var _=I2(),v=_.link,O=_.global;_.id=He++,_.batchId="0";var N=v(_e),I=_.shared={props:"a0"};Object.keys(_e).forEach(function(A){I[A]=O.def(N,".",A)}),b.optional(function(){_.CHECK=v(b),_.commandStr=b.guessCommand(),_.command=v(_.commandStr),_.assert=function(A,E,z){A("if(!(",E,"))",this.CHECK,".commandRaise(",v(z),",",this.command,");")},$e.invalidBlendCombinations=q1});var M=_.next={},C=_.current={};Object.keys(K).forEach(function(A){Array.isArray(Ae[A])&&(M[A]=O.def(I.next,".",A),C[A]=O.def(I.current,".",A))});var G=_.constants={};Object.keys($e).forEach(function(A){G[A]=O.def(JSON.stringify($e[A]))}),_.invoke=function(A,E){switch(E.type){case Ic:var z=["this",I.context,I.props,_.batchId];return A.def(v(E.data),".call(",z.slice(0,Math.max(E.data.length+1,4)),")");case Vc:return A.def(I.props,E.data);case zc:return A.def(I.context,E.data);case Uc:return A.def("this",E.data);case zi:return E.data.append(_,A),E.data.ref;case y1:return E.data.toString();case b1:return E.data.map(function(V){return _.invoke(A,V)})}},_.attribCache={};var $={};return _.scopeAttrib=function(A){var E=g.id(A);if(E in $)return $[E];var z=he.scope[E];z||(z=he.scope[E]=new D);var V=$[E]=v(z);return V},_}function xe(_){var v=_.static,O=_.dynamic,N;if(po in v){var I=!!v[po];N=Rt(function(C,G){return I}),N.enable=I}else if(po in O){var M=O[po];N=pn(M,function(C,G){return C.invoke(G,M)})}return N}function Te(_,v){var O=_.static,N=_.dynamic;if(Nr in O){var I=O[Nr];return I?(I=ie.getFramebuffer(I),b.command(I,"invalid framebuffer object"),Rt(function(C,G){var $=C.link(I),A=C.shared;G.set(A.framebuffer,".next",$);var E=A.context;return G.set(E,"."+ws,$+".width"),G.set(E,"."+$s,$+".height"),$})):Rt(function(C,G){var $=C.shared;G.set($.framebuffer,".next","null");var A=$.context;return G.set(A,"."+ws,A+"."+G1),G.set(A,"."+$s,A+"."+N1),"null"})}else if(Nr in N){var M=N[Nr];return pn(M,function(C,G){var $=C.invoke(G,M),A=C.shared,E=A.framebuffer,z=G.def(E,".getFramebuffer(",$,")");b.optional(function(){C.assert(G,"!"+$+"||"+z,"invalid framebuffer object")}),G.set(E,".next",z);var V=A.context;return G.set(V,"."+ws,z+"?"+z+".width:"+V+"."+G1),G.set(V,"."+$s,z+"?"+z+".height:"+V+"."+N1),z})}else return null}function Ie(_,v,O){var N=_.static,I=_.dynamic;function M($){if($ in N){var A=N[$];b.commandType(A,"object","invalid "+$,O.commandStr);var E=!0,z=A.x|0,V=A.y|0,Q,te;return"width"in A?(Q=A.width|0,b.command(Q>=0,"invalid "+$,O.commandStr)):E=!1,"height"in A?(te=A.height|0,b.command(te>=0,"invalid "+$,O.commandStr)):E=!1,new Vt(!E&&v&&v.thisDep,!E&&v&&v.contextDep,!E&&v&&v.propDep,function(Ge,Pe){var ne=Ge.shared.context,Z=Q;"width"in A||(Z=Pe.def(ne,".",ws,"-",z));var Re=te;return"height"in A||(Re=Pe.def(ne,".",$s,"-",V)),[z,V,Z,Re]})}else if($ in I){var ge=I[$],ze=pn(ge,function(Ge,Pe){var ne=Ge.invoke(Pe,ge);b.optional(function(){Ge.assert(Pe,ne+"&&typeof "+ne+'==="object"',"invalid "+$)});var Z=Ge.shared.context,Re=Pe.def(ne,".x|0"),Le=Pe.def(ne,".y|0"),Ve=Pe.def('"width" in ',ne,"?",ne,".width|0:","(",Z,".",ws,"-",Re,")"),ft=Pe.def('"height" in ',ne,"?",ne,".height|0:","(",Z,".",$s,"-",Le,")");return b.optional(function(){Ge.assert(Pe,Ve+">=0&&"+ft+">=0","invalid "+$)}),[Re,Le,Ve,ft]});return v&&(ze.thisDep=ze.thisDep||v.thisDep,ze.contextDep=ze.contextDep||v.contextDep,ze.propDep=ze.propDep||v.propDep),ze}else return v?new Vt(v.thisDep,v.contextDep,v.propDep,function(Ge,Pe){var ne=Ge.shared.context;return[0,0,Pe.def(ne,".",ws),Pe.def(ne,".",$s)]}):null}var C=M(or);if(C){var G=C;C=new Vt(C.thisDep,C.contextDep,C.propDep,function($,A){var E=G.append($,A),z=$.shared.context;return A.set(z,"."+V2,E[2]),A.set(z,"."+z2,E[3]),E})}return{viewport:C,scissor_box:M(Ui)}}function Ye(_,v){var O=_.static,N=typeof O[yo]=="string"&&typeof O[go]=="string";if(N){if(Object.keys(v.dynamic).length>0)return null;var I=v.static,M=Object.keys(I);if(M.length>0&&typeof I[M[0]]=="number"){for(var C=[],G=0;G<M.length;++G)b(typeof I[M[G]]=="number","must specify all vertex attribute locations when using vaos"),C.push([I[M[G]]|0,M[G]]);return C}}return null}function tt(_,v,O){var N=_.static,I=_.dynamic;function M(E){if(E in N){var z=g.id(N[E]);b.optional(function(){ve.shader(X1[E],z,b.guessCommand())});var V=Rt(function(){return z});return V.id=z,V}else if(E in I){var Q=I[E];return pn(Q,function(te,ge){var ze=te.invoke(ge,Q),Ge=ge.def(te.shared.strings,".id(",ze,")");return b.optional(function(){ge(te.shared.shader,".shader(",X1[E],",",Ge,",",te.command,");")}),Ge})}return null}var C=M(yo),G=M(go),$=null,A;return gr(C)&&gr(G)?($=ve.program(G.id,C.id,null,O),A=Rt(function(E,z){return E.link($)})):A=new Vt(C&&C.thisDep||G&&G.thisDep,C&&C.contextDep||G&&G.contextDep,C&&C.propDep||G&&G.propDep,function(E,z){var V=E.shared.shader,Q;C?Q=C.append(E,z):Q=z.def(V,".",yo);var te;G?te=G.append(E,z):te=z.def(V,".",go);var ge=V+".program("+te+","+Q;return b.optional(function(){ge+=","+E.command}),z.def(ge+")")}),{frag:C,vert:G,progVar:A,program:$}}function Tt(_,v){var O=_.static,N=_.dynamic,I={},M=!1;function C(){if(bo in O){var Pe=O[bo];return Pe!==null&&he.getVAO(Pe)===null&&(Pe=he.createVAO(Pe)),M=!0,I.vao=Pe,Rt(function(Z){var Re=he.getVAO(Pe);return Re?Z.link(Re):"null"})}else if(bo in N){M=!0;var ne=N[bo];return pn(ne,function(Z,Re){var Le=Z.invoke(Re,ne);return Re.def(Z.shared.vao+".getVAO("+Le+")")})}return null}var G=C(),$=!1;function A(){if(Dr in O){var Pe=O[Dr];if(I.elements=Pe,ta(Pe)){var ne=I.elements=q.create(Pe,!0);Pe=q.getElements(ne),$=!0}else Pe&&(Pe=q.getElements(Pe),$=!0,b.command(Pe,"invalid elements",v.commandStr));var Z=Rt(function(Le,Ve){if(Pe){var ft=Le.link(Pe);return Le.ELEMENTS=ft,ft}return Le.ELEMENTS=null,null});return Z.value=Pe,Z}else if(Dr in N){$=!0;var Re=N[Dr];return pn(Re,function(Le,Ve){var ft=Le.shared,Kt=ft.isBufferArgs,Ur=ft.elements,ir=Le.invoke(Ve,Re),Wn=Ve.def("null"),yr=Ve.def(Kt,"(",ir,")"),qr=Le.cond(yr).then(Wn,"=",Ur,".createStream(",ir,");").else(Wn,"=",Ur,".getElements(",ir,");");return b.optional(function(){Le.assert(qr.else,"!"+ir+"||"+Wn,"invalid elements")}),Ve.entry(qr),Ve.exit(Le.cond(yr).then(Ur,".destroyStream(",Wn,");")),Le.ELEMENTS=Wn,Wn})}else if(M)return new Vt(G.thisDep,G.contextDep,G.propDep,function(Le,Ve){return Ve.def(Le.shared.vao+".currentVAO?"+Le.shared.elements+".getElements("+Le.shared.vao+".currentVAO.elements):null")});return null}var E=A();function z(){if(Br in O){var Pe=O[Br];return I.primitive=Pe,b.commandParameter(Pe,hr,"invalid primitve",v.commandStr),Rt(function(Z,Re){return hr[Pe]})}else if(Br in N){var ne=N[Br];return pn(ne,function(Z,Re){var Le=Z.constants.primTypes,Ve=Z.invoke(Re,ne);return b.optional(function(){Z.assert(Re,Ve+" in "+Le,"invalid primitive, must be one of "+Object.keys(hr))}),Re.def(Le,"[",Ve,"]")})}else{if($)return gr(E)?E.value?Rt(function(Z,Re){return Re.def(Z.ELEMENTS,".primType")}):Rt(function(){return ol}):new Vt(E.thisDep,E.contextDep,E.propDep,function(Z,Re){var Le=Z.ELEMENTS;return Re.def(Le,"?",Le,".primType:",ol)});if(M)return new Vt(G.thisDep,G.contextDep,G.propDep,function(Z,Re){return Re.def(Z.shared.vao+".currentVAO?"+Z.shared.vao+".currentVAO.primitive:"+ol)})}return null}function V(Pe,ne){if(Pe in O){var Z=O[Pe]|0;return ne?I.offset=Z:I.instances=Z,b.command(!ne||Z>=0,"invalid "+Pe,v.commandStr),Rt(function(Le,Ve){return ne&&(Le.OFFSET=Z),Z})}else if(Pe in N){var Re=N[Pe];return pn(Re,function(Le,Ve){var ft=Le.invoke(Ve,Re);return ne&&(Le.OFFSET=ft,b.optional(function(){Le.assert(Ve,ft+">=0","invalid "+Pe)})),ft})}else if(ne){if($)return Rt(function(Le,Ve){return Le.OFFSET=0,0});if(M)return new Vt(G.thisDep,G.contextDep,G.propDep,function(Le,Ve){return Ve.def(Le.shared.vao+".currentVAO?"+Le.shared.vao+".currentVAO.offset:0")})}else if(M)return new Vt(G.thisDep,G.contextDep,G.propDep,function(Le,Ve){return Ve.def(Le.shared.vao+".currentVAO?"+Le.shared.vao+".currentVAO.instances:-1")});return null}var Q=V(qi,!0);function te(){if(Ir in O){var Pe=O[Ir]|0;return I.count=Pe,b.command(typeof Pe=="number"&&Pe>=0,"invalid vertex count",v.commandStr),Rt(function(){return Pe})}else if(Ir in N){var ne=N[Ir];return pn(ne,function(Ve,ft){var Kt=Ve.invoke(ft,ne);return b.optional(function(){Ve.assert(ft,"typeof "+Kt+'==="number"&&'+Kt+">=0&&"+Kt+"===("+Kt+"|0)","invalid vertex count")}),Kt})}else if($)if(gr(E)){if(E)return Q?new Vt(Q.thisDep,Q.contextDep,Q.propDep,function(Ve,ft){var Kt=ft.def(Ve.ELEMENTS,".vertCount-",Ve.OFFSET);return b.optional(function(){Ve.assert(ft,Kt+">=0","invalid vertex offset/element buffer too small")}),Kt}):Rt(function(Ve,ft){return ft.def(Ve.ELEMENTS,".vertCount")});var Z=Rt(function(){return-1});return b.optional(function(){Z.MISSING=!0}),Z}else{var Re=new Vt(E.thisDep||Q.thisDep,E.contextDep||Q.contextDep,E.propDep||Q.propDep,function(Ve,ft){var Kt=Ve.ELEMENTS;return Ve.OFFSET?ft.def(Kt,"?",Kt,".vertCount-",Ve.OFFSET,":-1"):ft.def(Kt,"?",Kt,".vertCount:-1")});return b.optional(function(){Re.DYNAMIC=!0}),Re}else if(M){var Le=new Vt(G.thisDep,G.contextDep,G.propDep,function(Ve,ft){return ft.def(Ve.shared.vao,".currentVAO?",Ve.shared.vao,".currentVAO.count:-1")});return Le}return null}var ge=z(),ze=te(),Ge=V(Xi,!1);return{elements:E,primitive:ge,count:ze,instances:Ge,offset:Q,vao:G,vaoActive:M,elementsActive:$,static:I}}function Pt(_,v){var O=_.static,N=_.dynamic,I={};return Ne.forEach(function(M){var C=Me(M);function G($,A){if(M in O){var E=$(O[M]);I[C]=Rt(function(){return E})}else if(M in N){var z=N[M];I[C]=pn(z,function(V,Q){return A(V,Q,V.invoke(Q,z))})}}switch(M){case S1:case w1:case _1:case L1:case E1:case R1:case O1:case C1:case M1:case T1:return G(function($){return b.commandType($,"boolean",M,v.commandStr),$},function($,A,E){return b.optional(function(){$.assert(A,"typeof "+E+'==="boolean"',"invalid flag "+M,$.commandStr)}),E});case x1:return G(function($){return b.commandParameter($,xs,"invalid "+M,v.commandStr),xs[$]},function($,A,E){var z=$.constants.compareFuncs;return b.optional(function(){$.assert(A,E+" in "+z,"invalid "+M+", must be one of "+Object.keys(xs))}),A.def(z,"[",E,"]")});case A1:return G(function($){return b.command(At($)&&$.length===2&&typeof $[0]=="number"&&typeof $[1]=="number"&&$[0]<=$[1],"depth range is 2d array",v.commandStr),$},function($,A,E){b.optional(function(){$.assert(A,$.shared.isArrayLike+"("+E+")&&"+E+".length===2&&typeof "+E+'[0]==="number"&&typeof '+E+'[1]==="number"&&'+E+"[0]<="+E+"[1]","depth range must be a 2d array")});var z=A.def("+",E,"[0]"),V=A.def("+",E,"[1]");return[z,V]});case Xc:return G(function($){b.commandType($,"object","blend.func",v.commandStr);var A="srcRGB"in $?$.srcRGB:$.src,E="srcAlpha"in $?$.srcAlpha:$.src,z="dstRGB"in $?$.dstRGB:$.dst,V="dstAlpha"in $?$.dstAlpha:$.dst;return b.commandParameter(A,Hn,C+".srcRGB",v.commandStr),b.commandParameter(E,Hn,C+".srcAlpha",v.commandStr),b.commandParameter(z,Hn,C+".dstRGB",v.commandStr),b.commandParameter(V,Hn,C+".dstAlpha",v.commandStr),b.command(q1.indexOf(A+", "+z)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+A+", "+z+")",v.commandStr),[Hn[A],Hn[z],Hn[E],Hn[V]]},function($,A,E){var z=$.constants.blendFuncs;b.optional(function(){$.assert(A,E+"&&typeof "+E+'==="object"',"invalid blend func, must be an object")});function V(ne,Z){var Re=A.def('"',ne,Z,'" in ',E,"?",E,".",ne,Z,":",E,".",ne);return b.optional(function(){$.assert(A,Re+" in "+z,"invalid "+M+"."+ne+Z+", must be one of "+Object.keys(Hn))}),Re}var Q=V("src","RGB"),te=V("dst","RGB");b.optional(function(){var ne=$.constants.invalidBlendCombinations;$.assert(A,ne+".indexOf("+Q+'+", "+'+te+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ge=A.def(z,"[",Q,"]"),ze=A.def(z,"[",V("src","Alpha"),"]"),Ge=A.def(z,"[",te,"]"),Pe=A.def(z,"[",V("dst","Alpha"),"]");return[ge,Ge,ze,Pe]});case qc:return G(function($){if(typeof $=="string")return b.commandParameter($,H,"invalid "+M,v.commandStr),[H[$],H[$]];if(typeof $=="object")return b.commandParameter($.rgb,H,M+".rgb",v.commandStr),b.commandParameter($.alpha,H,M+".alpha",v.commandStr),[H[$.rgb],H[$.alpha]];b.commandRaise("invalid blend.equation",v.commandStr)},function($,A,E){var z=$.constants.blendEquations,V=A.def(),Q=A.def(),te=$.cond("typeof ",E,'==="string"');return b.optional(function(){function ge(ze,Ge,Pe){$.assert(ze,Pe+" in "+z,"invalid "+Ge+", must be one of "+Object.keys(H))}ge(te.then,M,E),$.assert(te.else,E+"&&typeof "+E+'==="object"',"invalid "+M),ge(te.else,M+".rgb",E+".rgb"),ge(te.else,M+".alpha",E+".alpha")}),te.then(V,"=",Q,"=",z,"[",E,"];"),te.else(V,"=",z,"[",E,".rgb];",Q,"=",z,"[",E,".alpha];"),A(te),[V,Q]});case $1:return G(function($){return b.command(At($)&&$.length===4,"blend.color must be a 4d array",v.commandStr),pe(4,function(A){return+$[A]})},function($,A,E){return b.optional(function(){$.assert(A,$.shared.isArrayLike+"("+E+")&&"+E+".length===4","blend.color must be a 4d array")}),pe(4,function(z){return A.def("+",E,"[",z,"]")})});case k1:return G(function($){return b.commandType($,"number",C,v.commandStr),$|0},function($,A,E){return b.optional(function(){$.assert(A,"typeof "+E+'==="number"',"invalid stencil.mask")}),A.def(E,"|0")});case Qc:return G(function($){b.commandType($,"object",C,v.commandStr);var A=$.cmp||"keep",E=$.ref||0,z="mask"in $?$.mask:-1;return b.commandParameter(A,xs,M+".cmp",v.commandStr),b.commandType(E,"number",M+".ref",v.commandStr),b.commandType(z,"number",M+".mask",v.commandStr),[xs[A],E,z]},function($,A,E){var z=$.constants.compareFuncs;b.optional(function(){function ge(){$.assert(A,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ge(E+"&&typeof ",E,'==="object"'),ge('!("cmp" in ',E,")||(",E,".cmp in ",z,")")});var V=A.def('"cmp" in ',E,"?",z,"[",E,".cmp]",":",vr),Q=A.def(E,".ref|0"),te=A.def('"mask" in ',E,"?",E,".mask|0:-1");return[V,Q,te]});case Kc:case vo:return G(function($){b.commandType($,"object",C,v.commandStr);var A=$.fail||"keep",E=$.zfail||"keep",z=$.zpass||"keep";return b.commandParameter(A,pr,M+".fail",v.commandStr),b.commandParameter(E,pr,M+".zfail",v.commandStr),b.commandParameter(z,pr,M+".zpass",v.commandStr),[M===vo?Vr:Ao,pr[A],pr[E],pr[z]]},function($,A,E){var z=$.constants.stencilOps;b.optional(function(){$.assert(A,E+"&&typeof "+E+'==="object"',"invalid "+M)});function V(Q){return b.optional(function(){$.assert(A,'!("'+Q+'" in '+E+")||("+E+"."+Q+" in "+z+")","invalid "+M+"."+Q+", must be one of "+Object.keys(pr))}),A.def('"',Q,'" in ',E,"?",z,"[",E,".",Q,"]:",vr)}return[M===vo?Vr:Ao,V("fail"),V("zfail"),V("zpass")]});case Wc:return G(function($){b.commandType($,"object",C,v.commandStr);var A=$.factor|0,E=$.units|0;return b.commandType(A,"number",C+".factor",v.commandStr),b.commandType(E,"number",C+".units",v.commandStr),[A,E]},function($,A,E){b.optional(function(){$.assert(A,E+"&&typeof "+E+'==="object"',"invalid "+M)});var z=A.def(E,".factor|0"),V=A.def(E,".units|0");return[z,V]});case P1:return G(function($){var A=0;return $==="front"?A=Ao:$==="back"&&(A=Vr),b.command(!!A,C,v.commandStr),A},function($,A,E){return b.optional(function(){$.assert(A,E+'==="front"||'+E+'==="back"',"invalid cull.face")}),A.def(E,'==="front"?',Ao,":",Vr)});case Yc:return G(function($){return b.command(typeof $=="number"&&$>=X.lineWidthDims[0]&&$<=X.lineWidthDims[1],"invalid line width, must be a positive number between "+X.lineWidthDims[0]+" and "+X.lineWidthDims[1],v.commandStr),$},function($,A,E){return b.optional(function(){$.assert(A,"typeof "+E+'==="number"&&'+E+">="+X.lineWidthDims[0]+"&&"+E+"<="+X.lineWidthDims[1],"invalid line width")}),E});case Hc:return G(function($){return b.commandParameter($,al,C,v.commandStr),al[$]},function($,A,E){return b.optional(function(){$.assert(A,E+'==="cw"||'+E+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),A.def(E+'==="cw"?'+B1+":"+il)});case jc:return G(function($){return b.command(At($)&&$.length===4,"color.mask must be length 4 array",v.commandStr),$.map(function(A){return!!A})},function($,A,E){return b.optional(function(){$.assert(A,$.shared.isArrayLike+"("+E+")&&"+E+".length===4","invalid color.mask")}),pe(4,function(z){return"!!"+E+"["+z+"]"})});case Zc:return G(function($){b.command(typeof $=="object"&&$,C,v.commandStr);var A="value"in $?$.value:1,E=!!$.invert;return b.command(typeof A=="number"&&A>=0&&A<=1,"sample.coverage.value must be a number between 0 and 1",v.commandStr),[A,E]},function($,A,E){b.optional(function(){$.assert(A,E+"&&typeof "+E+'==="object"',"invalid sample.coverage")});var z=A.def('"value" in ',E,"?+",E,".value:1"),V=A.def("!!",E,".invert");return[z,V]})}}),I}function rt(_,v){var O=_.static,N=_.dynamic,I={};return Object.keys(O).forEach(function(M){var C=O[M],G;if(typeof C=="number"||typeof C=="boolean")G=Rt(function(){return C});else if(typeof C=="function"){var $=C._reglType;$==="texture2d"||$==="textureCube"?G=Rt(function(A){return A.link(C)}):$==="framebuffer"||$==="framebufferCube"?(b.command(C.color.length>0,'missing color attachment for framebuffer sent to uniform "'+M+'"',v.commandStr),G=Rt(function(A){return A.link(C.color[0])})):b.commandRaise('invalid data for uniform "'+M+'"',v.commandStr)}else At(C)?G=Rt(function(A){var E=A.global.def("[",pe(C.length,function(z){return b.command(typeof C[z]=="number"||typeof C[z]=="boolean","invalid uniform "+M,A.commandStr),C[z]}),"]");return E}):b.commandRaise('invalid or missing data for uniform "'+M+'"',v.commandStr);G.value=C,I[M]=G}),Object.keys(N).forEach(function(M){var C=N[M];I[M]=pn(C,function(G,$){return G.invoke($,C)})}),I}function Nt(_,v){var O=_.static,N=_.dynamic,I={};return Object.keys(O).forEach(function(M){var C=O[M],G=g.id(M),$=new D;if(ta(C))$.state=_s,$.buffer=J.getBuffer(J.create(C,Es,!1,!0)),$.type=0;else{var A=J.getBuffer(C);if(A)$.state=_s,$.buffer=A,$.type=0;else if(b.command(typeof C=="object"&&C,"invalid data for attribute "+M,v.commandStr),"constant"in C){var E=C.constant;$.buffer="null",$.state=Bc,typeof E=="number"?$.x=E:(b.command(At(E)&&E.length>0&&E.length<=4,"invalid constant for attribute "+M,v.commandStr),bs.forEach(function(Ge,Pe){Pe<E.length&&($[Ge]=E[Pe])}))}else{ta(C.buffer)?A=J.getBuffer(J.create(C.buffer,Es,!1,!0)):A=J.getBuffer(C.buffer),b.command(!!A,'missing buffer for attribute "'+M+'"',v.commandStr);var z=C.offset|0;b.command(z>=0,'invalid offset for attribute "'+M+'"',v.commandStr);var V=C.stride|0;b.command(V>=0&&V<256,'invalid stride for attribute "'+M+'", must be integer betweeen [0, 255]',v.commandStr);var Q=C.size|0;b.command(!("size"in C)||Q>0&&Q<=4,'invalid size for attribute "'+M+'", must be 1,2,3,4',v.commandStr);var te=!!C.normalized,ge=0;"type"in C&&(b.commandParameter(C.type,Lr,"invalid type for attribute "+M,v.commandStr),ge=Lr[C.type]);var ze=C.divisor|0;b.optional(function(){"divisor"in C&&(b.command(ze===0||ue,'cannot specify divisor for attribute "'+M+'", instancing not supported',v.commandStr),b.command(ze>=0,'invalid divisor for attribute "'+M+'"',v.commandStr));var Ge=v.commandStr,Pe=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(C).forEach(function(ne){b.command(Pe.indexOf(ne)>=0,'unknown parameter "'+ne+'" for attribute pointer "'+M+'" (valid parameters are '+Pe+")",Ge)})}),$.buffer=A,$.state=_s,$.size=Q,$.normalized=te,$.type=ge||A.dtype,$.offset=z,$.stride=V,$.divisor=ze}}I[M]=Rt(function(Ge,Pe){var ne=Ge.attribCache;if(G in ne)return ne[G];var Z={isStream:!1};return Object.keys($).forEach(function(Re){Z[Re]=$[Re]}),$.buffer&&(Z.buffer=Ge.link($.buffer),Z.type=Z.type||Z.buffer+".dtype"),ne[G]=Z,Z})}),Object.keys(N).forEach(function(M){var C=N[M];function G($,A){var E=$.invoke(A,C),z=$.shared,V=$.constants,Q=z.isBufferArgs,te=z.buffer;b.optional(function(){$.assert(A,E+"&&(typeof "+E+'==="object"||typeof '+E+'==="function")&&('+Q+"("+E+")||"+te+".getBuffer("+E+")||"+te+".getBuffer("+E+".buffer)||"+Q+"("+E+'.buffer)||("constant" in '+E+"&&(typeof "+E+'.constant==="number"||'+z.isArrayLike+"("+E+".constant))))",'invalid dynamic attribute "'+M+'"')});var ge={isStream:A.def(!1)},ze=new D;ze.state=_s,Object.keys(ze).forEach(function(Z){ge[Z]=A.def(""+ze[Z])});var Ge=ge.buffer,Pe=ge.type;A("if(",Q,"(",E,")){",ge.isStream,"=true;",Ge,"=",te,".createStream(",Es,",",E,");",Pe,"=",Ge,".dtype;","}else{",Ge,"=",te,".getBuffer(",E,");","if(",Ge,"){",Pe,"=",Ge,".dtype;",'}else if("constant" in ',E,"){",ge.state,"=",Bc,";","if(typeof "+E+'.constant === "number"){',ge[bs[0]],"=",E,".constant;",bs.slice(1).map(function(Z){return ge[Z]}).join("="),"=0;","}else{",bs.map(function(Z,Re){return ge[Z]+"="+E+".constant.length>"+Re+"?"+E+".constant["+Re+"]:0;"}).join(""),"}}else{","if(",Q,"(",E,".buffer)){",Ge,"=",te,".createStream(",Es,",",E,".buffer);","}else{",Ge,"=",te,".getBuffer(",E,".buffer);","}",Pe,'="type" in ',E,"?",V.glTypes,"[",E,".type]:",Ge,".dtype;",ge.normalized,"=!!",E,".normalized;");function ne(Z){A(ge[Z],"=",E,".",Z,"|0;")}return ne("size"),ne("offset"),ne("stride"),ne("divisor"),A("}}"),A.exit("if(",ge.isStream,"){",te,".destroyStream(",Ge,");","}"),ge}I[M]=pn(C,G)}),I}function yt(_){var v=_.static,O=_.dynamic,N={};return Object.keys(v).forEach(function(I){var M=v[I];N[I]=Rt(function(C,G){return typeof M=="number"||typeof M=="boolean"?""+M:C.link(M)})}),Object.keys(O).forEach(function(I){var M=O[I];N[I]=pn(M,function(C,G){return C.invoke(G,M)})}),N}function Ft(_,v,O,N,I){var M=_.static,C=_.dynamic;b.optional(function(){var ne=[Nr,go,yo,Dr,Br,qi,Ir,Xi,po,bo].concat(Ne);function Z(Re){Object.keys(Re).forEach(function(Le){b.command(ne.indexOf(Le)>=0,'unknown parameter "'+Le+'"',I.commandStr)})}Z(M),Z(C)});var G=Ye(_,v),$=Te(_),A=Ie(_,$,I),E=Tt(_,I),z=Pt(_,I),V=tt(_,I,G);function Q(ne){var Z=A[ne];Z&&(z[ne]=Z)}Q(or),Q(Me(Ui));var te=Object.keys(z).length>0,ge={framebuffer:$,draw:E,shader:V,state:z,dirty:te,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ge.profile=xe(_),ge.uniforms=rt(O,I),ge.drawVAO=ge.scopeVAO=E.vao,!ge.drawVAO&&V.program&&!G&&S.angle_instanced_arrays&&E.static.elements){var ze=!0,Ge=V.program.attributes.map(function(ne){var Z=v.static[ne];return ze=ze&&!!Z,Z});if(ze&&Ge.length>0){var Pe=he.getVAO(he.createVAO({attributes:Ge,elements:E.static.elements}));ge.drawVAO=new Vt(null,null,null,function(ne,Z){return ne.link(Pe)}),ge.useVAO=!0}}return G?ge.useVAO=!0:ge.attributes=Nt(v,I),ge.context=yt(N),ge}function Dt(_,v,O){var N=_.shared,I=N.context,M=_.scope();Object.keys(O).forEach(function(C){v.save(I,"."+C);var G=O[C],$=G.append(_,v);Array.isArray($)?M(I,".",C,"=[",$.join(),"];"):M(I,".",C,"=",$,";")}),v(M)}function Bt(_,v,O,N){var I=_.shared,M=I.gl,C=I.framebuffer,G;Se&&(G=v.def(I.extensions,".webgl_draw_buffers"));var $=_.constants,A=$.drawBuffer,E=$.backBuffer,z;O?z=O.append(_,v):z=v.def(C,".next"),N||v("if(",z,"!==",C,".cur){"),v("if(",z,"){",M,".bindFramebuffer(",U1,",",z,".framebuffer);"),Se&&v(G,".drawBuffersWEBGL(",A,"[",z,".colorAttachments.length]);"),v("}else{",M,".bindFramebuffer(",U1,",null);"),Se&&v(G,".drawBuffersWEBGL(",E,");"),v("}",C,".cur=",z,";"),N||v("}")}function Xt(_,v,O){var N=_.shared,I=N.gl,M=_.current,C=_.next,G=N.current,$=N.next,A=_.cond(G,".dirty");Ne.forEach(function(E){var z=Me(E);if(!(z in O.state)){var V,Q;if(z in C){V=C[z],Q=M[z];var te=pe(Ae[z].length,function(ze){return A.def(V,"[",ze,"]")});A(_.cond(te.map(function(ze,Ge){return ze+"!=="+Q+"["+Ge+"]"}).join("||")).then(I,".",K[z],"(",te,");",te.map(function(ze,Ge){return Q+"["+Ge+"]="+ze}).join(";"),";"))}else{V=A.def($,".",z);var ge=_.cond(V,"!==",G,".",z);A(ge),z in ee?ge(_.cond(V).then(I,".enable(",ee[z],");").else(I,".disable(",ee[z],");"),G,".",z,"=",V,";"):ge(I,".",K[z],"(",V,");",G,".",z,"=",V,";")}}}),Object.keys(O.state).length===0&&A(G,".dirty=false;"),v(A)}function Zt(_,v,O,N){var I=_.shared,M=_.current,C=I.current,G=I.gl;j1(Object.keys(O)).forEach(function($){var A=O[$];if(!(N&&!N(A))){var E=A.append(_,v);if(ee[$]){var z=ee[$];gr(A)?E?v(G,".enable(",z,");"):v(G,".disable(",z,");"):v(_.cond(E).then(G,".enable(",z,");").else(G,".disable(",z,");")),v(C,".",$,"=",E,";")}else if(At(E)){var V=M[$];v(G,".",K[$],"(",E,");",E.map(function(Q,te){return V+"["+te+"]="+Q}).join(";"),";")}else v(G,".",K[$],"(",E,");",C,".",$,"=",E,";")}})}function Ct(_,v){ue&&(_.instancing=v.def(_.shared.extensions,".angle_instanced_arrays"))}function We(_,v,O,N,I){var M=_.shared,C=_.stats,G=M.current,$=M.timer,A=O.profile;function E(){return typeof performance>"u"?"Date.now()":"performance.now()"}var z,V;function Q(ne){z=v.def(),ne(z,"=",E(),";"),typeof I=="string"?ne(C,".count+=",I,";"):ne(C,".count++;"),ae&&(N?(V=v.def(),ne(V,"=",$,".getNumPendingQueries();")):ne($,".beginQuery(",C,");"))}function te(ne){ne(C,".cpuTime+=",E(),"-",z,";"),ae&&(N?ne($,".pushScopeStats(",V,",",$,".getNumPendingQueries(),",C,");"):ne($,".endQuery();"))}function ge(ne){var Z=v.def(G,".profile");v(G,".profile=",ne,";"),v.exit(G,".profile=",Z,";")}var ze;if(A){if(gr(A)){A.enable?(Q(v),te(v.exit),ge("true")):ge("false");return}ze=A.append(_,v),ge(ze)}else ze=v.def(G,".profile");var Ge=_.block();Q(Ge),v("if(",ze,"){",Ge,"}");var Pe=_.block();te(Pe),v.exit("if(",ze,"){",Pe,"}")}function Qt(_,v,O,N,I){var M=_.shared;function C($){switch($){case ji:case Wi:case Ki:return 2;case Hi:case Zi:case Ji:return 3;case Yi:case Qi:case ea:return 4;default:return 1}}function G($,A,E){var z=M.gl,V=v.def($,".location"),Q=v.def(M.attributes,"[",V,"]"),te=E.state,ge=E.buffer,ze=[E.x,E.y,E.z,E.w],Ge=["buffer","normalized","offset","stride"];function Pe(){v("if(!",Q,".buffer){",z,".enableVertexAttribArray(",V,");}");var Z=E.type,Re;if(E.size?Re=v.def(E.size,"||",A):Re=A,v("if(",Q,".type!==",Z,"||",Q,".size!==",Re,"||",Ge.map(function(Ve){return Q+"."+Ve+"!=="+E[Ve]}).join("||"),"){",z,".bindBuffer(",Es,",",ge,".buffer);",z,".vertexAttribPointer(",[V,Re,Z,E.normalized,E.stride,E.offset],");",Q,".type=",Z,";",Q,".size=",Re,";",Ge.map(function(Ve){return Q+"."+Ve+"="+E[Ve]+";"}).join(""),"}"),ue){var Le=E.divisor;v("if(",Q,".divisor!==",Le,"){",_.instancing,".vertexAttribDivisorANGLE(",[V,Le],");",Q,".divisor=",Le,";}")}}function ne(){v("if(",Q,".buffer){",z,".disableVertexAttribArray(",V,");",Q,".buffer=null;","}if(",bs.map(function(Z,Re){return Q+"."+Z+"!=="+ze[Re]}).join("||"),"){",z,".vertexAttrib4f(",V,",",ze,");",bs.map(function(Z,Re){return Q+"."+Z+"="+ze[Re]+";"}).join(""),"}")}te===_s?Pe():te===Bc?ne():(v("if(",te,"===",_s,"){"),Pe(),v("}else{"),ne(),v("}"))}N.forEach(function($){var A=$.name,E=O.attributes[A],z;if(E){if(!I(E))return;z=E.append(_,v)}else{if(!I(H1))return;var V=_.scopeAttrib(A);b.optional(function(){_.assert(v,V+".state","missing attribute "+A)}),z={},Object.keys(new D).forEach(function(Q){z[Q]=v.def(V,".",Q)})}G(_.link($),C($.info.type),z)})}function lt(_,v,O,N,I,M){for(var C=_.shared,G=C.gl,$={},A,E=0;E<N.length;++E){var z=N[E],V=z.name,Q=z.info.type,te=z.info.size,ge=O.uniforms[V];if(te>1){if(!ge)continue;var ze=V.replace("[0]","");if($[ze])continue;$[ze]=1}var Ge=_.link(z),Pe=Ge+".location",ne;if(ge){if(!I(ge))continue;if(gr(ge)){var Z=ge.value;if(b.command(Z!==null&&typeof Z<"u",'missing uniform "'+V+'"',_.commandStr),Q===Eo||Q===xo){b.command(typeof Z=="function"&&(Q===Eo&&(Z._reglType==="texture2d"||Z._reglType==="framebuffer")||Q===xo&&(Z._reglType==="textureCube"||Z._reglType==="framebufferCube")),"invalid texture for uniform "+V,_.commandStr);var Re=_.link(Z._texture||Z.color[0]._texture);v(G,".uniform1i(",Pe,",",Re+".bind());"),v.exit(Re,".unbind();")}else if(Q===_o||Q===wo||Q===$o){b.optional(function(){b.command(At(Z),"invalid matrix for uniform "+V,_.commandStr),b.command(Q===_o&&Z.length===4||Q===wo&&Z.length===9||Q===$o&&Z.length===16,"invalid length for matrix uniform "+V,_.commandStr)});var Le=_.global.def("new Float32Array(["+Array.prototype.slice.call(Z)+"])"),Ve=2;Q===wo?Ve=3:Q===$o&&(Ve=4),v(G,".uniformMatrix",Ve,"fv(",Pe,",false,",Le,");")}else{switch(Q){case nl:te===1?b.commandType(Z,"number","uniform "+V,_.commandStr):b.command(At(Z)&&Z.length===te,"uniform "+V,_.commandStr),A="1f";break;case ji:b.command(At(Z)&&Z.length&&Z.length%2===0&&Z.length<=te*2,"uniform "+V,_.commandStr),A="2f";break;case Hi:b.command(At(Z)&&Z.length&&Z.length%3===0&&Z.length<=te*3,"uniform "+V,_.commandStr),A="3f";break;case Yi:b.command(At(Z)&&Z.length&&Z.length%4===0&&Z.length<=te*4,"uniform "+V,_.commandStr),A="4f";break;case sl:te===1?b.commandType(Z,"boolean","uniform "+V,_.commandStr):b.command(At(Z)&&Z.length===te,"uniform "+V,_.commandStr),A="1i";break;case rl:te===1?b.commandType(Z,"number","uniform "+V,_.commandStr):b.command(At(Z)&&Z.length===te,"uniform "+V,_.commandStr),A="1i";break;case Ki:b.command(At(Z)&&Z.length&&Z.length%2===0&&Z.length<=te*2,"uniform "+V,_.commandStr),A="2i";break;case Wi:b.command(At(Z)&&Z.length&&Z.length%2===0&&Z.length<=te*2,"uniform "+V,_.commandStr),A="2i";break;case Ji:b.command(At(Z)&&Z.length&&Z.length%3===0&&Z.length<=te*3,"uniform "+V,_.commandStr),A="3i";break;case Zi:b.command(At(Z)&&Z.length&&Z.length%3===0&&Z.length<=te*3,"uniform "+V,_.commandStr),A="3i";break;case ea:b.command(At(Z)&&Z.length&&Z.length%4===0&&Z.length<=te*4,"uniform "+V,_.commandStr),A="4i";break;case Qi:b.command(At(Z)&&Z.length&&Z.length%4===0&&Z.length<=te*4,"uniform "+V,_.commandStr),A="4i";break}te>1?(A+="v",Z=_.global.def("["+Array.prototype.slice.call(Z)+"]")):Z=At(Z)?Array.prototype.slice.call(Z):Z,v(G,".uniform",A,"(",Pe,",",Z,");")}continue}else ne=ge.append(_,v)}else{if(!I(H1))continue;ne=v.def(C.uniforms,"[",g.id(V),"]")}Q===Eo?(b(!Array.isArray(ne),"must specify a scalar prop for textures"),v("if(",ne,"&&",ne,'._reglType==="framebuffer"){',ne,"=",ne,".color[0];","}")):Q===xo&&(b(!Array.isArray(ne),"must specify a scalar prop for cube maps"),v("if(",ne,"&&",ne,'._reglType==="framebufferCube"){',ne,"=",ne,".color[0];","}")),b.optional(function(){function xn(gn,na){_.assert(v,gn,'bad data or missing for uniform "'+V+'".  '+na)}function Xr(gn,na){na===1&&b(!Array.isArray(ne),"must not specify an array type for uniform"),xn("Array.isArray("+ne+") && typeof "+ne+'[0]===" '+gn+'" || typeof '+ne+'==="'+gn+'"',"invalid type, expected "+gn)}function Cn(gn,na,ra){Array.isArray(ne)?b(ne.length&&ne.length%gn===0&&ne.length<=gn*ra,"must have length of "+(ra===1?"":"n * ")+gn):xn(C.isArrayLike+"("+ne+")&&"+ne+".length && "+ne+".length % "+gn+" === 0 && "+ne+".length<="+gn*ra,"invalid vector, should have length of "+(ra===1?"":"n * ")+gn,_.commandStr)}function ed(gn){b(!Array.isArray(ne),"must not specify a value type"),xn("typeof "+ne+'==="function"&&'+ne+'._reglType==="texture'+(gn===D1?"2d":"Cube")+'"',"invalid texture type",_.commandStr)}switch(Q){case rl:Xr("number",te);break;case Wi:Cn(2,"number",te);break;case Zi:Cn(3,"number",te);break;case Qi:Cn(4,"number",te);break;case nl:Xr("number",te);break;case ji:Cn(2,"number",te);break;case Hi:Cn(3,"number",te);break;case Yi:Cn(4,"number",te);break;case sl:Xr("boolean",te);break;case Ki:Cn(2,"boolean",te);break;case Ji:Cn(3,"boolean",te);break;case ea:Cn(4,"boolean",te);break;case _o:Cn(4,"number",te);break;case wo:Cn(9,"number",te);break;case $o:Cn(16,"number",te);break;case Eo:ed(D1);break;case xo:ed(j2);break}});var ft=1;switch(Q){case Eo:case xo:var Kt=v.def(ne,"._texture");v(G,".uniform1i(",Pe,",",Kt,".bind());"),v.exit(Kt,".unbind();");continue;case rl:case sl:A="1i";break;case Wi:case Ki:A="2i",ft=2;break;case Zi:case Ji:A="3i",ft=3;break;case Qi:case ea:A="4i",ft=4;break;case nl:A="1f";break;case ji:A="2f",ft=2;break;case Hi:A="3f",ft=3;break;case Yi:A="4f",ft=4;break;case _o:A="Matrix2fv";break;case wo:A="Matrix3fv";break;case $o:A="Matrix4fv";break}if(A.indexOf("Matrix")===-1&&te>1&&(A+="v",ft=1),A.charAt(0)==="M"){v(G,".uniform",A,"(",Pe,",");var Ur=Math.pow(Q-_o+2,2),ir=_.global.def("new Float32Array(",Ur,")");Array.isArray(ne)?v("false,(",pe(Ur,function(xn){return ir+"["+xn+"]="+ne[xn]}),",",ir,")"):v("false,(Array.isArray(",ne,")||",ne," instanceof Float32Array)?",ne,":(",pe(Ur,function(xn){return ir+"["+xn+"]="+ne+"["+xn+"]"}),",",ir,")"),v(");")}else if(ft>1){for(var Wn=[],yr=[],qr=0;qr<ft;++qr)Array.isArray(ne)?yr.push(ne[qr]):yr.push(v.def(ne+"["+qr+"]")),M&&Wn.push(v.def());M&&v("if(!",_.batchId,"||",Wn.map(function(xn,Xr){return xn+"!=="+yr[Xr]}).join("||"),"){",Wn.map(function(xn,Xr){return xn+"="+yr[Xr]+";"}).join("")),v(G,".uniform",A,"(",Pe,",",yr.join(","),");"),M&&v("}")}else{if(b(!Array.isArray(ne),"uniform value must not be an array"),M){var J1=v.def();v("if(!",_.batchId,"||",J1,"!==",ne,"){",J1,"=",ne,";")}v(G,".uniform",A,"(",Pe,",",ne,");"),M&&v("}")}}}function Be(_,v,O,N){var I=_.shared,M=I.gl,C=I.draw,G=N.draw;function $(){var Re=G.elements,Le,Ve=v;return Re?((Re.contextDep&&N.contextDynamic||Re.propDep)&&(Ve=O),Le=Re.append(_,Ve),G.elementsActive&&Ve("if("+Le+")"+M+".bindBuffer("+tl+","+Le+".buffer.buffer);")):(Le=Ve.def(),Ve(Le,"=",C,".",Dr,";","if(",Le,"){",M,".bindBuffer(",tl,",",Le,".buffer.buffer);}","else if(",I.vao,".currentVAO){",Le,"=",_.shared.elements+".getElements("+I.vao,".currentVAO.elements);",re?"":"if("+Le+")"+M+".bindBuffer("+tl+","+Le+".buffer.buffer);","}")),Le}function A(){var Re=G.count,Le,Ve=v;return Re?((Re.contextDep&&N.contextDynamic||Re.propDep)&&(Ve=O),Le=Re.append(_,Ve),b.optional(function(){Re.MISSING&&_.assert(v,"false","missing vertex count"),Re.DYNAMIC&&_.assert(Ve,Le+">=0","missing vertex count")})):(Le=Ve.def(C,".",Ir),b.optional(function(){_.assert(Ve,Le+">=0","missing vertex count")})),Le}var E=$();function z(Re){var Le=G[Re];return Le?Le.contextDep&&N.contextDynamic||Le.propDep?Le.append(_,O):Le.append(_,v):v.def(C,".",Re)}var V=z(Br),Q=z(qi),te=A();if(typeof te=="number"){if(te===0)return}else O("if(",te,"){"),O.exit("}");var ge,ze;ue&&(ge=z(Xi),ze=_.instancing);var Ge=E+".type",Pe=G.elements&&gr(G.elements)&&!G.vaoActive;function ne(){function Re(){O(ze,".drawElementsInstancedANGLE(",[V,te,Ge,Q+"<<(("+Ge+"-"+g1+")>>1)",ge],");")}function Le(){O(ze,".drawArraysInstancedANGLE(",[V,Q,te,ge],");")}E&&E!=="null"?Pe?Re():(O("if(",E,"){"),Re(),O("}else{"),Le(),O("}")):Le()}function Z(){function Re(){O(M+".drawElements("+[V,te,Ge,Q+"<<(("+Ge+"-"+g1+")>>1)"]+");")}function Le(){O(M+".drawArrays("+[V,Q,te]+");")}E&&E!=="null"?Pe?Re():(O("if(",E,"){"),Re(),O("}else{"),Le(),O("}")):Le()}ue&&(typeof ge!="number"||ge>=0)?typeof ge=="string"?(O("if(",ge,">0){"),ne(),O("}else if(",ge,"<0){"),Z(),O("}")):ne():Z()}function nt(_,v,O,N,I){var M=je(),C=M.proc("body",I);return b.optional(function(){M.commandStr=v.commandStr,M.command=M.link(v.commandStr)}),ue&&(M.instancing=C.def(M.shared.extensions,".angle_instanced_arrays")),_(M,C,O,N),M.compile().body}function ot(_,v,O,N){Ct(_,v),O.useVAO?O.drawVAO?v(_.shared.vao,".setVAO(",O.drawVAO.append(_,v),");"):v(_.shared.vao,".setVAO(",_.shared.vao,".targetVAO);"):(v(_.shared.vao,".setVAO(null);"),Qt(_,v,O,N.attributes,function(){return!0})),lt(_,v,O,N.uniforms,function(){return!0},!1),Be(_,v,v,O)}function Mt(_,v){var O=_.proc("draw",1);Ct(_,O),Dt(_,O,v.context),Bt(_,O,v.framebuffer),Xt(_,O,v),Zt(_,O,v.state),We(_,O,v,!1,!0);var N=v.shader.progVar.append(_,O);if(O(_.shared.gl,".useProgram(",N,".program);"),v.shader.program)ot(_,O,v,v.shader.program);else{O(_.shared.vao,".setVAO(null);");var I=_.global.def("{}"),M=O.def(N,".id"),C=O.def(I,"[",M,"]");O(_.cond(C).then(C,".call(this,a0);").else(C,"=",I,"[",M,"]=",_.link(function(G){return nt(ot,_,v,G,1)}),"(",N,");",C,".call(this,a0);"))}Object.keys(v.state).length>0&&O(_.shared.current,".dirty=true;"),_.shared.vao&&O(_.shared.vao,".setVAO(null);")}function Yn(_,v,O,N){_.batchId="a1",Ct(_,v);function I(){return!0}Qt(_,v,O,N.attributes,I),lt(_,v,O,N.uniforms,I,!1),Be(_,v,v,O)}function zr(_,v,O,N){Ct(_,v);var I=O.contextDep,M=v.def(),C="a0",G="a1",$=v.def();_.shared.props=$,_.batchId=M;var A=_.scope(),E=_.scope();v(A.entry,"for(",M,"=0;",M,"<",G,";++",M,"){",$,"=",C,"[",M,"];",E,"}",A.exit);function z(Ge){return Ge.contextDep&&I||Ge.propDep}function V(Ge){return!z(Ge)}if(O.needsContext&&Dt(_,E,O.context),O.needsFramebuffer&&Bt(_,E,O.framebuffer),Zt(_,E,O.state,z),O.profile&&z(O.profile)&&We(_,E,O,!1,!0),N)O.useVAO?O.drawVAO?z(O.drawVAO)?E(_.shared.vao,".setVAO(",O.drawVAO.append(_,E),");"):A(_.shared.vao,".setVAO(",O.drawVAO.append(_,A),");"):A(_.shared.vao,".setVAO(",_.shared.vao,".targetVAO);"):(A(_.shared.vao,".setVAO(null);"),Qt(_,A,O,N.attributes,V),Qt(_,E,O,N.attributes,z)),lt(_,A,O,N.uniforms,V,!1),lt(_,E,O,N.uniforms,z,!0),Be(_,A,E,O);else{var Q=_.global.def("{}"),te=O.shader.progVar.append(_,E),ge=E.def(te,".id"),ze=E.def(Q,"[",ge,"]");E(_.shared.gl,".useProgram(",te,".program);","if(!",ze,"){",ze,"=",Q,"[",ge,"]=",_.link(function(Ge){return nt(Yn,_,O,Ge,2)}),"(",te,");}",ze,".call(this,a0[",M,"],",M,");")}}function x(_,v){var O=_.proc("batch",2);_.batchId="0",Ct(_,O);var N=!1,I=!0;Object.keys(v.context).forEach(function(Q){N=N||v.context[Q].propDep}),N||(Dt(_,O,v.context),I=!1);var M=v.framebuffer,C=!1;M?(M.propDep?N=C=!0:M.contextDep&&N&&(C=!0),C||Bt(_,O,M)):Bt(_,O,null),v.state.viewport&&v.state.viewport.propDep&&(N=!0);function G(Q){return Q.contextDep&&N||Q.propDep}Xt(_,O,v),Zt(_,O,v.state,function(Q){return!G(Q)}),(!v.profile||!G(v.profile))&&We(_,O,v,!1,"a1"),v.contextDep=N,v.needsContext=I,v.needsFramebuffer=C;var $=v.shader.progVar;if($.contextDep&&N||$.propDep)zr(_,O,v,null);else{var A=$.append(_,O);if(O(_.shared.gl,".useProgram(",A,".program);"),v.shader.program)zr(_,O,v,v.shader.program);else{O(_.shared.vao,".setVAO(null);");var E=_.global.def("{}"),z=O.def(A,".id"),V=O.def(E,"[",z,"]");O(_.cond(V).then(V,".call(this,a0,a1);").else(V,"=",E,"[",z,"]=",_.link(function(Q){return nt(zr,_,v,Q,2)}),"(",A,");",V,".call(this,a0,a1);"))}}Object.keys(v.state).length>0&&O(_.shared.current,".dirty=true;"),_.shared.vao&&O(_.shared.vao,".setVAO(null);")}function j(_,v){var O=_.proc("scope",3);_.batchId="a2";var N=_.shared,I=N.current;Dt(_,O,v.context),v.framebuffer&&v.framebuffer.append(_,O),j1(Object.keys(v.state)).forEach(function(C){var G=v.state[C],$=G.append(_,O);At($)?$.forEach(function(A,E){O.set(_.next[C],"["+E+"]",A)}):O.set(N.next,"."+C,$)}),We(_,O,v,!0,!0),[Dr,qi,Ir,Xi,Br].forEach(function(C){var G=v.draw[C];G&&O.set(N.draw,"."+C,""+G.append(_,O))}),Object.keys(v.uniforms).forEach(function(C){var G=v.uniforms[C].append(_,O);Array.isArray(G)&&(G="["+G.join()+"]"),O.set(N.uniforms,"["+g.id(C)+"]",G)}),Object.keys(v.attributes).forEach(function(C){var G=v.attributes[C].append(_,O),$=_.scopeAttrib(C);Object.keys(new D).forEach(function(A){O.set($,"."+A,G[A])})}),v.scopeVAO&&O.set(N.vao,".targetVAO",v.scopeVAO.append(_,O));function M(C){var G=v.shader[C];G&&O.set(N.shader,"."+C,G.append(_,O))}M(go),M(yo),Object.keys(v.state).length>0&&(O(I,".dirty=true;"),O.exit(I,".dirty=true;")),O("a1(",_.shared.context,",a0,",_.batchId,");")}function U(_){if(!(typeof _!="object"||At(_))){for(var v=Object.keys(_),O=0;O<v.length;++O)if(ln.isDynamic(_[v[O]]))return!0;return!1}}function Ce(_,v,O){var N=v.static[O];if(!N||!U(N))return;var I=_.global,M=Object.keys(N),C=!1,G=!1,$=!1,A=_.global.def("{}");M.forEach(function(z){var V=N[z];if(ln.isDynamic(V)){typeof V=="function"&&(V=N[z]=ln.unbox(V));var Q=pn(V,null);C=C||Q.thisDep,$=$||Q.propDep,G=G||Q.contextDep}else{switch(I(A,".",z,"="),typeof V){case"number":I(V);break;case"string":I('"',V,'"');break;case"object":Array.isArray(V)&&I("[",V.join(),"]");break;default:I(_.link(V));break}I(";")}});function E(z,V){M.forEach(function(Q){var te=N[Q];if(ln.isDynamic(te)){var ge=z.invoke(V,te);V(A,".",Q,"=",ge,";")}})}v.dynamic[O]=new ln.DynamicVariable(zi,{thisDep:C,contextDep:G,propDep:$,ref:A,append:E}),delete v.static[O]}function Ke(_,v,O,N,I){var M=je();M.stats=M.link(I),Object.keys(v.static).forEach(function(G){Ce(M,v,G)}),U2.forEach(function(G){Ce(M,_,G)});var C=Ft(_,v,O,N,M);return Mt(M,C),j(M,C),x(M,C),r(M.compile(),{destroy:function(){C.shader.program.destroy()}})}return{next:Ee,current:Ae,procs:function(){var _=je(),v=_.proc("poll"),O=_.proc("refresh"),N=_.block();v(N),O(N);var I=_.shared,M=I.gl,C=I.next,G=I.current;N(G,".dirty=false;"),Bt(_,v),Bt(_,O,null,!0);var $;ue&&($=_.link(ue)),S.oes_vertex_array_object&&O(_.link(S.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var A=0;A<X.maxAttributes;++A){var E=O.def(I.attributes,"[",A,"]"),z=_.cond(E,".buffer");z.then(M,".enableVertexAttribArray(",A,");",M,".bindBuffer(",Es,",",E,".buffer.buffer);",M,".vertexAttribPointer(",A,",",E,".size,",E,".type,",E,".normalized,",E,".stride,",E,".offset);").else(M,".disableVertexAttribArray(",A,");",M,".vertexAttrib4f(",A,",",E,".x,",E,".y,",E,".z,",E,".w);",E,".buffer=null;"),O(z),ue&&O($,".vertexAttribDivisorANGLE(",A,",",E,".divisor);")}return O(_.shared.vao,".currentVAO=null;",_.shared.vao,".setVAO(",_.shared.vao,".targetVAO);"),Object.keys(ee).forEach(function(V){var Q=ee[V],te=N.def(C,".",V),ge=_.block();ge("if(",te,"){",M,".enable(",Q,")}else{",M,".disable(",Q,")}",G,".",V,"=",te,";"),O(ge),v("if(",te,"!==",G,".",V,"){",ge,"}")}),Object.keys(K).forEach(function(V){var Q=K[V],te=Ae[V],ge,ze,Ge=_.block();if(Ge(M,".",Q,"("),At(te)){var Pe=te.length;ge=_.global.def(C,".",V),ze=_.global.def(G,".",V),Ge(pe(Pe,function(ne){return ge+"["+ne+"]"}),");",pe(Pe,function(ne){return ze+"["+ne+"]="+ge+"["+ne+"];"}).join("")),v("if(",pe(Pe,function(ne){return ge+"["+ne+"]!=="+ze+"["+ne+"]"}).join("||"),"){",Ge,"}")}else ge=N.def(C,".",V),ze=N.def(G,".",V),Ge(ge,");",G,".",V,"=",ge,";"),v("if(",ge,"!==",ze,"){",Ge,"}");O(Ge)}),_.compile()}(),compile:Ke}}function cy(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var ly=34918,fy=34919,Y1=35007,uy=function(f,g){if(!g.ext_disjoint_timer_query)return null;var S=[];function X(){return S.pop()||g.ext_disjoint_timer_query.createQueryEXT()}function J(ue){S.push(ue)}var q=[];function Y(ue){var Se=X();g.ext_disjoint_timer_query.beginQueryEXT(Y1,Se),q.push(Se),ae(q.length-1,q.length,ue)}function ie(){g.ext_disjoint_timer_query.endQueryEXT(Y1)}function oe(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var he=[];function ve(){return he.pop()||new oe}function me(ue){he.push(ue)}var ye=[];function ae(ue,Se,re){var Ae=ve();Ae.startQueryIndex=ue,Ae.endQueryIndex=Se,Ae.sum=0,Ae.stats=re,ye.push(Ae)}var de=[],D=[];function H(){var ue,Se,re=q.length;if(re!==0){D.length=Math.max(D.length,re+1),de.length=Math.max(de.length,re+1),de[0]=0,D[0]=0;var Ae=0;for(ue=0,Se=0;Se<q.length;++Se){var Ee=q[Se];g.ext_disjoint_timer_query.getQueryObjectEXT(Ee,fy)?(Ae+=g.ext_disjoint_timer_query.getQueryObjectEXT(Ee,ly),J(Ee)):q[ue++]=Ee,de[Se+1]=Ae,D[Se+1]=ue}for(q.length=ue,ue=0,Se=0;Se<ye.length;++Se){var Ne=ye[Se],ee=Ne.startQueryIndex,K=Ne.endQueryIndex;Ne.sum+=de[K]-de[ee];var Me=D[ee],be=D[K];be===Me?(Ne.stats.gpuTime+=Ne.sum/1e6,me(Ne)):(Ne.startQueryIndex=Me,Ne.endQueryIndex=be,ye[ue++]=Ne)}ye.length=ue}}return{beginQuery:Y,endQuery:ie,pushScopeStats:ae,update:H,getNumPendingQueries:function(){return q.length},clear:function(){S.push.apply(S,q);for(var ue=0;ue<S.length;ue++)g.ext_disjoint_timer_query.deleteQueryEXT(S[ue]);q.length=0,S.length=0},restore:function(){q.length=0,S.length=0}}},dy=16384,hy=256,my=1024,vy=34962,W1="webglcontextlost",Z1="webglcontextrestored",Q1=1,py=2,gy=3;function K1(f,g){for(var S=0;S<f.length;++S)if(f[S]===g)return S;return-1}function yy(f){var g=uc(f);if(!g)return null;var S=g.gl,X=S.getContextAttributes(),J=S.isContextLost(),q=gi(S,g);if(!q)return null;var Y=hi(),ie=cy(),oe=q.extensions,he=uy(S,oe),ve=di(),me=S.drawingBufferWidth,ye=S.drawingBufferHeight,ae={tick:0,time:0,viewportWidth:me,viewportHeight:ye,framebufferWidth:me,framebufferHeight:ye,drawingBufferWidth:me,drawingBufferHeight:ye,pixelRatio:g.pixelRatio},de={},D={elements:null,primitive:4,count:-1,offset:0,instances:-1},H=sg(S,oe),ue=_g(S,ie,g,Ae),Se=Lg(S,oe,ue,ie),re=L2(S,oe,H,ie,ue,Se,D);function Ae(Be){return re.destroyBuffer(Be)}var Ee=G2(S,Y,ie,g),Ne=l2(S,oe,H,function(){Me.procs.poll()},ae,ie,g),ee=f2(S,oe,H,ie,g),K=C2(S,oe,H,Ne,ee,ie),Me=ay(S,Y,oe,H,ue,Se,Ne,K,de,re,Ee,D,ae,he,g),be=B2(S,K,Me.procs.poll,ae,X,oe,H),le=Me.next,_e=S.canvas,$e=[],He=[],je=[],xe=[g.onDestroy],Te=null;function Ie(){if($e.length===0){he&&he.update(),Te=null;return}Te=cs.next(Ie),Zt();for(var Be=$e.length-1;Be>=0;--Be){var nt=$e[Be];nt&&nt(ae,null,0)}S.flush(),he&&he.update()}function Ye(){!Te&&$e.length>0&&(Te=cs.next(Ie))}function tt(){Te&&(cs.cancel(Ie),Te=null)}function Tt(Be){Be.preventDefault(),J=!0,tt(),He.forEach(function(nt){nt()})}function Pt(Be){S.getError(),J=!1,q.restore(),Ee.restore(),ue.restore(),Ne.restore(),ee.restore(),K.restore(),re.restore(),he&&he.restore(),Me.procs.refresh(),Ye(),je.forEach(function(nt){nt()})}_e&&(_e.addEventListener(W1,Tt,!1),_e.addEventListener(Z1,Pt,!1));function rt(){$e.length=0,tt(),_e&&(_e.removeEventListener(W1,Tt),_e.removeEventListener(Z1,Pt)),Ee.clear(),K.clear(),ee.clear(),re.clear(),Ne.clear(),Se.clear(),ue.clear(),he&&he.clear(),xe.forEach(function(Be){Be()})}function Nt(Be){b(!!Be,"invalid args to regl({...})"),b.type(Be,"object","invalid args to regl({...})");function nt(I){var M=r({},I);delete M.uniforms,delete M.attributes,delete M.context,delete M.vao,"stencil"in M&&M.stencil.op&&(M.stencil.opBack=M.stencil.opFront=M.stencil.op,delete M.stencil.op);function C(G){if(G in M){var $=M[G];delete M[G],Object.keys($).forEach(function(A){M[G+"."+A]=$[A]})}}return C("blend"),C("depth"),C("cull"),C("stencil"),C("polygonOffset"),C("scissor"),C("sample"),"vao"in I&&(M.vao=I.vao),M}function ot(I,M){var C={},G={};return Object.keys(I).forEach(function($){var A=I[$];if(ln.isDynamic(A)){G[$]=ln.unbox(A,$);return}else if(M&&Array.isArray(A)){for(var E=0;E<A.length;++E)if(ln.isDynamic(A[E])){G[$]=ln.unbox(A,$);return}}C[$]=A}),{dynamic:G,static:C}}var Mt=ot(Be.context||{},!0),Yn=ot(Be.uniforms||{},!0),zr=ot(Be.attributes||{},!1),x=ot(nt(Be),!1),j={gpuTime:0,cpuTime:0,count:0},U=Me.compile(x,zr,Yn,Mt,j),Ce=U.draw,Ke=U.batch,_=U.scope,v=[];function O(I){for(;v.length<I;)v.push(null);return v}function N(I,M){var C;if(J&&b.raise("context lost"),typeof I=="function")return _.call(this,null,I,0);if(typeof M=="function")if(typeof I=="number")for(C=0;C<I;++C)_.call(this,null,M,C);else if(Array.isArray(I))for(C=0;C<I.length;++C)_.call(this,I[C],M,C);else return _.call(this,I,M,0);else if(typeof I=="number"){if(I>0)return Ke.call(this,O(I|0),I|0)}else if(Array.isArray(I)){if(I.length)return Ke.call(this,I,I.length)}else return Ce.call(this,I)}return r(N,{stats:j,destroy:function(){U.destroy()}})}var yt=K.setFBO=Nt({framebuffer:ln.define.call(null,Q1,"framebuffer")});function Ft(Be,nt){var ot=0;Me.procs.poll();var Mt=nt.color;Mt&&(S.clearColor(+Mt[0]||0,+Mt[1]||0,+Mt[2]||0,+Mt[3]||0),ot|=dy),"depth"in nt&&(S.clearDepth(+nt.depth),ot|=hy),"stencil"in nt&&(S.clearStencil(nt.stencil|0),ot|=my),b(!!ot,"called regl.clear with no buffer specified"),S.clear(ot)}function Dt(Be){if(b(typeof Be=="object"&&Be,"regl.clear() takes an object as input"),"framebuffer"in Be)if(Be.framebuffer&&Be.framebuffer_reglType==="framebufferCube")for(var nt=0;nt<6;++nt)yt(r({framebuffer:Be.framebuffer.faces[nt]},Be),Ft);else yt(Be,Ft);else Ft(null,Be)}function Bt(Be){b.type(Be,"function","regl.frame() callback must be a function"),$e.push(Be);function nt(){var ot=K1($e,Be);b(ot>=0,"cannot cancel a frame twice");function Mt(){var Yn=K1($e,Mt);$e[Yn]=$e[$e.length-1],$e.length-=1,$e.length<=0&&tt()}$e[ot]=Mt}return Ye(),{cancel:nt}}function Xt(){var Be=le.viewport,nt=le.scissor_box;Be[0]=Be[1]=nt[0]=nt[1]=0,ae.viewportWidth=ae.framebufferWidth=ae.drawingBufferWidth=Be[2]=nt[2]=S.drawingBufferWidth,ae.viewportHeight=ae.framebufferHeight=ae.drawingBufferHeight=Be[3]=nt[3]=S.drawingBufferHeight}function Zt(){ae.tick+=1,ae.time=We(),Xt(),Me.procs.poll()}function Ct(){Ne.refresh(),Xt(),Me.procs.refresh(),he&&he.update()}function We(){return(di()-ve)/1e3}Ct();function Qt(Be,nt){b.type(nt,"function","listener callback must be a function");var ot;switch(Be){case"frame":return Bt(nt);case"lost":ot=He;break;case"restore":ot=je;break;case"destroy":ot=xe;break;default:b.raise("invalid event, must be one of frame,lost,restore,destroy")}return ot.push(nt),{cancel:function(){for(var Mt=0;Mt<ot.length;++Mt)if(ot[Mt]===nt){ot[Mt]=ot[ot.length-1],ot.pop();return}}}}var lt=r(Nt,{clear:Dt,prop:ln.define.bind(null,Q1),context:ln.define.bind(null,py),this:ln.define.bind(null,gy),draw:Nt({}),buffer:function(Be){return ue.create(Be,vy,!1,!1)},elements:function(Be){return Se.create(Be,!1)},texture:Ne.create2D,cube:Ne.createCube,renderbuffer:ee.create,framebuffer:K.create,framebufferCube:K.createCube,vao:re.createVAO,attributes:X,frame:Bt,on:Qt,limits:H,hasExtension:function(Be){return H.extensions.indexOf(Be.toLowerCase())>=0},read:be,destroy:rt,_gl:S,_refresh:Ct,poll:function(){Zt(),he&&he.update()},now:We,stats:ie});return g.onDone(null,lt),lt}return yy})}(hl)),hl.exports}const Y5=j5,W5=Ba,Z5=e=>{const n=Object.assign({},{},e.glOptions,{onDone:(i,a)=>{if(i)throw i}}),r=H5()(n),s=new Map,o=i=>{i.rendering=Object.assign({},W5,i.rendering),Y5(r)(i,a=>{r.clear({color:i.rendering.background,depth:1}),i.entities&&i.entities.sort((c,l)=>{const u="transparent"in c.visuals?c.visuals.transparent:!1,d="transparent"in l.visuals?l.visuals.transparent:!1;return u===d?0:u?1:-1}).forEach(c=>{const{visuals:l}=c;if(("show"in l?l.show:!0)&&l.drawCmd&&i.drawCommands[l.drawCmd]){let d;l.cacheId?d=s.get(l.cacheId):(l.cacheId=s.size,d=i.drawCommands[l.drawCmd](r,c),s.set(l.cacheId,d));const h={...c,...l,camera:i.camera};d(h)}})})};return function(a){r.poll(),o(a)}};var Q5=Z5,ml,sd;function od(){if(sd)return ml;sd=1;const e=Mn;return ml=(n,r={})=>{const s=[],o={visuals:{color:[0,0,1,1],fadeOut:!1},ticks:1,size:[16,16],centered:!1,lineWidth:2},i=Object.assign({},o.visuals,r.visuals||{}),{fadeOut:a,color:c}=i,{size:l,ticks:u,centered:d,lineWidth:h}=Object.assign({},o,r),m=l[0],w=l[1];if(d){const p=m*.5,y=w*.5,P=p%u,F=-p+P,L=-F,k=y%u,T=-y+k,R=-T,B=0;for(let W=F,se=0;W<=L;W+=u,se+=1)se%B!==0&&(s.push(T,W,0),s.push(R,W,0),s.push(T,W,0));for(let W=T,se=0;W<=R;W+=u,se+=1)se%B!==0&&(s.push(W,F,0),s.push(W,L,0),s.push(W,F,0))}else{for(let p=-m*.5;p<=m*.5;p+=u)s.push(-w*.5,p,0),s.push(w*.5,p,0),s.push(-w*.5,p,0);for(let p=-w*.5;p<=w*.5;p+=u)s.push(p,-m*.5,0),s.push(p,m*.5,0),s.push(p,-m*.5,0)}return n({vert:`precision mediump float;

    uniform float camNear, camFar;
    uniform mat4 model, view, projection;

    attribute vec3 position;
    varying vec3 fragNormal, fragPosition;
    varying vec4 worldPosition;

    void main() {
      fragPosition = position;
      worldPosition = model * vec4(position, 1);
      vec4 glPosition = projection * view * worldPosition;
      gl_Position = glPosition;
    }`,frag:`precision mediump float;
    uniform vec4 color;
    varying vec3 fragNormal, fragPosition;
    varying vec4 worldPosition;

    uniform vec4 fogColor;
    uniform bool fadeOut;
    void main() {
      float dist = .5;
      if(fadeOut){
        dist = distance( vec2(0.,0.), vec2(worldPosition.x, worldPosition.y));
        dist *= 0.0025;
        dist = sqrt(dist);
      }

      gl_FragColor = mix(color, fogColor, dist);
    }
    `,attributes:{position:n.buffer(s)},count:s.length/3,uniforms:{model:(p,y)=>y&&y.model?y.model:e.identity([]),color:(p,y)=>y&&y.color?y.color:c,fogColor:(p,y)=>y&&y.color?[y.color[0],y.color[1],y.color[2],0]:[c[0],c[1],c[2],0],fadeOut:(p,y)=>y&&y.fadeOut!==void 0?y.fadeOut:a},lineWidth:(p,y)=>Math.min(y&&y.lineWidth?y.lineWidth:h,n.limits.lineWidthDims[1]),primitive:"lines",cull:{enable:!0,face:"front"},polygonOffset:{enable:!0,offset:{factor:1,units:Math.random()*10}},blend:{enable:!0,func:{src:"src alpha",dst:"one minus src alpha"}}})},ml}const K5=(e,t)=>{const n={size:[50,50],ticks:[10,1]},{size:r,ticks:s}=Object.assign({},n,t),o=od()(e,{size:r,ticks:s[0]}),i=od()(e,{size:r,ticks:s[1]});return c=>{o(c),i({color:c.subColor,fadeOut:c.fadeOut})}};var J5=K5;const fn=Mn,eb=(e,t)=>{const n={xColor:[1,0,0,1],yColor:[0,1,0,1],zColor:[0,0,1,1],size:10,lineWidth:3,alwaysVisible:!0};let{size:r,xColor:s,yColor:o,zColor:i,lineWidth:a,alwaysVisible:c}=Object.assign({},n,t);a>e.limits.lineWidthDims[1]&&(a=e.limits.lineWidthDims[1]);const l=[0,0,0,r,0,0],u={frag:`precision mediump float;
    uniform vec4 color;
    void main() {
      gl_FragColor = color;
    }`,vert:`
    precision mediump float;
    attribute vec3 position;
    uniform mat4 model, view, projection;
    void main() {
      gl_Position = projection * view * model * vec4(position, 1);
    }`,uniforms:{model:(p,y)=>y&&y.model?y.model:fn.identity([]),color:(p,y)=>y.color,angle:(p,y)=>y.angle},attributes:{position:l},count:l.length/3,primitive:"line loop",lineWidth:a,depth:{enable:!c}},d=fn.identity([]),h=fn.rotateZ(fn.create(),fn.identity([]),Math.PI/2),m=fn.rotateY(fn.create(),fn.identity([]),-Math.PI/2),w=e(u);return p=>{const y={model:fn.identity([])};return p=Object.assign({},y,p),w([{color:s,model:fn.multiply(fn.create(),p.model,d)},{color:o,model:fn.multiply(fn.create(),p.model,h)},{color:i,model:fn.multiply(fn.create(),p.model,m)}])}};var tb=eb,vl,id;function ad(){return id||(id=1,vl={frag:`
precision mediump float;
varying vec3 surfaceNormal, surfacePosition;

uniform float ambientLightAmount;
uniform float diffuseLightAmount;
uniform float specularLightAmount;

uniform vec3 lightDirection;
uniform vec4 lightColor;
uniform vec3 opacity;
uniform float uMaterialShininess;

varying vec4 vColor;
uniform vec4 ucolor;
uniform float vColorToggler;

uniform vec2 printableArea;
vec4 errorColor = vec4(0.15, 0.15, 0.15, 0.3);//vec4(0.15, 0.15, 0.15, 0.3);
varying vec4 _worldSpacePosition;
varying float ambientAo;

void main () {
  vec4 depth = gl_FragCoord;
  vec4 endColor = vColor * vColorToggler + ucolor * (1.0 - vColorToggler);

  vec3 ambient = ambientLightAmount * endColor.rgb ; //ambientAo * 

  float diffuseWeight = dot(surfaceNormal, lightDirection);
  vec3 diffuse = diffuseLightAmount * endColor.rgb * clamp(diffuseWeight , 0.0, 1.0 );

  //specular
  
  vec4 specularColor = vec4(lightColor);
  vec3 eyeDirection = normalize(surfacePosition.xyz);
  vec3 reflectionDirection = reflect(-lightDirection, -surfaceNormal);
  float specularLightWeight = pow(max(dot(reflectionDirection, eyeDirection), 0.0), uMaterialShininess);
  vec3 specular = specularColor.rgb * specularLightWeight * specularLightAmount;

  gl_FragColor = vec4((ambient + diffuse + specular), endColor.a);
}
`,vert:`
precision mediump float;

uniform float camNear, camFar;
uniform mat4 model, view, projection, unormal;

attribute vec3 position, normal;
attribute vec4 color;

attribute float ao;
varying float ambientAo;

varying vec3 surfaceNormal, surfacePosition;
varying vec4 _worldSpacePosition;
varying vec4 vColor;

void main() {
  surfacePosition = (unormal * vec4(position, 1.0)).xyz;
  surfaceNormal = normalize((unormal * vec4(normal, 1.0)).xyz); //vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);
  vec4 worldSpacePosition = model * vec4(position, 1);
  _worldSpacePosition = worldSpacePosition;
  //gl_Position = projection * view * worldSpacePosition;

  vColor = color;

  //ambientAo = (1. - ao) * (0.5 * max(normal.x, 0.) + 0.5);

  vec4 glPosition = projection * view * model * vec4(position, 1);
  gl_Position = glPosition;
  //gl_Position = zBufferAdjust(glPosition, camNear, camFar);
}
`}),vl}var pl,cd;function ld(){return cd||(cd=1,pl={vert:`
precision mediump float;

uniform float camNear, camFar;
uniform mat4 model, view, projection;

attribute vec3 position, normal;

varying vec3 surfaceNormal, surfacePosition;
varying vec4 _worldSpacePosition;

void main() {
  surfacePosition = position;
  surfaceNormal = normal;
  vec4 worldSpacePosition = model * vec4(position, 1);
  _worldSpacePosition = worldSpacePosition;

  vec4 glPosition = projection * view * model * vec4(position, 1);
  gl_Position = glPosition;
}
`,frag:`
precision mediump float;
varying vec3 surfaceNormal;
uniform float ambientLightAmount;
uniform float diffuseLightAmount;
uniform vec4 ucolor;
uniform vec3 lightDirection;
uniform vec3 opacity;

varying vec4 _worldSpacePosition;

uniform vec2 printableArea;

vec4 errorColor = vec4(0.15, 0.15, 0.15, 0.3);

void main () {
  vec4 depth = gl_FragCoord;

  float v = 0.8; // shadow value
  vec4 endColor = ucolor;

  vec3 ambient = ambientLightAmount * endColor.rgb;
  float cosTheta = dot(surfaceNormal, lightDirection);
  vec3 diffuse = diffuseLightAmount * endColor.rgb * clamp(cosTheta , 0.0, 1.0 );

  float cosTheta2 = dot(surfaceNormal, vec3(-lightDirection.x, -lightDirection.y, lightDirection.z));
  vec3 diffuse2 = diffuseLightAmount * endColor.rgb * clamp(cosTheta2 , 0.0, 1.0 );

  gl_FragColor = vec4((ambient + diffuse + diffuse2 * v), endColor.a);
}`}),pl}const br=Mn,{meshColor:nb}=Ba,rb=(e,t={extras:{}})=>{const n={useVertexColors:!0,dynamicCulling:!0,geometry:void 0,color:nb,visuals:{}},{geometry:r,dynamicCulling:s,useVertexColors:o,color:i,visuals:a}=Object.assign({},n,t),c=e.buffer([]),l=!!(r.indices&&r.indices.length>0),u=!!(r.normals&&r.normals.length>0),d="transparent"in a?a.transparent:!1,h=!!(o&&r.colors&&r.colors.length>0),m=r.transforms||br.create(),w=br.determinant(m)<0,p=s&&w?"front":"back",y=h?ad().vert:ld().vert,P=h?ad().frag:ld().frag,F=br.invert(br.create(),m);let L={primitive:"triangles",vert:y,frag:P,uniforms:{model:(k,T)=>m,ucolor:(k,T)=>T&&T.color?T.color:i,vColorToggler:(k,T)=>T&&T.useVertexColors&&T.useVertexColors===!0?1:0,unormal:(k,T)=>{const R=br.invert(br.create(),T.camera.view);return br.multiply(R,F,R),br.transpose(R,R),R}},attributes:{position:e.buffer({usage:"static",type:"float",data:r.positions}),ao:c},cull:{enable:!0,face:p}};return d&&(L.blend={enable:!0,func:{src:"src alpha",dst:"one minus src alpha"}}),r.cells?L.elements=r.cells:l?L.elements=e.elements({usage:"static",type:"uint16",data:r.indices}):r.triangles?L.elements=r.triangles:L.count=r.positions.length/3,u&&(L.attributes.normal=e.buffer({usage:"static",type:"float",data:r.normals})),h&&(L.attributes.color=e.buffer({usage:"static",type:"float",data:r.colors})),L=Object.assign({},L,t.extras),e(L)};var sb=rb,gl,fd;function ud(){return fd||(fd=1,gl={frag:`
precision mediump float;
varying vec4 vColor;

void main () {
  gl_FragColor = vColor;
}
`,vert:`
precision mediump float;

uniform float camNear, camFar;
uniform mat4 model, view, projection;

attribute vec3 position, normal;
attribute vec4 color;

varying vec3 surfaceNormal, surfacePosition;
varying vec4 _worldSpacePosition;
varying vec4 vColor;

void main() {
  vColor = color;

  surfacePosition = position;
  surfaceNormal = normal;
  vec4 worldSpacePosition = model * vec4(position, 1);
  _worldSpacePosition = worldSpacePosition;

  vec4 glPosition = projection * view * model * vec4(position, 1);
  gl_Position = glPosition;
}
`}),gl}var yl,dd;function ob(){return dd||(dd=1,yl={vert:`
precision mediump float;

uniform float camNear, camFar;
uniform mat4 model, view, projection;

attribute vec3 position, normal;


varying vec3 surfaceNormal, surfacePosition;
varying vec4 _worldSpacePosition;


void main() {


  surfacePosition = position;
  surfaceNormal = normal;
  vec4 worldSpacePosition = model * vec4(position, 1);
  _worldSpacePosition = worldSpacePosition;

  vec4 glPosition = projection * view * model * vec4(position, 1);
  gl_Position = glPosition;
}
`,frag:`
precision mediump float;
varying vec3 surfaceNormal;
uniform float ambientLightAmount;
uniform float diffuseLightAmount;
uniform vec4 ucolor;
uniform vec3 lightDirection;
uniform vec3 opacity;

varying vec4 _worldSpacePosition;

uniform vec2 printableArea;

vec4 errorColor = vec4(0.15, 0.15, 0.15, 0.3);

void main () {
  vec4 depth = gl_FragCoord;

  float v = 0.8; // shadow value
  vec4 endColor = ucolor;

  vec3 ambient = ambientLightAmount * endColor.rgb;
  float cosTheta = dot(surfaceNormal, lightDirection);
  vec3 diffuse = diffuseLightAmount * endColor.rgb * clamp(cosTheta , 0.0, 1.0 );

  float cosTheta2 = dot(surfaceNormal, vec3(-lightDirection.x, -lightDirection.y, lightDirection.z));
  vec3 diffuse2 = diffuseLightAmount * endColor.rgb * clamp(cosTheta2 , 0.0, 1.0 );

  gl_FragColor = vec4((ambient + diffuse + diffuse2 * v), endColor.a);
}`}),yl}var bl,hd;function ib(){return hd||(hd=1,bl={frag:`
precision mediump float;
uniform vec4 ucolor;

void main () {
  gl_FragColor = ucolor;
}
`}),bl}const ab=Mn,{meshColor:cb}=Ba,lb=(e,t={})=>{const n={color:cb,geometry:void 0};let{geometry:r,color:s,transparent:o}=Object.assign({},n,t);"color"in r&&(s=r.color);const i=!!(r.indices&&r.indices.length>0),a=!!(r.normals&&r.normals.length>0),c=!!(r.colors&&r.colors.length>0),l=c?ud().vert:ob().vert,u=c?ud().frag:ib().frag,d={primitive:"lines",vert:l,frag:u,uniforms:{model:(h,m)=>m.model||r.transforms||ab.create(),ucolor:(h,m)=>m&&m.color?m.color:s},attributes:{position:e.buffer({usage:"static",type:"float",data:r.positions})}};return o&&(d.blend={enable:!0,func:{src:"src alpha",dst:"one minus src alpha"}}),c&&(d.attributes.color=e.buffer({usage:"static",type:"float",data:r.colors})),i&&(d.elements=e.elements({usage:"static",type:"uint16",data:r.indices})),a&&(d.attributes.normal=e.buffer({usage:"static",type:"float",data:r.normals})),e(d)};var fb=lb,hm=1e-6,mm=ub;function ub(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}var db=hb;function hb(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}var vm=mb;function mb(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}var pm=vb;function vb(e,t){var n=t[0],r=t[1],s=t[2],o=n*n+r*r+s*s;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}var gm=pb;function pb(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}var gb=bb,md=vm,vd=pm,yb=gm;function bb(e,t){var n=md(e[0],e[1],e[2]),r=md(t[0],t[1],t[2]);vd(n,n),vd(r,r);var s=yb(n,r);return s>1?0:Math.acos(s)}var _b=wb;function wb(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}var $b=Eb;function Eb(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}var xb=Ab,_l=hm;function Ab(e,t){var n=e[0],r=e[1],s=e[2],o=t[0],i=t[1],a=t[2];return Math.abs(n-o)<=_l*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=_l*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(s-a)<=_l*Math.max(1,Math.abs(s),Math.abs(a))}var Tb=Sb;function Sb(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}var Pb=Ob;function Ob(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}var ym=Cb;function Cb(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}var Mb=ym,bm=Lb;function Lb(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}var kb=bm,_m=Rb;function Rb(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}var Fb=_m,Gb=Nb;function Nb(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}var Db=Bb;function Bb(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}var Ib=Vb;function Vb(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}var zb=Ub;function Ub(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}var qb=Xb;function Xb(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}var jb=Hb;function Hb(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}var Yb=Wb;function Wb(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}var wm=Zb;function Zb(e,t){var n=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(n*n+r*r+s*s)}var Qb=wm,$m=Kb;function Kb(e,t){var n=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return n*n+r*r+s*s}var Jb=$m,Em=e_;function e_(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}var t_=Em,xm=n_;function n_(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}var r_=xm,s_=o_;function o_(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}var i_=a_;function a_(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}var c_=l_;function l_(e,t,n){var r=t[0],s=t[1],o=t[2],i=n[0],a=n[1],c=n[2];return e[0]=s*c-o*a,e[1]=o*i-r*c,e[2]=r*a-s*i,e}var f_=u_;function u_(e,t,n,r){var s=t[0],o=t[1],i=t[2];return e[0]=s+r*(n[0]-s),e[1]=o+r*(n[1]-o),e[2]=i+r*(n[2]-i),e}var d_=h_;function h_(e,t){t=t||1;var n=Math.random()*2*Math.PI,r=Math.random()*2-1,s=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*s,e[1]=Math.sin(n)*s,e[2]=r*t,e}var m_=v_;function v_(e,t,n){var r=t[0],s=t[1],o=t[2],i=n[3]*r+n[7]*s+n[11]*o+n[15];return i=i||1,e[0]=(n[0]*r+n[4]*s+n[8]*o+n[12])/i,e[1]=(n[1]*r+n[5]*s+n[9]*o+n[13])/i,e[2]=(n[2]*r+n[6]*s+n[10]*o+n[14])/i,e}var p_=g_;function g_(e,t,n){var r=t[0],s=t[1],o=t[2];return e[0]=r*n[0]+s*n[3]+o*n[6],e[1]=r*n[1]+s*n[4]+o*n[7],e[2]=r*n[2]+s*n[5]+o*n[8],e}var y_=b_;function b_(e,t,n){var r=t[0],s=t[1],o=t[2],i=n[0],a=n[1],c=n[2],l=n[3],u=l*r+a*o-c*s,d=l*s+c*r-i*o,h=l*o+i*s-a*r,m=-i*r-a*s-c*o;return e[0]=u*l+m*-i+d*-c-h*-a,e[1]=d*l+m*-a+h*-i-u*-c,e[2]=h*l+m*-c+u*-a-d*-i,e}var __=w_;function w_(e,t,n,r){var s=n[1],o=n[2],i=t[1]-s,a=t[2]-o,c=Math.sin(r),l=Math.cos(r);return e[0]=t[0],e[1]=s+i*l-a*c,e[2]=o+i*c+a*l,e}var $_=E_;function E_(e,t,n,r){var s=n[0],o=n[2],i=t[0]-s,a=t[2]-o,c=Math.sin(r),l=Math.cos(r);return e[0]=s+a*c+i*l,e[1]=t[1],e[2]=o+a*l-i*c,e}var x_=A_;function A_(e,t,n,r){var s=n[0],o=n[1],i=t[0]-s,a=t[1]-o,c=Math.sin(r),l=Math.cos(r);return e[0]=s+i*l-a*c,e[1]=o+i*c+a*l,e[2]=t[2],e}var T_=S_,_r=mm();function S_(e,t,n,r,s,o){var i,a;for(t||(t=3),n||(n=0),r?a=Math.min(r*t+n,e.length):a=e.length,i=n;i<a;i+=t)_r[0]=e[i],_r[1]=e[i+1],_r[2]=e[i+2],s(_r,_r,o),e[i]=_r[0],e[i+1]=_r[1],e[i+2]=_r[2];return e}var Ko={EPSILON:hm,create:mm,clone:db,angle:gb,fromValues:vm,copy:_b,set:$b,equals:xb,exactEquals:Tb,add:Pb,subtract:ym,sub:Mb,multiply:bm,mul:kb,divide:_m,div:Fb,min:Gb,max:Db,floor:Ib,ceil:zb,round:qb,scale:jb,scaleAndAdd:Yb,distance:wm,dist:Qb,squaredDistance:$m,sqrDist:Jb,length:Em,len:t_,squaredLength:xm,sqrLen:r_,negate:s_,inverse:i_,normalize:pm,dot:gm,cross:c_,lerp:f_,random:d_,transformMat4:m_,transformMat3:p_,transformQuat:y_,rotateX:__,rotateY:$_,rotateZ:x_,forEach:T_};const ns=Mn,wl=Ko,Am={view:ns.identity(new Float32Array(16)),projection:ns.identity(new Float32Array(16)),matrix:ns.identity(new Float32Array(16)),near:1,far:18e3,up:[0,0,1],eye:new Float32Array(3),position:[450,550,700],target:[0,0,0],fov:Math.PI/4,aspect:1,viewport:[0,0,0,0],projectionType:"perspective"},Tm={},P_=Object.assign({},Am,Tm),O_=(e,t,n)=>{const r=n.width/n.height,s=ns.perspective(ns.identity([]),t.fov,r,t.near,t.far),o=[0,0,n.width,n.height],i=e||{};return i.projection=s,i.aspect=r,i.viewport=o,i},C_=(e,t)=>{t||(t=e);const{position:n,target:r,up:s}=t,o=wl.subtract([],n,r),i=wl.add(wl.create(),r,o),a=ns.lookAt(ns.create(),i,r,s),c=e||{};return c.position=i,c.view=a,c};var xf={cameraState:Am,cameraProps:Tm,defaults:P_,setProjection:O_,update:C_};const Sa=Mn,M_={view:Sa.identity(new Float32Array(16)),projection:Sa.identity(new Float32Array(16)),matrix:Sa.identity(new Float32Array(16)),near:1,far:1300,up:[0,0,1],eye:new Float32Array(3),position:[150,250,200],target:[0,0,0],fov:Math.PI/4,aspect:1,viewport:[0,0,0,0],zoom:1,projectionType:"orthographic"},L_={},k_=(e,t)=>{const{width:n,height:r}=t,s=n/r,o=[0,0,n,r],i=e.zoom,a=-n*i,c=n*i,l=-r*i,u=r*i;return{projection:Sa.ortho([],a,c,l,u,e.near,e.far),aspect:s,viewport:o}};var Ma={cameraState:M_,cameraProps:L_,setProjection:k_};const Is=Ko,La=Mn,R_=e=>{const{near:t,far:n,fov:r,zoom:s}=e,{viewport:o}=e,i=xf.setProjection(e,{width:o[2],height:o[3]}),{projectionType:a}=xf.cameraState;return Object.assign({},e,i,{projectionType:a},{near:t,far:n,fov:r})},F_=e=>{const{fov:t,aspect:n}=e,r=Is.length(Is.subtract([],e.position,e.target))*.3,s=Math.tan(t)*r*n,o=Math.tan(t)*r,{near:i,far:a,viewport:c}=e,l={zoom:1,near:i,far:a},u=Ma.cameraState,d=Ma.setProjection(l,{width:s,height:o});return Object.assign({},u,e,d,{projectionType:u.projectionType,viewport:c})},G_=({camera:e})=>{const n=Is.distance(e.position,e.target),r=[n,n,n];return{view:La.lookAt(La.create(),r,e.target,e.up),position:r}},N_=(e,{camera:t})=>{const n={top:[0,-1e-6,1],bottom:[0,0,-1],front:[0,1,0],back:[0,-1,0],left:[-1,0,0],right:[1,0,0],undefined:[0,0,0]},r=Is.distance(t.position,t.target),s=Is.add(Is.create(),n[e].map(i=>i*r),t.target);return{view:La.lookAt(La.create(),s,t.target,t.up),position:s}};var D_={toPerspectiveView:G_,toPresetView:N_,fromOrthographicToPerspective:R_,fromPerspectiveToOrthographic:F_};const Sm=e=>e.reduce((t,n)=>Array.isArray(n)?t.concat(Sm(n)):t.concat(n),[]);var B_=Sm;const I_=(e,t)=>e-t;var V_=I_;const z_=e=>{if(!(!Array.isArray(e)||e.length===0))return e[0]};var U_=z_;const q_=(e,t,n)=>{let r=0,s=e.length;for(;s>r;){const o=Math.floor((r+s)/2),i=e[o];n(t,i)>0?r=o+1:s=o}return e.splice(r,0,t),e};var X_=q_;const j_=(e,t)=>{if(!(!Array.isArray(e)||e.length<t))return e[t]};var H_=j_;const Y_=(e,t,n)=>{for(e=e.slice();e.length<n;)e.push(t);return e};var W_=Y_;const Z_=e=>Array.isArray(e)?e:e==null?[]:[e];var Q_=Z_,Gf={flatten:B_,fnNumberSort:V_,head:U_,insertSorted:X_,nth:H_,padToLength:W_,toArray:Q_};const K_=e=>{if(e.length===0)return[[0,0,0],[0,0,0]];const t=Array.isArray(e)&&Array.isArray(e[0]),n=t?e[0].length:3,r=new Array(n),s=new Array(n);for(let o=0;o<n;o+=1)r[o]=1/0,s[o]=-1/0;if(t)e.forEach(o=>{for(let i=0;i<n;i+=1){const a=t?o[i]:o;s[i]=a>s[i]?a:s[i],r[i]=a<r[i]?a:r[i]}});else for(let o=0;o<e.length;o+=n)for(let i=0;i<n;i+=1){const a=e[i+o];s[i]=a>s[i]?a:s[i],r[i]=a<r[i]?a:r[i]}return[r,s]};var J_=K_;const An=Ko,{flatten:ew}=Gf,tw=J_,nw=(...e)=>{e=ew(e);let t;e.forEach(c=>{let l=tw(c.positions);l=l.map(u=>An.transformMat4(u,u,c.transforms)),t?(An.min(t[0],t[0],l[0]),An.max(t[1],t[1],l[1])):t=l});const n=An.min(An.create(),t[1],t[0]),r=An.max(An.create(),t[1],t[0]),s=An.subtract(An.create(),r,n);let o=An.scale(An.create(),s,.5);return o=An.add(o,n,o),{dia:An.distance(o,r),center:[...o],min:[...n],max:[...r],size:[...s]}};var rw=nw,$l,pd;function sw(){if(pd)return $l;pd=1,$l=e;function e(t,n,r){var s=n[0],o=n[1],i=n[2],a=r[0],c=r[1],l=r[2],u=r[3],d=r[4],h=r[5],m=r[6],w=r[7],p=r[8],y=r[9],P=r[10],F=r[11],L=r[12],k=r[13],T=r[14],R=r[15],B=1/(s*u+o*w+i*F+R);return t[0]=(s*a+o*d+i*p+L)*B,t[1]=(s*c+o*h+i*y+k)*B,t[2]=(s*l+o*m+i*P+T)*B,t}return $l}var El,gd;function ow(){if(gd)return El;gd=1;var e=sw();El=t;function t(n,r,s,o){var i=s[0],a=s[1],c=s[2],l=s[3],u=r[0],d=r[1],h=r[2];return u=u-i,d=l-d-1,d=d-a,n[0]=2*u/c-1,n[1]=2*d/l-1,n[2]=2*h-1,e(n,n,o)}return El}const mn=Ko,Yo=Mn,{max:xl,min:Al,sqrt:yd,PI:iw,sin:Ts,cos:sa,atan2:oa}=Math,aw=rw,Nf={limits:{minDistance:.01,maxDistance:1e4},drag:.27,EPS:1e-6,zoomToFit:{auto:!0,targets:"all",tightness:1.5},userControl:{zoom:!0,zoomSpeed:1,rotate:!0,rotateSpeed:1,pan:!0,panSpeed:1},autoRotate:{enabled:!1,speed:1},autoAdjustPlanes:!0},Pm={thetaDelta:0,phiDelta:0,scale:1},cw=Object.assign({},Pm,Nf),lw=({controls:e,camera:t},n)=>{const{EPS:r,drag:s}=e,{position:o,target:i}=t,a=e.up?e.up:t.up;let c=e.thetaDelta;const l=e.phiDelta,u=e.scale,d=mn.subtract([],o,i);let h,m;a[2]===1?(h=oa(d[0],d[1]),m=oa(yd(d[0]*d[0]+d[1]*d[1]),d[2])):(h=oa(d[0],d[2]),m=oa(yd(d[0]*d[0]+d[2]*d[2]),d[1])),e.autoRotate.enabled&&e.userControl.rotate&&(c+=2*Math.PI/60/60*e.autoRotate.speed),h+=c,m+=l,m=xl(r,Al(iw-r,m));const w=xl(e.limits.minDistance,Al(e.limits.maxDistance,mn.length(d)*u));a[2]===1?(d[0]=w*Ts(m)*Ts(h),d[2]=w*sa(m),d[1]=w*Ts(m)*sa(h)):(d[0]=w*Ts(m)*Ts(h),d[1]=w*sa(m),d[2]=w*Ts(m)*sa(h));const p=mn.add(mn.create(),i,d),y=Yo.lookAt(Yo.create(),p,i,a),P=1-xl(Al(s,1),.01),F=mn.distance(o,p)>.001;return{controls:{thetaDelta:c*P,phiDelta:l*P,scale:1,changed:F},camera:{position:p,view:y}}},fw=({controls:e,camera:t,speed:n=1},r)=>{let{thetaDelta:s,phiDelta:o}=e;return e.userControl.rotate&&(s+=r[0]*n,o+=r[1]*n),{controls:{thetaDelta:s,phiDelta:o},camera:t}},uw=({controls:e,camera:t,speed:n=1},r=0)=>{let{scale:s}=e;if(e.userControl.zoom&&t&&r!==void 0&&r!==0&&!isNaN(r)){const o=Math.sign(r)===0?1:Math.sign(r);r=r/r*o*n;const i=r+e.scale,a=mn.distance(t.position,t.target)*i;if(a>e.limits.minDistance&&a<e.limits.maxDistance&&(s+=r),t.projectionType==="orthographic"){const c=mn.length(mn.subtract([],t.position,t.target))*.3,l=Math.tan(t.fov)*c*t.aspect,u=Math.tan(t.fov)*c;t=Ma.setProjection(t,{width:l,height:u})}}return{controls:{scale:s},camera:t}},dw=({controls:e,camera:t,speed:n=1},r)=>{const s=ow(),{projection:o,view:i,viewport:a}=t,c=Yo.multiply([],o,i),l=Yo.invert([],c),u=[a[2],a[3],0],d=[a[2]-r[0],a[3]+r[1],0],h=s([],u,a,l),m=s([],d,a,l),w=mn.distance(t.position,t.eye),p=mn.subtract([],h,m).map(y=>y*n*w*e.scale);return{controls:e,camera:{position:mn.add(mn.create(),t.position,p),target:mn.add(mn.create(),t.target,p)}}},hw=({controls:e,camera:t,entities:n})=>{const{zoomToFit:r}=e;if(r.targets!=="all")return{controls:e,camera:t};if(n.length===0)return{controls:e,camera:t};const s=n.map(m=>m.geometry),o=aw(s),{fov:i,target:a,position:c}=t,{tightness:l}=Object.assign({},r,Nf.zoomToFit),u=o.dia*l/Math.tan(i/2),d=mn.distance(a,c),h=u/d;return{camera:{target:o.center},controls:{scale:h}}},mw=({controls:e,camera:t},n)=>({camera:{position:n.camera.position,target:n.camera.target,projection:Yo.perspective([],t.fov,t.aspect,t.near,t.far),view:n.camera.view},controls:{thetaDelta:n.controls.thetaDelta,phiDelta:n.controls.phiDelta,scale:n.controls.scale}});var vw={controlsProps:Nf,controlsState:Pm,defaults:cw,update:lw,rotate:fw,zoom:uw,pan:dw,zoomToFit:hw,reset:mw};const bd=Mn,Tl=Math.floor(65535/2),pw=(e,t)=>{let{color:n}=e;const r=t.sides;if(r.length===0)return[];"color"in t&&(n=t.color);const s=n[3]<1,o=[],i=Math.floor(r.length/Tl)+1,a=(l,u)=>{o.push(l,u||l)},c=[];for(let l=0;l<i;l++){const u=l*Tl,d=Math.min(u+Tl,r.length),h=[];for(let y=u;y<d;y++){const P=r[y];if(P.color){if(o.length===0&&h.length>0){const F=h.length;for(let L=0;L<F;L++)o.push(n)}a(P.color,P.endColor)}else o.length&&a(n);h.push([P[0][0],P[0][1],0]),h.push([P[1][0],P[1][1],0])}const m=h.map(y=>[0,0,-1]),w=h.map((y,P)=>P),p=t.transforms?bd.clone(t.transforms):bd.create();c.push({type:"2d",positions:h,normals:m,indices:w,transforms:p,color:n,colors:o,isTransparent:s})}return c};var gw=pw;const wr=Ko,_d=Mn,yw=65535,bw=(e,t)=>{let{color:n,smoothLighting:r}=e;"color"in t&&(n=t.color);const s=t.polygons,o=t.transforms?_d.clone(t.transforms):_d.create(),i=[];let a=0;for(;a<s.length;){let c=0,l=a;for(let y=a;y<s.length&&(c+=s[y].vertices.length,!(c>yw));y++)l++;const u=[],d=[],h=[],m=[],w=n[3]<1;for(let y=a;y<l;y++){const P=s[y],F=P.vertices,L=ww(P),k=_w(P,n),T=[];for(let R=0;R<F.length;R++){const B=F[R];u.push(B),d.push(L),m.push(k);const W=u.length-1;T.push(W)}for(let R=2;R<T.length;R++)h.push([T[0],T[R-1],T[R]])}const p={type:"3d",positions:u,normals:d,indices:h,colors:m,transforms:o,isTransparent:w};i.push(p),a=l}return i},_w=(e,t)=>{let n=t;return e.color&&(n=e.color),n&&n.length<4&&n.push(1),n},ww=e=>{if(e.plane)return wr.clone(e.plane);const t=e.vertices,n=wr.create();wr.subtract(n,t[1],t[0]);const r=wr.create();wr.subtract(r,t[2],t[0]);const s=wr.create();return wr.cross(s,n,r),wr.normalize(s,s),s};var $w=bw;const wd=Mn,Sl=Math.floor(65535/2)-2,Ew=(e,t)=>{let{color:n}=e;const r=t.points;if(r.length===0)return[];"color"in t&&(n=t.color);const s=n[3]<1,o=Math.floor(r.length/Sl)+1,i=[];for(let a=0;a<o;a++){const c=a*Sl,l=Math.min(c+Sl,r.length),u=[];let d;for(let p=c;p<l;p++){const y=r[p];d&&(u.push([d[0],d[1],0]),u.push([y[0],y[1],0])),d=y}if(a+1===o&&t.isClosed&&d){const p=r[0];u.push([d[0],d[1],0]),u.push([p[0],p[1],0])}const h=u.map(p=>[0,0,-1]),m=u.map((p,y)=>y),w=t.transforms?wd.clone(t.transforms):wd.create();i.push({type:"2d",positions:u,normals:h,indices:m,transforms:w,color:n,isTransparent:s})}return i};var xw=Ew;const{flatten:Aw,toArray:Tw}=Gf,{meshColor:Sw}=Ba,Pw=gw,Ow=$w,Cw=xw,Mw=e=>e.map(n=>{const r={drawCmd:n.type==="2d"?"drawLines":"drawMesh",show:!0,transparent:n.isTransparent,useVertexColors:!0};return{geometry:n,visuals:r}}),Lw=(e,...t)=>{const n={color:Sw,smoothNormals:!0},{color:r,smoothNormals:s}=Object.assign({},n,e);t=Aw(Tw(t)),t=t.filter(i=>i&&i instanceof Object);const o=[];return t.forEach(i=>{let a=[];"sides"in i?a=Pw({color:r},i):"points"in i?a=Cw({color:r},i):"polygons"in i&&(a=Ow({smoothLighting:s,normalThreshold:.3,color:r},i)),o.push(...Mw(a))}),o};var kw=Lw,Qr={prepareRender:Q5,drawCommands:{drawGrid:J5,drawAxis:tb,drawMesh:sb,drawLines:fb},cameras:{camera:D_,orthographic:Ma,perspective:xf},controls:{orbit:vw},entitiesFromSolids:kw};function Rw(e){let t,n;const r=e[1].default,s=Ey(r,e,e[0],null);return{c(){t=Et("h2"),s&&s.c(),dt(t,"class","svelte-yghvt3")},m(o,i){en(o,t,i),s&&s.m(t,null),n=!0},p(o,[i]){s&&s.p&&(!n||i&1)&&Ay(s,r,o,o[0],n?xy(r,o[0],i,null):Ty(o[0]),null)},i(o){n||(it(s,o),n=!0)},o(o){ut(s,o),n=!1},d(o){o&&Ht(t),s&&s.d(o)}}}function Fw(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=o=>{"$$scope"in o&&n(0,s=o.$$scope)},[s,r]}class Bo extends In{constructor(t){super(),Bn(this,t,Fw,Rw,Dn,{})}}const Gw=e=>{const t={glOptions:{canvas:e.canvas},camera:Nw(e.size.width,e.size.height),drawCommands:{drawAxis:Qr.drawCommands.drawAxis,drawGrid:Qr.drawCommands.drawGrid,drawLines:Qr.drawCommands.drawLines,drawMesh:Qr.drawCommands.drawMesh},entities:[{visuals:{drawCmd:"drawGrid",show:!1},size:[e.size.width,e.size.height],ticks:[25,5]},{visuals:{drawCmd:"drawAxis",show:!1},size:300},...e.models]};Qr.prepareRender(t)(t)},Nw=(e,t)=>{const n=Qr.cameras.perspective,r=Object.assign({},n.defaults);return n.setProjection(r,r,{width:e,height:t}),n.update(r,r),r};function Dw(e){let t;return{c(){t=Nn("Preview")},m(n,r){en(n,t,r)},d(n){n&&Ht(t)}}}function Bw(e){let t,n,r,s,o;return n=new Bo({props:{$$slots:{default:[Dw]},$$scope:{ctx:e}}}),{c(){t=Et("div"),_t(n.$$.fragment),r=bt(),s=Et("canvas"),dt(s,"width",Iw),dt(s,"height",Vw),dt(s,"class","svelte-152eaku"),dt(t,"class","container svelte-152eaku")},m(i,a){en(i,t,a),mt(n,t,null),Qe(t,r),Qe(t,s),e[3](s),o=!0},p(i,[a]){const c={};a&64&&(c.$$scope={dirty:a,ctx:i}),n.$set(c)},i(i){o||(it(n.$$.fragment,i),o=!0)},o(i){ut(n.$$.fragment,i),o=!1},d(i){i&&Ht(t),vt(n),e[3](null)}}}const Iw=500,Vw=500;function zw(e,t,n){let{model:r}=t,s=!1,o,i=[],a=l=>{s&&Gw({canvas:o,size:{width:500,height:500},models:l})};Cy(()=>{s=!0});function c(l){jt[l?"unshift":"push"](()=>{o=l,n(0,o)})}return e.$$set=l=>{"model"in l&&n(1,r=l.model)},e.$$.update=()=>{e.$$.dirty&2&&n(2,i=Qr.entitiesFromSolids({},r)),e.$$.dirty&4&&a(i)},[o,r,i,c]}class Uw extends In{constructor(t){super(),Bn(this,t,zw,Bw,Dn,{model:1})}}var bn=(e=>(e[e.Box=0]="Box",e[e.Cylinder=1]="Cylinder",e))(bn||{});function qw(e){let t,n,r,s;return{c(){t=Et("button"),n=Nn(e[1]),dt(t,"class","svelte-n71m1b")},m(o,i){en(o,t,i),Qe(t,n),r||(s=Da(t,"click",e[2]),r=!0)},p(o,[i]){i&2&&jo(n,o[1])},i:rn,o:rn,d(o){o&&Ht(t),r=!1,s()}}}function Xw(e,t,n){let{onClick:r}=t,{text:s}=t;const o=()=>r();return e.$$set=i=>{"onClick"in i&&n(0,r=i.onClick),"text"in i&&n(1,s=i.text)},[r,s,o]}class Af extends In{constructor(t){super(),Bn(this,t,Xw,qw,Dn,{onClick:0,text:1})}}function jw(e){let t,n,r,s,o,i,a,c,l,u,d;return{c(){t=Et("label"),n=Nn(e[1]),r=bt(),s=Et("span"),o=Et("input"),i=bt(),a=Et("span"),c=Nn(e[2]),dt(o,"type","number"),dt(o,"min","0"),o.disabled=e[3],dt(o,"class","svelte-1uyj0kn"),dt(a,"class","suffix"),dt(s,"class","input-container svelte-1uyj0kn"),dt(t,"class",l=nd(e[3]&&"disabled")+" svelte-1uyj0kn")},m(h,m){en(h,t,m),Qe(t,n),Qe(t,r),Qe(t,s),Qe(s,o),Ca(o,e[0]),Qe(s,i),Qe(s,a),Qe(a,c),u||(d=Da(o,"input",e[4]),u=!0)},p(h,[m]){m&2&&jo(n,h[1]),m&8&&(o.disabled=h[3]),m&1&&fm(o.value)!==h[0]&&Ca(o,h[0]),m&4&&jo(c,h[2]),m&8&&l!==(l=nd(h[3]&&"disabled")+" svelte-1uyj0kn")&&dt(t,"class",l)},i:rn,o:rn,d(h){h&&Ht(t),u=!1,d()}}}function Hw(e,t,n){let{value:r=0}=t,{label:s}=t,{suffix:o=""}=t,{disabled:i=!1}=t;function a(){r=fm(this.value),n(0,r)}return e.$$set=c=>{"value"in c&&n(0,r=c.value),"label"in c&&n(1,s=c.label),"suffix"in c&&n(2,o=c.suffix),"disabled"in c&&n(3,i=c.disabled)},[r,s,o,i,a]}class er extends In{constructor(t){super(),Bn(this,t,Hw,jw,Dn,{value:0,label:1,suffix:2,disabled:3})}}function Yw(e){let t,n,r=!1,s,o,i,a,c,l;return a=Sy(e[5][0]),{c(){t=Et("label"),n=Et("input"),s=bt(),o=Et("span"),i=Nn(e[1]),dt(n,"type","radio"),dt(n,"name",e[2]),n.__value=e[3],Ca(n,n.__value),dt(n,"class","svelte-9ke6f1"),dt(o,"class","svelte-9ke6f1"),dt(t,"class","container svelte-9ke6f1"),a.p(n)},m(u,d){en(u,t,d),Qe(t,n),n.checked=n.__value===e[0],Qe(t,s),Qe(t,o),Qe(o,i),c||(l=Da(n,"change",e[4]),c=!0)},p(u,[d]){d&4&&dt(n,"name",u[2]),d&8&&(n.__value=u[3],Ca(n,n.__value),r=!0),(r||d&1)&&(n.checked=n.__value===u[0]),d&2&&jo(i,u[1])},i:rn,o:rn,d(u){u&&Ht(t),a.r(),c=!1,l()}}}function Ww(e,t,n){let{label:r=""}=t,{group:s}=t,{name:o}=t,{value:i}=t;const a=[[]];function c(){s=this.__value,n(0,s)}return e.$$set=l=>{"label"in l&&n(1,r=l.label),"group"in l&&n(0,s=l.group),"name"in l&&n(2,o=l.name),"value"in l&&n(3,i=l.value)},[s,r,o,i,c,a]}class $d extends In{constructor(t){super(),Bn(this,t,Ww,Yw,Dn,{label:1,group:0,name:2,value:3})}}function Zw(e){let t;return{c(){t=Et("div"),t.innerHTML="",dt(t,"class","spacer svelte-1toqvgr")},m(n,r){en(n,t,r)},p:rn,i:rn,o:rn,d(n){n&&Ht(t)}}}class Ed extends In{constructor(t){super(),Bn(this,t,null,Zw,Dn,{})}}function Qw(e){let t,n,r,s,o,i;return{c(){t=Et("label"),n=Et("input"),r=bt(),s=Et("span"),dt(n,"type","checkbox"),dt(n,"class","svelte-1auq2g7"),dt(s,"class","slider svelte-1auq2g7"),dt(t,"class","container svelte-1auq2g7")},m(a,c){en(a,t,c),Qe(t,n),n.checked=e[0],Qe(t,r),Qe(t,s),o||(i=Da(n,"change",e[1]),o=!0)},p(a,[c]){c&1&&(n.checked=a[0])},i:rn,o:rn,d(a){a&&Ht(t),o=!1,i()}}}function Kw(e,t,n){let{value:r=!1}=t;function s(){r=this.checked,n(0,r)}return e.$$set=o=>{"value"in o&&n(0,r=o.value)},[r,s]}class Jw extends In{constructor(t){super(),Bn(this,t,Kw,Qw,Dn,{value:0})}}function e3(e){let t,n,r,s,o,i,a;function c(u){e[2](u)}let l={};return e[0]!==void 0&&(l.value=e[0]),o=new Jw({props:l}),jt.push(()=>cn(o,"value",c)),{c(){t=Et("label"),n=Et("span"),r=Nn(e[1]),s=bt(),_t(o.$$.fragment),dt(n,"class","label-text svelte-1h04riq"),dt(t,"class","container svelte-1h04riq")},m(u,d){en(u,t,d),Qe(t,n),Qe(n,r),Qe(t,s),mt(o,t,null),a=!0},p(u,[d]){(!a||d&2)&&jo(r,u[1]);const h={};!i&&d&1&&(i=!0,h.value=u[0],an(()=>i=!1)),o.$set(h)},i(u){a||(it(o.$$.fragment,u),a=!0)},o(u){ut(o.$$.fragment,u),a=!1},d(u){u&&Ht(t),vt(o)}}}function t3(e,t,n){let{value:r=!1}=t,{label:s=""}=t;function o(i){r=i,n(0,r)}return e.$$set=i=>{"value"in i&&n(0,r=i.value),"label"in i&&n(1,s=i.label)},[r,s,o]}class xd extends In{constructor(t){super(),Bn(this,t,t3,e3,Dn,{value:0,label:1})}}function n3(e){let t,n;return t=new Af({props:{text:"Download STL",onClick:e[1]}}),{c(){_t(t.$$.fragment)},m(r,s){mt(t,r,s),n=!0},p(r,s){const o={};s&2&&(o.onClick=r[1]),t.$set(o)},i(r){n||(it(t.$$.fragment,r),n=!0)},o(r){ut(t.$$.fragment,r),n=!1},d(r){vt(t,r)}}}function r3(e){let t,n,r,s,o;return n=new Af({props:{text:"Download container STL",onClick:e[1]}}),s=new Af({props:{text:"Download lid STL",onClick:e[2]}}),{c(){t=Et("div"),_t(n.$$.fragment),r=bt(),_t(s.$$.fragment)},m(i,a){en(i,t,a),mt(n,t,null),Qe(t,r),mt(s,t,null),o=!0},p(i,a){const c={};a&2&&(c.onClick=i[1]),n.$set(c);const l={};a&4&&(l.onClick=i[2]),s.$set(l)},i(i){o||(it(n.$$.fragment,i),it(s.$$.fragment,i),o=!0)},o(i){ut(n.$$.fragment,i),ut(s.$$.fragment,i),o=!1},d(i){i&&Ht(t),vt(n),vt(s)}}}function s3(e){let t;return{c(){t=Nn("Container type")},m(n,r){en(n,t,r)},d(n){n&&Ht(t)}}}function o3(e){let t;return{c(){t=Nn("Dimensions")},m(n,r){en(n,t,r)},d(n){n&&Ht(t)}}}function i3(e){let t,n,r;function s(i){e[9](i)}let o={label:`${e[3]} diameter`,suffix:"mm"};return e[0].diameter!==void 0&&(o.value=e[0].diameter),t=new er({props:o}),jt.push(()=>cn(t,"value",s)),{c(){_t(t.$$.fragment)},m(i,a){mt(t,i,a),r=!0},p(i,a){const c={};a&8&&(c.label=`${i[3]} diameter`),!n&&a&1&&(n=!0,c.value=i[0].diameter,an(()=>n=!1)),t.$set(c)},i(i){r||(it(t.$$.fragment,i),r=!0)},o(i){ut(t.$$.fragment,i),r=!1},d(i){vt(t,i)}}}function a3(e){let t,n,r,s,o,i;function a(d){e[7](d)}let c={label:`${e[3]} length`,suffix:"mm"};e[0].length!==void 0&&(c.value=e[0].length),t=new er({props:c}),jt.push(()=>cn(t,"value",a));function l(d){e[8](d)}let u={label:`${e[3]} width`,suffix:"mm"};return e[0].width!==void 0&&(u.value=e[0].width),s=new er({props:u}),jt.push(()=>cn(s,"value",l)),{c(){_t(t.$$.fragment),r=bt(),_t(s.$$.fragment)},m(d,h){mt(t,d,h),en(d,r,h),mt(s,d,h),i=!0},p(d,h){const m={};h&8&&(m.label=`${d[3]} length`),!n&&h&1&&(n=!0,m.value=d[0].length,an(()=>n=!1)),t.$set(m);const w={};h&8&&(w.label=`${d[3]} width`),!o&&h&1&&(o=!0,w.value=d[0].width,an(()=>o=!1)),s.$set(w)},i(d){i||(it(t.$$.fragment,d),it(s.$$.fragment,d),i=!0)},o(d){ut(t.$$.fragment,d),ut(s.$$.fragment,d),i=!1},d(d){d&&Ht(r),vt(t,d),vt(s,d)}}}function c3(e){let t;return{c(){t=Nn("Walls and bottom")},m(n,r){en(n,t,r)},d(n){n&&Ht(t)}}}function Ad(e){let t,n,r;function s(i){e[11](i)}let o={label:"Segments",suffix:""};return e[0].segments!==void 0&&(o.value=e[0].segments),t=new er({props:o}),jt.push(()=>cn(t,"value",s)),{c(){_t(t.$$.fragment)},m(i,a){mt(t,i,a),r=!0},p(i,a){const c={};!n&&a&1&&(n=!0,c.value=i[0].segments,an(()=>n=!1)),t.$set(c)},i(i){r||(it(t.$$.fragment,i),r=!0)},o(i){ut(t.$$.fragment,i),r=!1},d(i){vt(t,i)}}}function l3(e){let t;return{c(){t=Nn("Lid")},m(n,r){en(n,t,r)},d(n){n&&Ht(t)}}}function f3(e){let t,n,r,s,o,i,a,c,l,u,d,h,m,w,p,y,P,F,L,k,T,R,B,W,se,fe,ce,Oe,De,we,Xe,Fe,gt,kt,Ln,qt,Pn,$n,on,rr,oi,Vn,Zs,ii,ur,ai,zn,is,Qs,kn,as,Ks,Un,tn,Cr;const Mr=[r3,n3],qn=[];function ci(pe,ht){return pe[0].generateLid?0:1}n=ci(e),r=qn[n]=Mr[n](e),i=new Bo({props:{$$slots:{default:[s3]},$$scope:{ctx:e}}});function b(pe){e[4](pe)}let li={label:"Box",name:"Type",value:bn.Box};e[0].containerType!==void 0&&(li.group=e[0].containerType),l=new $d({props:li}),jt.push(()=>cn(l,"group",b));function ic(pe){e[5](pe)}let fi={label:"Cylinder",name:"Type",value:bn.Cylinder};e[0].containerType!==void 0&&(fi.group=e[0].containerType),h=new $d({props:fi}),jt.push(()=>cn(h,"group",ic)),y=new Bo({props:{$$slots:{default:[o3]},$$scope:{ctx:e}}});function ac(pe){e[6](pe)}let Xn={label:"Use outer dimensions"};e[0].usingOuterDimensions!==void 0&&(Xn.value=e[0].usingOuterDimensions),F=new xd({props:Xn}),jt.push(()=>cn(F,"value",ac)),T=new Ed({});const Js=[a3,i3],vn=[];function eo(pe,ht){return pe[0].containerType===bn.Box?0:pe[0].containerType===bn.Cylinder?1:-1}~(B=eo(e))&&(W=vn[B]=Js[B](e));function cc(pe){e[10](pe)}let ui={label:`${e[3]} height`,suffix:"mm"};e[0].height!==void 0&&(ui.value=e[0].height),fe=new er({props:ui}),jt.push(()=>cn(fe,"value",cc)),we=new Bo({props:{$$slots:{default:[c3]},$$scope:{ctx:e}}});let Gt=e[0].containerType===bn.Cylinder&&Ad(e);function ln(pe){e[12](pe)}let cs={label:"Wall thickness (mm)",suffix:"mm"};e[0].wallThickness!==void 0&&(cs.value=e[0].wallThickness),gt=new er({props:cs}),jt.push(()=>cn(gt,"value",ln));function di(pe){e[13](pe)}let hi={label:"Bottom thickness",suffix:"mm"};e[0].bottomThickness!==void 0&&(hi.value=e[0].bottomThickness),qt=new er({props:hi}),jt.push(()=>cn(qt,"value",di)),rr=new Bo({props:{$$slots:{default:[l3]},$$scope:{ctx:e}}});function lc(pe){e[14](pe)}let mi={label:"Generate lid"};e[0].generateLid!==void 0&&(mi.value=e[0].generateLid),Vn=new xd({props:mi}),jt.push(()=>cn(Vn,"value",lc)),ur=new Ed({});function fc(pe){e[15](pe)}let vi={label:"Lid outer height",suffix:"mm",disabled:!e[0].generateLid};e[0].lidOuterThickness!==void 0&&(vi.value=e[0].lidOuterThickness),zn=new er({props:vi}),jt.push(()=>cn(zn,"value",fc));function pi(pe){e[16](pe)}let to={label:"Lid inner height",suffix:"mm",disabled:!e[0].generateLid};e[0].lidInnerThickness!==void 0&&(to.value=e[0].lidInnerThickness),kn=new er({props:to}),jt.push(()=>cn(kn,"value",pi));function uc(pe){e[17](pe)}let gi={label:"Tolerance gap",suffix:"mm",disabled:!e[0].generateLid};return e[0].toleranceGap!==void 0&&(gi.value=e[0].toleranceGap),Un=new er({props:gi}),jt.push(()=>cn(Un,"value",uc)),{c(){t=Et("div"),r.c(),s=bt(),o=Et("div"),_t(i.$$.fragment),a=bt(),c=Et("div"),_t(l.$$.fragment),d=bt(),_t(h.$$.fragment),w=bt(),p=Et("div"),_t(y.$$.fragment),P=bt(),_t(F.$$.fragment),k=bt(),_t(T.$$.fragment),R=bt(),W&&W.c(),se=bt(),_t(fe.$$.fragment),Oe=bt(),De=Et("div"),_t(we.$$.fragment),Xe=bt(),Gt&&Gt.c(),Fe=bt(),_t(gt.$$.fragment),Ln=bt(),_t(qt.$$.fragment),$n=bt(),on=Et("div"),_t(rr.$$.fragment),oi=bt(),_t(Vn.$$.fragment),ii=bt(),_t(ur.$$.fragment),ai=bt(),_t(zn.$$.fragment),Qs=bt(),_t(kn.$$.fragment),Ks=bt(),_t(Un.$$.fragment),dt(c,"role","radiogroup"),dt(o,"class","inner-container svelte-mycl5i"),dt(p,"class","inner-container svelte-mycl5i"),dt(De,"class","inner-container svelte-mycl5i"),dt(on,"class","inner-container svelte-mycl5i"),dt(t,"class","container svelte-mycl5i")},m(pe,ht){en(pe,t,ht),qn[n].m(t,null),Qe(t,s),Qe(t,o),mt(i,o,null),Qe(o,a),Qe(o,c),mt(l,c,null),Qe(c,d),mt(h,c,null),Qe(t,w),Qe(t,p),mt(y,p,null),Qe(p,P),mt(F,p,null),Qe(p,k),mt(T,p,null),Qe(p,R),~B&&vn[B].m(p,null),Qe(p,se),mt(fe,p,null),Qe(t,Oe),Qe(t,De),mt(we,De,null),Qe(De,Xe),Gt&&Gt.m(De,null),Qe(De,Fe),mt(gt,De,null),Qe(De,Ln),mt(qt,De,null),Qe(t,$n),Qe(t,on),mt(rr,on,null),Qe(on,oi),mt(Vn,on,null),Qe(on,ii),mt(ur,on,null),Qe(on,ai),mt(zn,on,null),Qe(on,Qs),mt(kn,on,null),Qe(on,Ks),mt(Un,on,null),Cr=!0},p(pe,[ht]){let no=n;n=ci(pe),n===no?qn[n].p(pe,ht):(fl(),ut(qn[no],1,1,()=>{qn[no]=null}),ul(),r=qn[n],r?r.p(pe,ht):(r=qn[n]=Mr[n](pe),r.c()),it(r,1),r.m(t,s));const yi={};ht&262144&&(yi.$$scope={dirty:ht,ctx:pe}),i.$set(yi);const bi={};!u&&ht&1&&(u=!0,bi.group=pe[0].containerType,an(()=>u=!1)),l.$set(bi);const _i={};!m&&ht&1&&(m=!0,_i.group=pe[0].containerType,an(()=>m=!1)),h.$set(_i);const wi={};ht&262144&&(wi.$$scope={dirty:ht,ctx:pe}),y.$set(wi);const $i={};!L&&ht&1&&(L=!0,$i.value=pe[0].usingOuterDimensions,an(()=>L=!1)),F.$set($i);let ro=B;B=eo(pe),B===ro?~B&&vn[B].p(pe,ht):(W&&(fl(),ut(vn[ro],1,1,()=>{vn[ro]=null}),ul()),~B?(W=vn[B],W?W.p(pe,ht):(W=vn[B]=Js[B](pe),W.c()),it(W,1),W.m(p,se)):W=null);const ls={};ht&8&&(ls.label=`${pe[3]} height`),!ce&&ht&1&&(ce=!0,ls.value=pe[0].height,an(()=>ce=!1)),fe.$set(ls);const so={};ht&262144&&(so.$$scope={dirty:ht,ctx:pe}),we.$set(so),pe[0].containerType===bn.Cylinder?Gt?(Gt.p(pe,ht),ht&1&&it(Gt,1)):(Gt=Ad(pe),Gt.c(),it(Gt,1),Gt.m(De,Fe)):Gt&&(fl(),ut(Gt,1,1,()=>{Gt=null}),ul());const St={};!kt&&ht&1&&(kt=!0,St.value=pe[0].wallThickness,an(()=>kt=!1)),gt.$set(St);const Ei={};!Pn&&ht&1&&(Pn=!0,Ei.value=pe[0].bottomThickness,an(()=>Pn=!1)),qt.$set(Ei);const xi={};ht&262144&&(xi.$$scope={dirty:ht,ctx:pe}),rr.$set(xi);const Ai={};!Zs&&ht&1&&(Zs=!0,Ai.value=pe[0].generateLid,an(()=>Zs=!1)),Vn.$set(Ai);const oo={};ht&1&&(oo.disabled=!pe[0].generateLid),!is&&ht&1&&(is=!0,oo.value=pe[0].lidOuterThickness,an(()=>is=!1)),zn.$set(oo);const io={};ht&1&&(io.disabled=!pe[0].generateLid),!as&&ht&1&&(as=!0,io.value=pe[0].lidInnerThickness,an(()=>as=!1)),kn.$set(io);const ao={};ht&1&&(ao.disabled=!pe[0].generateLid),!tn&&ht&1&&(tn=!0,ao.value=pe[0].toleranceGap,an(()=>tn=!1)),Un.$set(ao)},i(pe){Cr||(it(r),it(i.$$.fragment,pe),it(l.$$.fragment,pe),it(h.$$.fragment,pe),it(y.$$.fragment,pe),it(F.$$.fragment,pe),it(T.$$.fragment,pe),it(W),it(fe.$$.fragment,pe),it(we.$$.fragment,pe),it(Gt),it(gt.$$.fragment,pe),it(qt.$$.fragment,pe),it(rr.$$.fragment,pe),it(Vn.$$.fragment,pe),it(ur.$$.fragment,pe),it(zn.$$.fragment,pe),it(kn.$$.fragment,pe),it(Un.$$.fragment,pe),Cr=!0)},o(pe){ut(r),ut(i.$$.fragment,pe),ut(l.$$.fragment,pe),ut(h.$$.fragment,pe),ut(y.$$.fragment,pe),ut(F.$$.fragment,pe),ut(T.$$.fragment,pe),ut(W),ut(fe.$$.fragment,pe),ut(we.$$.fragment,pe),ut(Gt),ut(gt.$$.fragment,pe),ut(qt.$$.fragment,pe),ut(rr.$$.fragment,pe),ut(Vn.$$.fragment,pe),ut(ur.$$.fragment,pe),ut(zn.$$.fragment,pe),ut(kn.$$.fragment,pe),ut(Un.$$.fragment,pe),Cr=!1},d(pe){pe&&Ht(t),qn[n].d(),vt(i),vt(l),vt(h),vt(y),vt(F),vt(T),~B&&vn[B].d(),vt(fe),vt(we),Gt&&Gt.d(),vt(gt),vt(qt),vt(rr),vt(Vn),vt(ur),vt(zn),vt(kn),vt(Un)}}}function u3(e,t,n){let r,{parameters:s}=t,{generateBox:o}=t,{generateLid:i}=t;function a(T){e.$$.not_equal(s.containerType,T)&&(s.containerType=T,n(0,s))}function c(T){e.$$.not_equal(s.containerType,T)&&(s.containerType=T,n(0,s))}function l(T){e.$$.not_equal(s.usingOuterDimensions,T)&&(s.usingOuterDimensions=T,n(0,s))}function u(T){e.$$.not_equal(s.length,T)&&(s.length=T,n(0,s))}function d(T){e.$$.not_equal(s.width,T)&&(s.width=T,n(0,s))}function h(T){e.$$.not_equal(s.diameter,T)&&(s.diameter=T,n(0,s))}function m(T){e.$$.not_equal(s.height,T)&&(s.height=T,n(0,s))}function w(T){e.$$.not_equal(s.segments,T)&&(s.segments=T,n(0,s))}function p(T){e.$$.not_equal(s.wallThickness,T)&&(s.wallThickness=T,n(0,s))}function y(T){e.$$.not_equal(s.bottomThickness,T)&&(s.bottomThickness=T,n(0,s))}function P(T){e.$$.not_equal(s.generateLid,T)&&(s.generateLid=T,n(0,s))}function F(T){e.$$.not_equal(s.lidOuterThickness,T)&&(s.lidOuterThickness=T,n(0,s))}function L(T){e.$$.not_equal(s.lidInnerThickness,T)&&(s.lidInnerThickness=T,n(0,s))}function k(T){e.$$.not_equal(s.toleranceGap,T)&&(s.toleranceGap=T,n(0,s))}return e.$$set=T=>{"parameters"in T&&n(0,s=T.parameters),"generateBox"in T&&n(1,o=T.generateBox),"generateLid"in T&&n(2,i=T.generateLid)},e.$$.update=()=>{e.$$.dirty&1&&n(3,r=s.usingOuterDimensions?"Outer":"Inner")},[s,o,i,r,a,c,l,u,d,h,m,w,p,y,P,F,L,k]}class d3 extends In{constructor(t){super(),Bn(this,t,u3,f3,Dn,{parameters:0,generateBox:1,generateLid:2})}}const Om=e=>e.reduce((t,n)=>Array.isArray(n)?t.concat(Om(n)):t.concat(n),[]);var Ze=Om;const h3=e=>Object.assign({},e);var m3=h3;const v3=(e,t,n)=>(e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e);var p3=v3;const g3=()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var Df=g3;const y3=Df,b3=e=>{const t=y3();return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t};var _3=b3;const w3=(e,t)=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e);var Cm=w3;const $3=(e,t)=>{const n=t[0],r=t[1],s=t[2],o=t[3],i=t[4],a=t[5],c=t[6],l=t[7],u=t[8],d=t[9],h=t[10],m=t[11],w=t[12],p=t[13],y=t[14],P=t[15],F=n*a-r*i,L=n*c-s*i,k=n*l-o*i,T=r*c-s*a,R=r*l-o*a,B=s*l-o*c,W=u*p-d*w,se=u*y-h*w,fe=u*P-m*w,ce=d*y-h*p,Oe=d*P-m*p,De=h*P-m*y;let we=F*De-L*Oe+k*ce+T*fe-R*se+B*W;return we?(we=1/we,e[0]=(a*De-c*Oe+l*ce)*we,e[1]=(s*Oe-r*De-o*ce)*we,e[2]=(p*B-y*R+P*T)*we,e[3]=(h*R-d*B-m*T)*we,e[4]=(c*fe-i*De-l*se)*we,e[5]=(n*De-s*fe+o*se)*we,e[6]=(y*k-w*B-P*L)*we,e[7]=(u*B-h*k+m*L)*we,e[8]=(i*Oe-a*fe+l*W)*we,e[9]=(r*fe-n*Oe-o*W)*we,e[10]=(w*R-p*k+P*F)*we,e[11]=(d*k-u*R-m*F)*we,e[12]=(a*se-i*ce-c*W)*we,e[13]=(n*ce-r*se+s*W)*we,e[14]=(p*L-w*T-y*F)*we,e[15]=(u*T-d*L+h*F)*we,e):null};var E3=$3;const x3=(e,t)=>e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15];var A3=x3;const T3=1e5,S3=1e-5,P3=1e-13,O3=Math.PI*2;var at={EPS:S3,NEPS:P3,TAU:O3,spatialResolution:T3};const{NEPS:C3}=at,Mm=e=>Math.abs(e)<C3?0:e,M3=e=>Mm(Math.sin(e)),L3=e=>Mm(Math.cos(e));var sn={sin:M3,cos:L3};const k3=e=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e);var Lm=k3;const{EPS:R3}=at,{sin:F3,cos:G3}=sn,N3=Lm,D3=(e,t,n)=>{let[r,s,o]=n;const i=r*r+s*s+o*o;if(Math.abs(i)<R3)return N3(e);const a=1/Math.sqrt(i);r*=a,s*=a,o*=a;const c=F3(t),l=G3(t),u=1-l;return e[0]=r*r*u+l,e[1]=s*r*u+o*c,e[2]=o*r*u-s*c,e[3]=0,e[4]=r*s*u-o*c,e[5]=s*s*u+l,e[6]=o*s*u+r*c,e[7]=0,e[8]=r*o*u+s*c,e[9]=s*o*u-r*c,e[10]=o*o*u+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};var km=D3;const B3=(e,t)=>(e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e);var I3=B3;const{sin:Pl,cos:Ol}=sn,V3=(e,t,n,r)=>{const s=Pl(t),o=Ol(t),i=Pl(n),a=Ol(n),c=Pl(r),l=Ol(r);return e[0]=a*o,e[1]=a*s,e[2]=-i,e[3]=0,e[4]=c*i*o-l*s,e[5]=l*o+c*i*s,e[6]=c*a,e[7]=0,e[8]=c*s+l*i*o,e[9]=l*i*s-c*o,e[10]=l*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};var z3=V3;const U3=(e,t)=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e);var q3=U3;const X3=Df,j3=(e,t,n,r,s,o,i,a,c,l,u,d,h,m,w,p)=>{const y=X3();return y[0]=e,y[1]=t,y[2]=n,y[3]=r,y[4]=s,y[5]=o,y[6]=i,y[7]=a,y[8]=c,y[9]=l,y[10]=u,y[11]=d,y[12]=h,y[13]=m,y[14]=w,y[15]=p,y};var H3=j3;const Y3=(e,t)=>(e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e);var Rm=Y3;const W3=(e,t,n)=>(e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e);var Fm=W3;const Z3=(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2];var Ia=Z3;const Q3=Ia,K3=(e,t)=>{const n=e[0],r=e[1],s=e[2],o=t[0],i=t[1],a=t[2],c=Math.sqrt(n*n+r*r+s*s),l=Math.sqrt(o*o+i*i+a*a),u=c*l,d=u&&Q3(e,t)/u;return Math.acos(Math.min(Math.max(d,-1),1))};var J3=K3;const e$=()=>[0,0,0];var Va=e$;const t$=Va,n$=e=>{const t=t$();return t[0]=e[0],t[1]=e[1],t[2]=e[2],t};var r$=n$;const s$=(e,t)=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e);var Gm=s$;const o$=(e,t,n)=>{const r=t[0],s=t[1],o=t[2],i=n[0],a=n[1],c=n[2];return e[0]=s*c-o*a,e[1]=o*i-r*c,e[2]=r*a-s*i,e};var Jo=o$;const i$=(e,t)=>{const n=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(n*n+r*r+s*s)};var Nm=i$;const a$=(e,t,n)=>(e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e);var c$=a$;const l$=(e,t)=>e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2];var f$=l$;const u$=(e,t)=>(e[0]=t,e[1]=t,e[2]=t,e);var d$=u$;const h$=Va,m$=(e,t,n)=>{const r=h$();return r[0]=e,r[1]=t,r[2]=n,r};var v$=m$;const p$=(e,t,n=0)=>(e[0]=t[0],e[1]=t[1],e[2]=n,e);var g$=p$;const y$=e=>{const t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)};var Dm=y$;const b$=(e,t,n,r)=>(e[0]=t[0]+r*(n[0]-t[0]),e[1]=t[1]+r*(n[1]-t[1]),e[2]=t[2]+r*(n[2]-t[2]),e);var _$=b$;const w$=(e,t,n)=>(e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e);var Bm=w$;const $$=(e,t,n)=>(e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e);var Im=$$;const E$=(e,t,n)=>(e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e);var x$=E$;const A$=(e,t)=>(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e);var T$=A$;const S$=(e,t)=>{const n=t[0],r=t[1],s=t[2];let o=n*n+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=s*o,e};var Bf=S$;const P$=Rm,O$=Va,C$=Jo,M$=(e,t)=>{const n=P$(O$(),t),r=0+(n[0]<n[1]&&n[0]<n[2]),s=0+(n[1]<=n[0]&&n[1]<n[2]),o=0+(n[2]<=n[0]&&n[2]<=n[1]);return C$(e,t,[r,s,o])};var L$=M$;const k$=(e,t,n,r)=>{const s=[],o=[];return s[0]=t[0]-n[0],s[1]=t[1]-n[1],s[2]=t[2]-n[2],o[0]=s[0],o[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),o[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e};var R$=k$;const F$=(e,t,n,r)=>{const s=[],o=[];return s[0]=t[0]-n[0],s[1]=t[1]-n[1],s[2]=t[2]-n[2],o[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),o[1]=s[1],o[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e};var G$=F$;const N$=(e,t,n,r)=>{const s=[],o=[];return s[0]=t[0]-n[0],s[1]=t[1]-n[1],o[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),o[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=t[2],e};var D$=N$;const B$=(e,t,n)=>(e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e);var Vm=B$;const I$=(e,t,n)=>(e[0]=Math.round(t[0]/n)*n+0,e[1]=Math.round(t[1]/n)*n+0,e[2]=Math.round(t[2]/n)*n+0,e);var V$=I$;const z$=(e,t)=>{const n=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return n*n+r*r+s*s};var zm=z$;const U$=e=>{const t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r};var Um=U$;const q$=(e,t,n)=>(e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e);var za=q$;const X$=e=>`[${e[0].toFixed(7)}, ${e[1].toFixed(7)}, ${e[2].toFixed(7)}]`;var j$=X$;const H$=(e,t,n)=>{const r=t[0],s=t[1],o=t[2];let i=n[3]*r+n[7]*s+n[11]*o+n[15];return i=i||1,e[0]=(n[0]*r+n[4]*s+n[8]*o+n[12])/i,e[1]=(n[1]*r+n[5]*s+n[9]*o+n[13])/i,e[2]=(n[2]*r+n[6]*s+n[10]*o+n[14])/i,e};var Y$=H$,Ue={abs:Rm,add:Fm,angle:J3,clone:r$,copy:Gm,create:Va,cross:Jo,distance:Nm,divide:c$,dot:Ia,equals:f$,fromScalar:d$,fromValues:v$,fromVec2:g$,length:Dm,lerp:_$,max:Bm,min:Im,multiply:x$,negate:T$,normalize:Bf,orthogonal:L$,rotateX:R$,rotateY:G$,rotateZ:D$,scale:Vm,snap:V$,squaredDistance:zm,squaredLength:Um,subtract:za,toString:j$,transform:Y$};const $r=Ue,W$=km,Z$=(e,t,n)=>{const r=$r.normalize($r.create(),t),s=$r.normalize($r.create(),n),o=$r.cross($r.create(),s,r),i=$r.dot(s,r);if(i===-1)return W$(e,Math.PI,$r.orthogonal(o,r));const a=1/(1+i);return e[0]=o[0]*o[0]*a+i,e[1]=o[1]*o[0]*a-o[2],e[2]=o[2]*o[0]*a+o[1],e[3]=0,e[4]=o[0]*o[1]*a+o[2],e[5]=o[1]*o[1]*a+i,e[6]=o[2]*o[1]*a-o[0],e[7]=0,e[8]=o[0]*o[2]*a-o[1],e[9]=o[1]*o[2]*a+o[0],e[10]=o[2]*o[2]*a+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};var Q$=Z$;const{sin:K$,cos:J$}=sn,eE=(e,t)=>{const n=K$(t),r=J$(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};var tE=eE;const{sin:nE,cos:rE}=sn,sE=(e,t)=>{const n=nE(t),r=rE(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};var oE=sE;const{sin:iE,cos:aE}=sn,cE=(e,t)=>{const n=iE(t),r=aE(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};var lE=cE;const fE=e=>e[0]===1&&e[1]===0&&e[2]===0&&e[3]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[7]===0&&e[8]===0&&e[9]===0&&e[10]===1&&e[11]===0&&e[12]===0&&e[13]===0&&e[14]===0&&e[15]===1;var uE=fE;const dE=e=>ar(e[1])&&ar(e[2])&&ar(e[3])&&ar(e[4])&&ar(e[6])&&ar(e[7])&&ar(e[8])&&ar(e[9])&&ar(e[11])&&e[15]===1,ar=e=>Math.abs(e)<Number.EPSILON;var hE=dE;const mE=e=>{const t=e[4]*e[9]-e[8]*e[5],n=e[8]*e[1]-e[0]*e[9],r=e[0]*e[5]-e[4]*e[1];return t*e[2]+n*e[6]+r*e[10]<0};var vE=mE;const pE=(e,t)=>{const[n,r,s,o]=t;return e[0]=1-2*n*n,e[1]=-2*r*n,e[2]=-2*s*n,e[3]=0,e[4]=-2*n*r,e[5]=1-2*r*r,e[6]=-2*s*r,e[7]=0,e[8]=-2*n*s,e[9]=-2*r*s,e[10]=1-2*s*s,e[11]=0,e[12]=2*n*o,e[13]=2*r*o,e[14]=2*s*o,e[15]=1,e};var gE=pE;const yE=(e,t,n)=>{const r=t[0],s=t[1],o=t[2],i=t[3],a=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=t[9],m=t[10],w=t[11],p=t[12],y=t[13],P=t[14],F=t[15];let L=n[0],k=n[1],T=n[2],R=n[3];return e[0]=L*r+k*a+T*d+R*p,e[1]=L*s+k*c+T*h+R*y,e[2]=L*o+k*l+T*m+R*P,e[3]=L*i+k*u+T*w+R*F,L=n[4],k=n[5],T=n[6],R=n[7],e[4]=L*r+k*a+T*d+R*p,e[5]=L*s+k*c+T*h+R*y,e[6]=L*o+k*l+T*m+R*P,e[7]=L*i+k*u+T*w+R*F,L=n[8],k=n[9],T=n[10],R=n[11],e[8]=L*r+k*a+T*d+R*p,e[9]=L*s+k*c+T*h+R*y,e[10]=L*o+k*l+T*m+R*P,e[11]=L*i+k*u+T*w+R*F,L=n[12],k=n[13],T=n[14],R=n[15],e[12]=L*r+k*a+T*d+R*p,e[13]=L*s+k*c+T*h+R*y,e[14]=L*o+k*l+T*m+R*P,e[15]=L*i+k*u+T*w+R*F,e};var bE=yE;const{EPS:_E}=at,{sin:wE,cos:$E}=sn,EE=Cm,xE=(e,t,n,r)=>{let[s,o,i]=r;const a=s*s+o*o+i*i;if(Math.abs(a)<_E)return EE(e,t);const c=1/Math.sqrt(a);s*=c,o*=c,i*=c;const l=wE(n),u=$E(n),d=1-u,h=t[0],m=t[1],w=t[2],p=t[3],y=t[4],P=t[5],F=t[6],L=t[7],k=t[8],T=t[9],R=t[10],B=t[11],W=s*s*d+u,se=o*s*d+i*l,fe=i*s*d-o*l,ce=s*o*d-i*l,Oe=o*o*d+u,De=i*o*d+s*l,we=s*i*d+o*l,Xe=o*i*d-s*l,Fe=i*i*d+u;return e[0]=h*W+y*se+k*fe,e[1]=m*W+P*se+T*fe,e[2]=w*W+F*se+R*fe,e[3]=p*W+L*se+B*fe,e[4]=h*ce+y*Oe+k*De,e[5]=m*ce+P*Oe+T*De,e[6]=w*ce+F*Oe+R*De,e[7]=p*ce+L*Oe+B*De,e[8]=h*we+y*Xe+k*Fe,e[9]=m*we+P*Xe+T*Fe,e[10]=w*we+F*Xe+R*Fe,e[11]=p*we+L*Xe+B*Fe,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e};var AE=xE;const{sin:TE,cos:SE}=sn,PE=(e,t,n)=>{const r=TE(n),s=SE(n),o=t[4],i=t[5],a=t[6],c=t[7],l=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*s+l*r,e[5]=i*s+u*r,e[6]=a*s+d*r,e[7]=c*s+h*r,e[8]=l*s-o*r,e[9]=u*s-i*r,e[10]=d*s-a*r,e[11]=h*s-c*r,e};var OE=PE;const{sin:CE,cos:ME}=sn,LE=(e,t,n)=>{const r=CE(n),s=ME(n),o=t[0],i=t[1],a=t[2],c=t[3],l=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*s-l*r,e[1]=i*s-u*r,e[2]=a*s-d*r,e[3]=c*s-h*r,e[8]=o*r+l*s,e[9]=i*r+u*s,e[10]=a*r+d*s,e[11]=c*r+h*s,e};var kE=LE;const{sin:RE,cos:FE}=sn,GE=(e,t,n)=>{const r=RE(n),s=FE(n),o=t[0],i=t[1],a=t[2],c=t[3],l=t[4],u=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*s+l*r,e[1]=i*s+u*r,e[2]=a*s+d*r,e[3]=c*s+h*r,e[4]=l*s-o*r,e[5]=u*s-i*r,e[6]=d*s-a*r,e[7]=h*s-c*r,e};var NE=GE;const DE=(e,t,n)=>{const r=n[0],s=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};var BE=DE;const IE=(e,t,n)=>(e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e);var VE=IE;const zE=e=>e.map(t=>t.toFixed(7)).toString();var UE=zE;const qE=(e,t,n)=>{const r=n[0],s=n[1],o=n[2];let i,a,c,l,u,d,h,m,w,p,y,P;return t===e?(e[12]=t[0]*r+t[4]*s+t[8]*o+t[12],e[13]=t[1]*r+t[5]*s+t[9]*o+t[13],e[14]=t[2]*r+t[6]*s+t[10]*o+t[14],e[15]=t[3]*r+t[7]*s+t[11]*o+t[15]):(i=t[0],a=t[1],c=t[2],l=t[3],u=t[4],d=t[5],h=t[6],m=t[7],w=t[8],p=t[9],y=t[10],P=t[11],e[0]=i,e[1]=a,e[2]=c,e[3]=l,e[4]=u,e[5]=d,e[6]=h,e[7]=m,e[8]=w,e[9]=p,e[10]=y,e[11]=P,e[12]=i*r+u*s+w*o+t[12],e[13]=a*r+d*s+p*o+t[13],e[14]=c*r+h*s+y*o+t[14],e[15]=l*r+m*s+P*o+t[15]),e};var XE=qE,wt={add:p3,clone:_3,copy:Cm,create:Df,invert:E3,equals:A3,fromRotation:km,fromScaling:I3,fromTaitBryanRotation:z3,fromTranslation:q3,fromValues:H3,fromVectorRotation:Q$,fromXRotation:tE,fromYRotation:oE,fromZRotation:lE,identity:Lm,isIdentity:uE,isOnlyTransformScale:hE,isMirroring:vE,mirrorByPlane:gE,multiply:bE,rotate:AE,rotateX:OE,rotateY:kE,rotateZ:NE,scale:BE,subtract:VE,toString:UE,translate:XE};const jE=wt,HE=e=>(e===void 0&&(e=[]),{sides:e,transforms:jE.create()});var Ua=HE;const YE=(e,t)=>(e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e);var WE=YE;const ZE=(e,t,n)=>(e[0]=t[0]+n[0],e[1]=t[1]+n[1],e);var QE=ZE;const KE=e=>Math.atan2(e[1],e[0]);var If=KE,JE=If;const ex=If,tx=e=>ex(e)*57.29577951308232;var nx=tx;const rx=()=>[0,0];var qa=rx;const sx=qa,ox=e=>{const t=sx();return t[0]=e[0],t[1]=e[1],t};var ix=ox;const ax=(e,t)=>(e[0]=t[0],e[1]=t[1],e);var cx=ax;const lx=(e,t,n)=>(e[0]=0,e[1]=0,e[2]=t[0]*n[1]-t[1]*n[0],e);var fx=lx;const ux=(e,t)=>{const n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)};var dx=ux;const hx=(e,t,n)=>(e[0]=t[0]/n[0],e[1]=t[1]/n[1],e);var mx=hx;const vx=(e,t)=>e[0]*t[0]+e[1]*t[1];var px=vx;const gx=(e,t)=>e[0]===t[0]&&e[1]===t[1];var yx=gx;const{sin:bx,cos:_x}=sn,wx=(e,t)=>(e[0]=_x(t),e[1]=bx(t),e);var qm=wx;const $x=qm,Ex=(e,t)=>$x(e,t*.017453292519943295);var xx=Ex;const Ax=(e,t)=>(e[0]=t,e[1]=t,e);var Tx=Ax;const Sx=qa,Px=(e,t)=>{const n=Sx();return n[0]=e,n[1]=t,n};var Ox=Px;const Cx=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]);var Mx=Cx;const Lx=(e,t,n,r)=>{const s=t[0],o=t[1];return e[0]=s+r*(n[0]-s),e[1]=o+r*(n[1]-o),e};var kx=Lx;const Rx=(e,t,n)=>(e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e);var Fx=Rx;const Gx=(e,t,n)=>(e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e);var Nx=Gx;const Dx=(e,t,n)=>(e[0]=t[0]*n[0],e[1]=t[1]*n[1],e);var Bx=Dx;const Ix=(e,t)=>(e[0]=-t[0],e[1]=-t[1],e);var Vx=Ix;const zx=(e,t,n,r)=>{const s=t[0]-n[0],o=t[1]-n[1],i=Math.cos(r),a=Math.sin(r);return e[0]=s*i-o*a+n[0],e[1]=s*a+o*i+n[1],e};var Xm=zx;const{TAU:Ux}=at,qx=qa,Xx=Xm,jx=(e,t)=>Xx(e,t,qx(),Ux/4);var Hx=jx;const Yx=(e,t)=>{const n=t[0],r=t[1];let s=n*n+r*r;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e};var Wx=Yx;const Zx=(e,t,n)=>(e[0]=t[0]*n,e[1]=t[1]*n,e);var Qx=Zx;const Kx=(e,t,n)=>(e[0]=Math.round(t[0]/n)*n+0,e[1]=Math.round(t[1]/n)*n+0,e);var Jx=Kx;const eA=(e,t)=>{const n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r};var tA=eA;const nA=e=>{const t=e[0],n=e[1];return t*t+n*n};var rA=nA;const sA=(e,t,n)=>(e[0]=t[0]-n[0],e[1]=t[1]-n[1],e);var oA=sA;const iA=e=>`[${e[0].toFixed(7)}, ${e[1].toFixed(7)}]`;var aA=iA;const cA=(e,t,n)=>{const r=t[0],s=t[1];return e[0]=n[0]*r+n[4]*s+n[12],e[1]=n[1]*r+n[5]*s+n[13],e};var lA=cA,st={abs:WE,add:QE,angle:JE,angleDegrees:nx,angleRadians:If,clone:ix,copy:cx,create:qa,cross:fx,distance:dx,divide:mx,dot:px,equals:yx,fromAngleDegrees:xx,fromAngleRadians:qm,fromScalar:Tx,fromValues:Ox,length:Mx,lerp:kx,max:Fx,min:Nx,multiply:Bx,negate:Vx,normal:Hx,normalize:Wx,rotate:Xm,scale:Qx,snap:Jx,squaredDistance:tA,squaredLength:rA,subtract:oA,toString:aA,transform:lA};const Cl=st,fA=Ua,uA=e=>{if(!Array.isArray(e))throw new Error("the given points must be an array");let t=e.length;if(t<3)throw new Error("the given points must define a closed geometry with three or more points");Cl.equals(e[0],e[t-1])&&--t;const n=[];let r=e[t-1];for(let s=0;s<t;s++){const o=e[s];n.push([Cl.clone(r),Cl.clone(o)]),r=o}return fA(n)};var dA=uA;const hA=wt,Td=st,mA=Ua,vA=e=>{if(e[0]!==0)throw new Error("invalid compact binary data");const t=mA();t.transforms=hA.clone(e.slice(1,17));for(let n=21;n<e.length;n+=4){const r=Td.fromValues(e[n+0],e[n+1]),s=Td.fromValues(e[n+2],e[n+3]);t.sides.push([r,s])}return e[17]>=0&&(t.color=[e[17],e[18],e[19],e[20]]),t};var pA=vA;const gA=e=>!!(e&&typeof e=="object"&&"sides"in e&&"transforms"in e&&Array.isArray(e.sides)&&"length"in e.transforms);var jm=gA;const Sd=wt,ia=st,yA=e=>(Sd.isIdentity(e.transforms)||(e.sides=e.sides.map(t=>{const n=ia.transform(ia.create(),t[0],e.transforms),r=ia.transform(ia.create(),t[1],e.transforms);return[n,r]}),e.transforms=Sd.create()),e);var bA=yA;const _A=bA,wA=e=>_A(e).sides;var ei=wA;const $A=Ua,EA=ei,xA=e=>{const n=EA(e).map(r=>[r[1],r[0]]);return n.reverse(),$A(n)};var AA=xA;const To=st,TA=ei,SA=e=>{const t=new Map,n=r=>{const s=r.toString();return t.has(s)?t.get(s):(t.set(s,r),r)};return e.map(r=>r.map(n))},PA=e=>{const t=new Map;return SA(e).forEach(r=>{t.has(r[0])?t.get(r[0]).push(r):t.set(r[0],[r])}),t},OA=e=>{const t=PA(TA(e)),n=[];for(;;){let r;for(const[i,a]of t){if(r=a.shift(),!r){t.delete(i);continue}break}if(r===void 0)break;const s=[],o=r[0];for(;;){s.push(r[0]);const i=r[1];if(i===o)break;const a=t.get(i);if(!a)throw new Error(`geometry is not closed at vertex ${i}`);const c=CA(r,a);a.length===0&&t.delete(i),r=c}s.length>0&&s.push(s.shift()),n.push(s)}return t.clear(),n},CA=(e,t)=>{if(t.length===1)return t.pop();const n=To.create(),r=To.angleDegrees(To.subtract(n,e[1],e[0]));let s,o;t.forEach((a,c)=>{let u=To.angleDegrees(To.subtract(n,a[1],a[0]))-r;u<-180&&(u+=360),u>=180&&(u-=360),(o===void 0||u>s)&&(o=c,s=u)});const i=t[o];return t.splice(o,1),i};var Hm=OA;const MA=ei,LA=e=>{const n=MA(e).map(r=>r[0]);return n.length>0&&n.push(n.shift()),n};var kA=LA;const Pd=st,RA=ei,FA=e=>{const t=RA(e);let n="geom2 ("+t.length+` sides):
[
`;return t.forEach(r=>{n+="  ["+Pd.toString(r[0])+", "+Pd.toString(r[1])+`]
`}),n+=`]
`,n};var GA=FA;const NA=e=>{const t=e.sides,n=e.transforms;let r=[-1,-1,-1,-1];e.color&&(r=e.color);const s=new Float32Array(1+16+4+t.length*4);s[0]=0,s[1]=n[0],s[2]=n[1],s[3]=n[2],s[4]=n[3],s[5]=n[4],s[6]=n[5],s[7]=n[6],s[8]=n[7],s[9]=n[8],s[10]=n[9],s[11]=n[10],s[12]=n[11],s[13]=n[12],s[14]=n[13],s[15]=n[14],s[16]=n[15],s[17]=r[0],s[18]=r[1],s[19]=r[2],s[20]=r[3];for(let o=0;o<t.length;o++){const i=o*4+21,a=t[o][0],c=t[o][1];s[i+0]=a[0],s[i+1]=a[1],s[i+2]=c[0],s[i+3]=c[1]}return s};var DA=NA;const Od=wt,BA=(e,t)=>{const n=Od.multiply(Od.create(),e,t.transforms);return Object.assign({},t,{transforms:n})};var IA=BA;const VA=st,zA=jm,UA=Hm,qA=e=>{if(!zA(e))throw new Error("invalid geom2 structure");if(UA(e),e.sides.forEach(t=>{if(VA.equals(t[0],t[1]))throw new Error(`geom2 self-edge ${t[0]}`)}),!e.transforms.every(Number.isFinite))throw new Error(`geom2 invalid transforms ${e.transforms}`)};var XA=qA,Je={clone:m3,create:Ua,fromPoints:dA,fromCompactBinary:pA,isA:jm,reverse:AA,toOutlines:Hm,toPoints:kA,toSides:ei,toString:GA,toCompactBinary:DA,transform:IA,validate:XA};const jA=e=>Object.assign({},e);var HA=jA;const YA=wt,WA=e=>(e===void 0&&(e=[]),{polygons:e,transforms:YA.create()});var Xa=WA;const ZA=e=>((e===void 0||e.length<3)&&(e=[]),{vertices:e});var js=ZA;const QA=js,KA=Ue,JA=(...e)=>{let t,n;return e.length===1?(t=QA(),n=e[0]):(t=e[0],n=e[1]),t.vertices=n.vertices.map(r=>KA.clone(r)),t};var eT=JA;const tT=Ue,nT=js,rT=e=>{const t=e.map(n=>tT.clone(n));return nT(t)};var sT=rT;const oT=js,iT=(e,t)=>{const n=oT(e);return n.plane=t,n};var aT=iT;const cT=()=>[0,0,0,0];var ja=cT;const lT=ja,fT=e=>{const t=lT();return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};var Ym=fT;const uT=(e,t)=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e);var Wm=uT;const dT=(e,t)=>e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3];var Zm=dT;const hT=(e,t)=>(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e);var Qm=hT;const Ml=Ue,mT=(e,t,n)=>{const r=Ml.normalize(Ml.create(),t),s=Ml.dot(n,r);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=s,e};var vT=mT;const pT=ja,gT=(e,t,n,r)=>{const s=pT();return s[0]=e,s[1]=t,s[2]=n,s[3]=r,s};var Km=gT;const Zn=Ue,yT=(e,...t)=>{const n=t.length,r=Zn.create(),s=Zn.create(),o=i=>{const a=t[i],c=t[(i+1)%n],l=t[(i+2)%n];return Zn.subtract(r,c,a),Zn.subtract(s,l,a),Zn.cross(r,r,s),Zn.normalize(r,r),r};return e[0]=0,e[1]=0,e[2]=0,n===3?Zn.copy(e,o(0)):(t.forEach((i,a)=>{Zn.add(e,e,o(a))}),Zn.normalize(e,e)),e[3]=Zn.dot(e,t[0]),e};var Jm=yT;const{EPS:Ll}=at,un=Ue,bT=(e,t,n,r)=>{let s=un.subtract(un.create(),n,t),o=un.subtract(un.create(),r,t);un.length(s)<Ll&&(s=un.orthogonal(s,o)),un.length(o)<Ll&&(o=un.orthogonal(o,s));let i=un.cross(un.create(),s,o);un.length(i)<Ll&&(o=un.orthogonal(o,s),i=un.cross(i,s,o)),i=un.normalize(i,i);const a=un.dot(i,t);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=a,e};var _T=bT;const wT=Ue,$T=(e,t)=>{const n=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]-e[3],r=t[0]-n*e[0],s=t[1]-n*e[1],o=t[2]-n*e[2];return wT.fromValues(r,s,o)};var ET=$T;const xT=Ue,AT=(e,t)=>xT.dot(e,t)-e[3];var ev=AT;const TT=e=>`(${e[0].toFixed(9)}, ${e[1].toFixed(9)}, ${e[2].toFixed(9)}, ${e[3].toFixed(9)})`;var tv=TT;const ST=wt,dn=Ue,PT=Jm,OT=Qm,CT=(e,t,n)=>{const r=ST.isMirroring(n),s=dn.orthogonal(dn.create(),t),o=dn.cross(s,t,s),i=dn.cross(dn.create(),t,o);let a=dn.fromScalar(dn.create(),t[3]);dn.multiply(a,a,t);let c=dn.add(dn.create(),a,o),l=dn.add(dn.create(),a,i);return a=dn.transform(a,a,n),c=dn.transform(c,c,n),l=dn.transform(l,l,n),PT(e,a,c,l),r&&OT(e,e),e};var MT=CT,nr={clone:Ym,copy:Wm,create:ja,equals:Zm,flip:Qm,fromNormalAndPoint:vT,fromValues:Km,fromPoints:Jm,fromPointsRandom:_T,projectionOfPoint:ET,signedDistanceToPoint:ev,toString:tv,transform:MT};const Cd=nr,LT=js,kT=e=>{const t=e.vertices.slice().reverse(),n=LT(t);return e.plane&&(n.plane=Cd.flip(Cd.create(),e.plane)),n};var RT=kT;const FT=e=>!!(e&&typeof e=="object"&&"vertices"in e&&Array.isArray(e.vertices));var nv=FT;const Md=nr,jr=Ue,GT=e=>NT(e.vertices),NT=e=>{const t=e.length;if(t>2){const n=Md.fromPoints(Md.create(),...e);let r=e[t-2],s=e[t-1];for(let o=0;o<t;o++){const i=e[o];if(!DT(r,s,i,n))return!1;r=s,s=i}}return!0},DT=(e,t,n,r)=>{const s=jr.cross(jr.create(),jr.subtract(jr.create(),t,e),jr.subtract(jr.create(),n,t));return jr.dot(s,r)>=0};var rv=GT;const Ld=nr,BT=e=>(e.plane||(e.plane=Ld.fromPoints(Ld.create(),...e.vertices)),e.plane);var Vf=BT;const IT=Vf,VT=e=>{const t=e.vertices.length;if(t<3)return 0;const n=e.vertices,r=IT(e),s=Math.abs(r[0]),o=Math.abs(r[1]),i=Math.abs(r[2]);if(s+o+i===0)return 0;let a=3;s>o&&s>i?a=1:o>i&&(a=2);let c=0,l=0,u=1,d=2;switch(a){case 1:for(u=1;u<t;u++)l=u-1,d=(u+1)%t,c+=n[u][1]*(n[d][2]-n[l][2]);c+=n[0][1]*(n[1][2]-n[t-1][2]),c/=2*r[0];break;case 2:for(u=1;u<t;u++)l=u-1,d=(u+1)%t,c+=n[u][2]*(n[d][0]-n[l][0]);c+=n[0][2]*(n[1][0]-n[t-1][0]),c/=2*r[1];break;case 3:default:for(u=1;u<t;u++)l=u-1,d=(u+1)%t,c+=n[u][0]*(n[d][1]-n[l][1]);c+=n[0][0]*(n[1][1]-n[t-1][1]),c/=2*r[2];break}return c};var sv=VT;const So=Ue,zT=e=>{const t=e.vertices,n=t.length,r=n===0?So.create():So.clone(t[0]),s=So.clone(r);for(let o=1;o<n;o++)So.min(r,r,t[o]),So.max(s,s,t[o]);return[r,s]};var UT=zT;const qT=(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3];var XT=qT;const jT=(e,t)=>(e[0]=t,e[1]=t,e[2]=t,e[3]=t,e);var HT=jT;const YT=(e,t,n)=>{const[r,s,o,i]=t;return e[0]=n[0]*r+n[4]*s+n[8]*o+n[12]*i,e[1]=n[1]*r+n[5]*s+n[9]*o+n[13]*i,e[2]=n[2]*r+n[6]*s+n[10]*o+n[14]*i,e[3]=n[3]*r+n[7]*s+n[11]*o+n[15]*i,e};var WT=YT,ov={clone:Ym,copy:Wm,create:ja,dot:XT,equals:Zm,fromScalar:HT,fromValues:Km,toString:tv,transform:WT};const ZT=ov,kd=new WeakMap,QT=e=>{const t=kd.get(e);if(t)return t;const n=e.vertices,r=ZT.create();if(n.length===0)return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r;let s=n[0],o=s,i=s,a=s,c=s,l=s;n.forEach(m=>{s[0]>m[0]&&(s=m),o[1]>m[1]&&(o=m),i[2]>m[2]&&(i=m),a[0]<m[0]&&(a=m),c[1]<m[1]&&(c=m),l[2]<m[2]&&(l=m)}),r[0]=(s[0]+a[0])*.5,r[1]=(o[1]+c[1])*.5,r[2]=(i[2]+l[2])*.5;const u=r[0]-a[0],d=r[1]-c[1],h=r[2]-l[2];return r[3]=Math.sqrt(u*u+d*d+h*h),kd.set(e,r),r};var KT=QT;const kl=Ue,JT=e=>{let t=0;const n=e.vertices,r=kl.create();for(let s=0;s<n.length-2;s++)kl.cross(r,n[s+1],n[s+2]),t+=kl.dot(n[0],r);return t/=6,t};var e4=JT;const t4=e=>e.vertices;var n4=t4;const r4=Ue,s4=e=>{let t="poly3: vertices: [";return e.vertices.forEach(n=>{t+=`${r4.toString(n)}, `}),t+="]",t};var o4=s4;const i4=wt,Rd=Ue,a4=js,c4=(e,t)=>{const n=t.vertices.map(r=>Rd.transform(Rd.create(),r,e));return i4.isMirroring(e)&&n.reverse(),a4(n)};var l4=c4;const f4=ev,{NEPS:u4}=at,d4=Ue,h4=nv,m4=rv,v4=sv,p4=Vf,g4=e=>{if(!h4(e))throw new Error("invalid poly3 structure");if(e.vertices.length<3)throw new Error(`poly3 not enough vertices ${e.vertices.length}`);if(v4(e)<=0)throw new Error("poly3 area must be greater than zero");for(let t=0;t<e.vertices.length;t++)if(d4.equals(e.vertices[t],e.vertices[(t+1)%e.vertices.length]))throw new Error(`poly3 duplicate vertex ${e.vertices[t]}`);if(!m4(e))throw new Error("poly3 must be convex");if(e.vertices.forEach(t=>{if(!t.every(Number.isFinite))throw new Error(`poly3 invalid vertex ${t}`)}),e.vertices.length>3){const t=p4(e);e.vertices.forEach(n=>{const r=Math.abs(f4(t,n));if(r>u4)throw new Error(`poly3 must be coplanar: vertex ${n} distance ${r}`)})}};var y4=g4,ct={clone:eT,create:js,fromPoints:sT,fromPointsAndPlane:aT,invert:RT,isA:nv,isConvex:rv,measureArea:sv,measureBoundingBox:UT,measureBoundingSphere:KT,measureSignedVolume:e4,plane:Vf,toPoints:n4,toString:o4,transform:l4,validate:y4};const b4=ct,_4=Xa,w4=e=>{if(!Array.isArray(e))throw new Error("the given points must be an array");const t=e.map((r,s)=>b4.create(r));return _4(t)};var $4=w4;const E4=Ue,x4=wt,A4=ct,T4=Xa,S4=e=>{if(e[0]!==1)throw new Error("invalid compact binary data");const t=T4();t.transforms=x4.clone(e.slice(1,17));const n=e[21];let r=22,s=e.length-n*3;for(;s<e.length;){const o=e[r];r++;const i=[];for(let a=0;a<o;a++)i.push(E4.fromValues(e[s],e[s+1],e[s+2])),s+=3;t.polygons.push(A4.create(i))}return e[17]>=0&&(t.color=[e[17],e[18],e[19],e[20]]),t};var P4=S4;const Fd=wt,O4=ct,C4=e=>(Fd.isIdentity(e.transforms)||(e.polygons=e.polygons.map(t=>O4.transform(e.transforms,t)),e.transforms=Fd.create()),e);var M4=C4;const L4=M4,k4=e=>L4(e).polygons;var Ha=k4;const R4=ct,F4=Xa,G4=Ha,N4=e=>{const n=G4(e).map(r=>R4.invert(r));return F4(n)};var D4=N4;const B4=e=>!!(e&&typeof e=="object"&&"polygons"in e&&"transforms"in e&&Array.isArray(e.polygons)&&"length"in e.transforms);var iv=B4;const I4=ct,V4=Ha,z4=e=>V4(e).map(r=>I4.toPoints(r));var U4=z4;const q4=ct,X4=Ha,j4=e=>{const t=X4(e);let n="geom3 ("+t.length+` polygons):
`;return t.forEach(r=>{n+="  "+q4.toString(r)+`
`}),n};var H4=j4;const Y4=ct,W4=e=>{const t=e.polygons,n=e.transforms,r=t.length,s=t.reduce((l,u)=>l+u.vertices.length,0);let o=[-1,-1,-1,-1];e.color&&(o=e.color);const i=new Float32Array(1+16+4+1+r+s*3);i[0]=1,i[1]=n[0],i[2]=n[1],i[3]=n[2],i[4]=n[3],i[5]=n[4],i[6]=n[5],i[7]=n[6],i[8]=n[7],i[9]=n[8],i[10]=n[9],i[11]=n[10],i[12]=n[11],i[13]=n[12],i[14]=n[13],i[15]=n[14],i[16]=n[15],i[17]=o[0],i[18]=o[1],i[19]=o[2],i[20]=o[3],i[21]=s;let a=22,c=a+r;return t.forEach(l=>{const u=Y4.toPoints(l);i[a]=u.length,a++;for(let d=0;d<u.length;d++){const h=u[d];i[c+0]=h[0],i[c+1]=h[1],i[c+2]=h[2],c+=3}}),i};var Z4=W4;const Gd=wt,Q4=(e,t)=>{const n=Gd.multiply(Gd.create(),e,t.transforms);return Object.assign({},t,{transforms:n})};var K4=Q4;const J4=ct,eS=iv,tS=e=>{if(!eS(e))throw new Error("invalid geom3 structure");if(e.polygons.forEach(J4.validate),nS(e),!e.transforms.every(Number.isFinite))throw new Error(`geom3 invalid transforms ${e.transforms}`)},nS=e=>{const t=new Map;e.polygons.forEach(({vertices:r})=>{r.forEach((s,o)=>{const i=`${s}`,a=`${r[(o+1)%r.length]}`,c=`${i}/${a}`,l=t.has(c)?t.get(c):0;t.set(c,l+1)})});const n=[];if(t.forEach((r,s)=>{const o=s.split("/").reverse().join("/"),i=t.get(o);r!==i&&n.push(s.replace("/"," -> "))}),n.length>0)throw new Error(`non-manifold edges ${n.length}
${n.join(`
`)}`)};var rS=tS,et={clone:HA,create:Xa,fromPoints:$4,fromCompactBinary:P4,invert:D4,isA:iv,toPoints:U4,toPolygons:Ha,toString:H4,toCompactBinary:Z4,transform:K4,validate:rS};const sS=e=>Object.assign({},e);var zf=sS;const{EPS:Nd}=at,oS=st,iS=zf,aS=e=>{if(e.isClosed)return e;const t=iS(e);if(t.isClosed=!0,t.points.length>1){const n=t.points,r=n[0];let s=n[n.length-1];for(;oS.distance(r,s)<Nd*Nd&&(n.pop(),n.length!==1);)s=n[n.length-1]}return t};var av=aS;const cS=wt,lS=e=>(e===void 0&&(e=[]),{points:e,isClosed:!1,transforms:cS.create()});var Ya=lS;const{EPS:Dd}=at,Bd=st,fS=av,uS=Ya,dS=(e,t)=>{const n={closed:!1};let{closed:r}=Object.assign({},n,e),s=uS();if(s.points=t.map(o=>Bd.clone(o)),s.points.length>1){const o=s.points[0],i=s.points[s.points.length-1];Bd.distance(o,i)<Dd*Dd&&(r=!0)}return r===!0&&(s=fS(s)),s};var Uf=dS;const Id=wt,Vd=st,hS=e=>(Id.isIdentity(e.transforms)||(e.points=e.points.map(t=>Vd.transform(Vd.create(),t,e.transforms)),e.transforms=Id.create()),e);var mS=hS;const vS=mS,pS=e=>vS(e).points;var Hs=pS;const{TAU:aa}=at,zt=st,gS=Uf,yS=Hs,bS=(e,t)=>{const n={radius:[0,0],xaxisrotation:0,clockwise:!1,large:!1,segments:16};let{endpoint:r,radius:s,xaxisrotation:o,clockwise:i,large:a,segments:c}=Object.assign({},n,e);if(!Array.isArray(r))throw new Error("endpoint must be an array of X and Y values");if(r.length<2)throw new Error("endpoint must contain X and Y values");if(r=zt.clone(r),!Array.isArray(s))throw new Error("radius must be an array of X and Y values");if(s.length<2)throw new Error("radius must contain X and Y values");if(c<4)throw new Error("segments must be four or more");const l=1e5;if(t.isClosed)throw new Error("the given path cannot be closed");const u=yS(t);if(u.length<1)throw new Error("the given path must contain one or more points (as the starting point for the arc)");let d=s[0],h=s[1];const m=u[u.length-1];d=Math.round(d*l)/l,h=Math.round(h*l)/l,r=zt.fromValues(Math.round(r[0]*l)/l,Math.round(r[1]*l)/l);const w=!i;let p=[];if(d===0||h===0)p.push(r);else{d=Math.abs(d),h=Math.abs(h);const P=o,F=Math.cos(P),L=Math.sin(P),k=zt.subtract(zt.create(),m,r);zt.scale(k,k,.5);const T=Math.round((F*k[0]+L*k[1])*l)/l,R=Math.round((-L*k[0]+F*k[1])*l)/l,B=zt.fromValues(T,R),W=B[0]*B[0]/(d*d)+B[1]*B[1]/(h*h);if(W>1){const kt=Math.sqrt(W);d*=kt,h*=kt,d=Math.round(d*l)/l,h=Math.round(h*l)/l}let se=Math.sqrt((d*d*h*h-d*d*B[1]*B[1]-h*h*B[0]*B[0])/(d*d*B[1]*B[1]+h*h*B[0]*B[0]));w===a&&(se=-se);const fe=zt.fromValues(d*B[1]/h,-h*B[0]/d);zt.scale(fe,fe,se);let ce=zt.fromValues(F*fe[0]-L*fe[1],L*fe[0]+F*fe[1]);ce=zt.add(ce,ce,zt.scale(zt.create(),zt.add(zt.create(),m,r),.5));const Oe=zt.fromValues((B[0]-fe[0])/d,(B[1]-fe[1])/h),De=zt.fromValues((-B[0]-fe[0])/d,(-B[1]-fe[1])/h),we=zt.angleRadians(Oe);let Fe=zt.angleRadians(De)-we;Fe=Fe%aa,!w&&Fe>0?Fe-=aa:w&&Fe<0&&(Fe+=aa);let gt=Math.ceil(Math.abs(Fe)/aa*c)+1;gt<1&&(gt=1);for(let kt=1;kt<gt;kt++){const Ln=we+kt/gt*Fe,qt=Math.cos(Ln),Pn=Math.sin(Ln),$n=zt.fromValues(F*d*qt-L*h*Pn,L*d*qt+F*h*Pn);zt.add($n,$n,ce),p.push($n)}gt&&p.push(e.endpoint)}return p=u.concat(p),gS({},p)};var _S=bS;const wS=Uf,$S=Hs,{equals:ES}=st,xS=(...e)=>{let t=!1,n=[];return e.forEach((r,s)=>{const o=$S(r).slice();if(n.length>0&&o.length>0&&ES(o[0],n[n.length-1])&&o.shift(),o.length>0&&t)throw new Error(`Cannot concatenate to a closed path; check the ${s}th path`);t=r.isClosed,n=n.concat(o)}),wS({closed:t},n)};var cv=xS;const AS=cv,TS=Ya,SS=(e,t)=>AS(t,TS(e));var lv=SS;const{TAU:PS}=at,Tn=st,OS=st,CS=lv,MS=Hs,LS=(e,t)=>{const n={segments:16};let{controlPoints:r,segments:s}=Object.assign({},n,e);if(!Array.isArray(r))throw new Error("controlPoints must be an array of one or more points");if(r.length<1)throw new Error("controlPoints must be an array of one or more points");if(s<4)throw new Error("segments must be four or more");if(t.isClosed)throw new Error("the given geometry cannot be closed");const o=MS(t);if(o.length<1)throw new Error("the given path must contain one or more points (as the starting point for the bezier curve)");if(r=r.slice(),r[0]===null){if(r.length<2)throw new Error("a null control point must be passed with one more control points");let R=o[o.length-2];if("lastBezierControlPoint"in t&&(R=t.lastBezierControlPoint),!Array.isArray(R))throw new Error("the given path must contain TWO or more points if given a null control point");const B=Tn.scale(Tn.create(),o[o.length-1],2);Tn.subtract(B,B,R),r[0]=B}r.unshift(o[o.length-1]);const a=r.length-1,c=[];let l=1;for(let R=0;R<=a;++R)R>0&&(l*=R),c.push(l);const u=[];for(let R=0;R<=a;++R){const B=c[a]/(c[R]*c[a-R]);u.push(B)}const d=Tn.create(),h=Tn.create(),m=OS.create(),w=R=>{let B=1,W=Math.pow(1-R,a);const se=R!==1?1/(1-R):1,fe=Tn.create();for(let ce=0;ce<=a;++ce){ce===a&&(W=1);const Oe=u[ce]*B*W,De=Tn.scale(d,r[ce],Oe);Tn.add(fe,fe,De),B*=R,W*=se}return fe},p=[],y=[],P=a+1;for(let R=0;R<P;++R){const B=R/(P-1),W=w(B);p.push(W),y.push(B)}let F=1;const L=PS/s,k=Math.sin(L);for(;F<p.length-1;){const R=Tn.subtract(d,p[F],p[F-1]);Tn.normalize(R,R);const B=Tn.subtract(h,p[F+1],p[F]);Tn.normalize(B,B);const W=Tn.cross(m,R,B);if(Math.abs(W[2])>k){const se=y[F-1],fe=y[F+1],ce=se+(fe-se)*1/3,Oe=se+(fe-se)*2/3,De=w(ce),we=w(Oe);p.splice(F,1,De,we),y.splice(F,1,ce,Oe),F--,F<1&&(F=1)}else++F}p.shift();const T=CS(p,t);return T.lastBezierControlPoint=r[r.length-2],T};var kS=LS;const RS=st,zd=Hs,FS=(e,t)=>{if(e.isClosed!==t.isClosed||e.points.length!==t.points.length)return!1;const n=zd(e),r=zd(t),s=n.length;let o=0;do{let i=!1;for(let a=0;a<s;a++)if(!RS.equals(n[a],r[(a+o)%s])){i=!0;break}if(i===!1)return!0;if(!e.isClosed)return!1}while(++o<s);return!1};var GS=FS;const NS=wt,DS=st,BS=Ya,IS=e=>{if(e[0]!==2)throw new Error("invalid compact binary data");const t=BS();t.transforms=NS.clone(e.slice(1,17)),t.isClosed=!!e[17];for(let n=22;n<e.length;n+=2){const r=DS.fromValues(e[n],e[n+1]);t.points.push(r)}return e[18]>=0&&(t.color=[e[18],e[19],e[20],e[21]]),t};var VS=IS;const zS=e=>!!(e&&typeof e=="object"&&"points"in e&&"transforms"in e&&"isClosed"in e&&Array.isArray(e.points)&&"length"in e.transforms);var fv=zS;const US=zf,qS=e=>{const t=US(e);return t.points=e.points.slice().reverse(),t};var XS=qS;const jS=st,HS=Hs,YS=e=>{const t=HS(e);let n="path ("+t.length+" points, "+e.isClosed+`):
[
`;return t.forEach(r=>{n+="  "+jS.toString(r)+`,
`}),n+=`]
`,n};var WS=YS;const ZS=e=>{const t=e.points,n=e.transforms;let r=[-1,-1,-1,-1];e.color&&(r=e.color);const s=new Float32Array(1+16+1+4+t.length*2);s[0]=2,s[1]=n[0],s[2]=n[1],s[3]=n[2],s[4]=n[3],s[5]=n[4],s[6]=n[5],s[7]=n[6],s[8]=n[7],s[9]=n[8],s[10]=n[9],s[11]=n[10],s[12]=n[11],s[13]=n[12],s[14]=n[13],s[15]=n[14],s[16]=n[15],s[17]=e.isClosed?1:0,s[18]=r[0],s[19]=r[1],s[20]=r[2],s[21]=r[3];for(let o=0;o<t.length;o++){const i=o*2+22,a=t[o];s[i]=a[0],s[i+1]=a[1]}return s};var QS=ZS;const Ud=wt,KS=(e,t)=>{const n=Ud.multiply(Ud.create(),e,t.transforms);return Object.assign({},t,{transforms:n})};var JS=KS;const eP=st,tP=fv,nP=e=>{if(!tP(e))throw new Error("invalid path2 structure");if(e.points.length>1){for(let t=0;t<e.points.length;t++)if(eP.equals(e.points[t],e.points[(t+1)%e.points.length]))throw new Error(`path2 duplicate points ${e.points[t]}`)}if(e.points.forEach(t=>{if(!t.every(Number.isFinite))throw new Error(`path2 invalid point ${t}`)}),!e.transforms.every(Number.isFinite))throw new Error(`path2 invalid transforms ${e.transforms}`)};var rP=nP,pt={appendArc:_S,appendBezier:kS,appendPoints:lv,clone:zf,close:av,concat:cv,create:Ya,equals:GS,fromPoints:Uf,fromCompactBinary:VS,isA:fv,reverse:XS,toPoints:Hs,toString:WS,toCompactBinary:QS,transform:JS,validate:rP};const sP=Ze,uv=Je,dv=et,hv=pt,mv=ct,oP=(e,t)=>{const n=uv.clone(t);return n.color=e,n},iP=(e,t)=>{const n=dv.clone(t);return n.color=e,n},aP=(e,t)=>{const n=hv.clone(t);return n.color=e,n},cP=(e,t)=>{const n=mv.clone(t);return n.color=e,n},lP=(e,...t)=>{if(!Array.isArray(e))throw new Error("color must be an array");if(e.length<3)throw new Error("color must contain R, G and B values");if(e.length===3&&(e=[e[0],e[1],e[2],1]),t=sP(t),t.length===0)throw new Error("wrong number of arguments");const n=t.map(r=>uv.isA(r)?oP(e,r):dv.isA(r)?iP(e,r):hv.isA(r)?aP(e,r):mv.isA(r)?cP(e,r):(r.color=e,r));return n.length===1?n[0]:n};var fP=lP;const uP={black:[0/255,0/255,0/255],silver:[192/255,192/255,192/255],gray:[128/255,128/255,128/255],white:[255/255,255/255,255/255],maroon:[128/255,0/255,0/255],red:[255/255,0/255,0/255],purple:[128/255,0/255,128/255],fuchsia:[255/255,0/255,255/255],green:[0/255,128/255,0/255],lime:[0/255,255/255,0/255],olive:[128/255,128/255,0/255],yellow:[255/255,255/255,0/255],navy:[0/255,0/255,128/255],blue:[0/255,0/255,255/255],teal:[0/255,128/255,128/255],aqua:[0/255,255/255,255/255],aliceblue:[240/255,248/255,255/255],antiquewhite:[250/255,235/255,215/255],aquamarine:[127/255,255/255,212/255],azure:[240/255,255/255,255/255],beige:[245/255,245/255,220/255],bisque:[255/255,228/255,196/255],blanchedalmond:[255/255,235/255,205/255],blueviolet:[138/255,43/255,226/255],brown:[165/255,42/255,42/255],burlywood:[222/255,184/255,135/255],cadetblue:[95/255,158/255,160/255],chartreuse:[127/255,255/255,0/255],chocolate:[210/255,105/255,30/255],coral:[255/255,127/255,80/255],cornflowerblue:[100/255,149/255,237/255],cornsilk:[255/255,248/255,220/255],crimson:[220/255,20/255,60/255],cyan:[0/255,255/255,255/255],darkblue:[0/255,0/255,139/255],darkcyan:[0/255,139/255,139/255],darkgoldenrod:[184/255,134/255,11/255],darkgray:[169/255,169/255,169/255],darkgreen:[0/255,100/255,0/255],darkgrey:[169/255,169/255,169/255],darkkhaki:[189/255,183/255,107/255],darkmagenta:[139/255,0/255,139/255],darkolivegreen:[85/255,107/255,47/255],darkorange:[255/255,140/255,0/255],darkorchid:[153/255,50/255,204/255],darkred:[139/255,0/255,0/255],darksalmon:[233/255,150/255,122/255],darkseagreen:[143/255,188/255,143/255],darkslateblue:[72/255,61/255,139/255],darkslategray:[47/255,79/255,79/255],darkslategrey:[47/255,79/255,79/255],darkturquoise:[0/255,206/255,209/255],darkviolet:[148/255,0/255,211/255],deeppink:[255/255,20/255,147/255],deepskyblue:[0/255,191/255,255/255],dimgray:[105/255,105/255,105/255],dimgrey:[105/255,105/255,105/255],dodgerblue:[30/255,144/255,255/255],firebrick:[178/255,34/255,34/255],floralwhite:[255/255,250/255,240/255],forestgreen:[34/255,139/255,34/255],gainsboro:[220/255,220/255,220/255],ghostwhite:[248/255,248/255,255/255],gold:[255/255,215/255,0/255],goldenrod:[218/255,165/255,32/255],greenyellow:[173/255,255/255,47/255],grey:[128/255,128/255,128/255],honeydew:[240/255,255/255,240/255],hotpink:[255/255,105/255,180/255],indianred:[205/255,92/255,92/255],indigo:[75/255,0/255,130/255],ivory:[255/255,255/255,240/255],khaki:[240/255,230/255,140/255],lavender:[230/255,230/255,250/255],lavenderblush:[255/255,240/255,245/255],lawngreen:[124/255,252/255,0/255],lemonchiffon:[255/255,250/255,205/255],lightblue:[173/255,216/255,230/255],lightcoral:[240/255,128/255,128/255],lightcyan:[224/255,255/255,255/255],lightgoldenrodyellow:[250/255,250/255,210/255],lightgray:[211/255,211/255,211/255],lightgreen:[144/255,238/255,144/255],lightgrey:[211/255,211/255,211/255],lightpink:[255/255,182/255,193/255],lightsalmon:[255/255,160/255,122/255],lightseagreen:[32/255,178/255,170/255],lightskyblue:[135/255,206/255,250/255],lightslategray:[119/255,136/255,153/255],lightslategrey:[119/255,136/255,153/255],lightsteelblue:[176/255,196/255,222/255],lightyellow:[255/255,255/255,224/255],limegreen:[50/255,205/255,50/255],linen:[250/255,240/255,230/255],magenta:[255/255,0/255,255/255],mediumaquamarine:[102/255,205/255,170/255],mediumblue:[0/255,0/255,205/255],mediumorchid:[186/255,85/255,211/255],mediumpurple:[147/255,112/255,219/255],mediumseagreen:[60/255,179/255,113/255],mediumslateblue:[123/255,104/255,238/255],mediumspringgreen:[0/255,250/255,154/255],mediumturquoise:[72/255,209/255,204/255],mediumvioletred:[199/255,21/255,133/255],midnightblue:[25/255,25/255,112/255],mintcream:[245/255,255/255,250/255],mistyrose:[255/255,228/255,225/255],moccasin:[255/255,228/255,181/255],navajowhite:[255/255,222/255,173/255],oldlace:[253/255,245/255,230/255],olivedrab:[107/255,142/255,35/255],orange:[255/255,165/255,0/255],orangered:[255/255,69/255,0/255],orchid:[218/255,112/255,214/255],palegoldenrod:[238/255,232/255,170/255],palegreen:[152/255,251/255,152/255],paleturquoise:[175/255,238/255,238/255],palevioletred:[219/255,112/255,147/255],papayawhip:[255/255,239/255,213/255],peachpuff:[255/255,218/255,185/255],peru:[205/255,133/255,63/255],pink:[255/255,192/255,203/255],plum:[221/255,160/255,221/255],powderblue:[176/255,224/255,230/255],rosybrown:[188/255,143/255,143/255],royalblue:[65/255,105/255,225/255],saddlebrown:[139/255,69/255,19/255],salmon:[250/255,128/255,114/255],sandybrown:[244/255,164/255,96/255],seagreen:[46/255,139/255,87/255],seashell:[255/255,245/255,238/255],sienna:[160/255,82/255,45/255],skyblue:[135/255,206/255,235/255],slateblue:[106/255,90/255,205/255],slategray:[112/255,128/255,144/255],slategrey:[112/255,128/255,144/255],snow:[255/255,250/255,250/255],springgreen:[0/255,255/255,127/255],steelblue:[70/255,130/255,180/255],tan:[210/255,180/255,140/255],thistle:[216/255,191/255,216/255],tomato:[255/255,99/255,71/255],turquoise:[64/255,224/255,208/255],violet:[238/255,130/255,238/255],wheat:[245/255,222/255,179/255],whitesmoke:[245/255,245/255,245/255],yellowgreen:[154/255,205/255,50/255]};var vv=uP;const dP=vv,hP=e=>dP[e.toLowerCase()];var mP=hP;const vP=e=>{if(e=e.replace("#",""),e.length<6)throw new Error("the given notation must contain 3 or more hex values");const t=parseInt(e.substring(0,2),16)/255,n=parseInt(e.substring(2,4),16)/255,r=parseInt(e.substring(4,6),16)/255;if(e.length>=8){const s=parseInt(e.substring(6,8),16)/255;return[t,n,r,s]}return[t,n,r]};var pP=vP;const gP=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e);var pv=gP;const yP=Ze,Rl=pv,bP=(...e)=>{if(e=yP(e),e.length<3)throw new Error("values must contain H, S and L values");const t=e[0],n=e[1],r=e[2];let s=r,o=r,i=r;if(n!==0){const a=r<.5?r*(1+n):r+n-r*n,c=2*r-a;s=Rl(c,a,t+1/3),o=Rl(c,a,t),i=Rl(c,a,t-1/3)}if(e.length>3){const a=e[3];return[s,o,i,a]}return[s,o,i]};var _P=bP;const wP=Ze,$P=(...e)=>{if(e=wP(e),e.length<3)throw new Error("values must contain H, S and V values");const t=e[0],n=e[1],r=e[2];let s=0,o=0,i=0;const a=Math.floor(t*6),c=t*6-a,l=r*(1-n),u=r*(1-c*n),d=r*(1-(1-c)*n);switch(a%6){case 0:s=r,o=d,i=l;break;case 1:s=u,o=r,i=l;break;case 2:s=l,o=r,i=d;break;case 3:s=l,o=u,i=r;break;case 4:s=d,o=l,i=r;break;case 5:s=r,o=l,i=u;break}if(e.length>3){const h=e[3];return[s,o,i,h]}return[s,o,i]};var EP=$P;const xP=Ze,AP=(...e)=>{if(e=xP(e),e.length<3)throw new Error("values must contain R, G and B values");const t=e[0]*255,n=e[1]*255,r=e[2]*255;let s=`#${Number(16777216+t*65536+n*256+r).toString(16).substring(1,7)}`;return e.length>3&&(s=s+Number(e[3]*255).toString(16)),s};var TP=AP;const SP=Ze,PP=(...e)=>{if(e=SP(e),e.length<3)throw new Error("values must contain R, G and B values");const t=e[0],n=e[1],r=e[2],s=Math.max(t,n,r),o=Math.min(t,n,r);let i,a;const c=(s+o)/2;if(s===o)i=a=0;else{const l=s-o;switch(a=c>.5?l/(2-s-o):l/(s+o),s){case t:i=(n-r)/l+(n<r?6:0);break;case n:i=(r-t)/l+2;break;case r:i=(t-n)/l+4;break}i/=6}if(e.length>3){const l=e[3];return[i,a,c,l]}return[i,a,c]};var OP=PP;const CP=Ze,MP=(...e)=>{if(e=CP(e),e.length<3)throw new Error("values must contain R, G and B values");const t=e[0],n=e[1],r=e[2],s=Math.max(t,n,r),o=Math.min(t,n,r);let i;const a=s,c=s-o,l=s===0?0:c/s;if(s===o)i=0;else{switch(s){case t:i=(n-r)/c+(n<r?6:0);break;case n:i=(r-t)/c+2;break;case r:i=(t-n)/c+4;break}i/=6}if(e.length>3){const u=e[3];return[i,l,a,u]}return[i,l,a]};var LP=MP,kP={colorize:fP,colorNameToRgb:mP,cssColors:vv,hexToRgb:pP,hslToRgb:_P,hsvToRgb:EP,hueToColorComponent:pv,rgbToHex:TP,rgbToHsl:OP,rgbToHsv:LP};const RP=e=>{if(!Array.isArray(e))throw new Error("Bezier points must be a valid array/");if(e.length<2)throw new Error("Bezier points must contain at least 2 values.");const t=FP(e);return{points:e,pointType:t,dimensions:t==="float_single"?0:e[0].length,permutations:qd(e.length-1),tangentPermutations:qd(e.length-2)}},FP=function(e){let t=null;return e.forEach(n=>{let r="";if(Number.isFinite(n))r="float_single";else if(Array.isArray(n))n.forEach(s=>{if(!Number.isFinite(s))throw new Error("Bezier point values must all be numbers.")}),r="float_"+n.length;else throw new Error("Bezier points must all be numbers or arrays of number.");if(t==null)t=r;else if(t!==r)throw new Error("Bezier points must be either all numbers or all arrays of numbers of the same size.")}),t},qd=function(e){const t=[];for(let n=0;n<=e;n++)t.push(Fl(e)/(Fl(n)*Fl(e-n)));return t},Fl=function(e){let t=1;for(let n=2;n<=e;n++)t*=n;return t};var GP=RP;const NP=(e,t)=>{if(e<0||e>1)throw new Error("Bezier valueAt() input must be between 0 and 1");if(t.pointType==="float_single")return Xd(t,t.points,e);{const n=[];for(let r=0;r<t.dimensions;r++){const s=[];for(let o=0;o<t.points.length;o++)s.push(t.points[o][r]);n.push(Xd(t,s,e))}return n}},Xd=function(e,t,n){const r=t.length-1;let s=0;for(let o=0;o<=r;o++)s+=e.permutations[o]*Math.pow(1-n,r-o)*Math.pow(n,o)*t[o];return s};var gv=NP;const DP=(e,t)=>{if(e<0||e>1)throw new Error("Bezier tangentAt() input must be between 0 and 1");if(t.pointType==="float_single")return jd(t,t.points,e);{const n=[];for(let r=0;r<t.dimensions;r++){const s=[];for(let o=0;o<t.points.length;o++)s.push(t.points[o][r]);n.push(jd(t,s,e))}return n}},jd=function(e,t,n){const r=t.length-1;let s=0;for(let o=0;o<r;o++){const i=r*(t[o+1]-t[o]);s+=e.tangentPermutations[o]*Math.pow(1-n,r-1-o)*Math.pow(n,o)*i}return s};var BP=DP;const Hd=gv,IP=(e,t)=>{let n=0;const r=[0];let s=Hd(0,t);for(let o=1;o<=e;o++){const i=Hd(o/e,t);n+=VP(i,s),r.push(n),s=i}return r},VP=(e,t)=>{if(Number.isFinite(e)&&Number.isFinite(t))return Math.abs(e-t);if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)throw new Error("The operands must have the same number of dimensions.");let n=0;for(let r=0;r<e.length;r++)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)}else throw new Error("The operands must be of the same type, either number or array.")};var qf=IP;const zP=qf,UP=(e,t)=>zP(e,t)[e];var qP=UP;const XP=qf,jP=(e,t)=>{const n={distance:0,segments:100},{distance:r,segments:s}=Object.assign({},n,e),o=XP(s,t);let i=0,a=s;for(;i<=a;){const m=Math.floor(i+(a-i)/2),w=o[m]-r;if(w<0)i=m+1;else if(w>0)a=m-1;else{a=m;break}}const c=a;if(o[c]===r)return c/s;const l=o[c],d=o[c+1]-l,h=(r-l)/d;return(c+h)/s};var HP=jP,YP={create:GP,valueAt:gv,tangentAt:BP,lengths:qf,length:qP,arcLengthToT:HP},WP={bezier:YP};const ZP=e=>{let t=0;for(let n=0;n<e.length;n++){const r=(n+1)%e.length;t+=e[n][0]*e[r][1],t-=e[r][0]*e[n][1]}return t/2};var Wa=ZP;const QP=Wa,KP=e=>QP(e.vertices);var yv=KP;const JP=e=>((e===void 0||e.length<3)&&(e=[]),{vertices:e});var bv=JP;const eO=bv,tO=e=>{const t=e.vertices.slice().reverse();return eO(t)};var _v=tO;const nO=yv,rO=_v,sO=(e,t)=>{if(e.length===0)return 0;const n=t.vertices;return n.length<3?0:(nO(t)<0&&(t=rO(t)),e.reduce((s,o)=>s+oO(o,n),0)===e.length?1:0)},oO=(e,t)=>{const n=t.length,r=e[0],s=e[1];let o=t[n-1],i=t[0],a=o[1]>s,c=0,l=0;for(let u=n+1;--u;){const d=i[1]>s;if(a!==d){const h=o[0]>r,m=i[0]>r;(h&&m||i[0]-(i[1]-s)*(o[0]-i[0])/(o[1]-i[1])>=r)&&(c=!c)}a=d,o=i,i=t[++l]}return c};var iO=sO,Xf={arePointsInside:iO,create:bv,flip:_v,measureArea:yv},jf={geom2:Je,geom3:et,path2:pt,poly2:Xf,poly3:ct};const aO=()=>[0,1,0];var Hf=aO;const cO=Hf,lO=e=>{const t=cO();return t[0]=e[0],t[1]=e[1],t[2]=e[2],t};var fO=lO;const Gl=st,uO=e=>{const t=Gl.normal(Gl.create(),e);return Gl.negate(t,t),t};var Yf=uO;const Yd=st,dO=e=>Yd.scale(Yd.create(),e,e[2]);var Za=dO;const Po=st,hO=Yf,mO=Za,vO=(e,t)=>{const n=mO(e),r=hO(e),s=Po.subtract(Po.create(),t,n),o=Po.dot(s,r);return Po.scale(s,r,o),Po.add(s,s,n),s};var pO=vO;const gO=(e,t)=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e);var wv=gO;const yO=st,bO=(e,t)=>{let n=yO.dot(t,e);return n=Math.abs(n-e[2]),n};var _O=bO;const wO=(e,t)=>e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2];var $O=wO;const Oo=st,EO=(e,t,n)=>{const r=Oo.subtract(Oo.create(),n,t);Oo.normal(r,r),Oo.normalize(r,r);const s=Oo.dot(t,r);return e[0]=r[0],e[1]=r[1],e[2]=s,e};var $v=EO;const xO=Hf,AO=(e,t,n)=>{const r=xO();return r[0]=e,r[1]=t,r[2]=n,r};var Ev=AO;const{NEPS:Nl}=at,TO=(e,t)=>Math.abs(e[0]-t[0])<=Nl&&Math.abs(e[1]-t[1])<=Nl&&Math.abs(e[2]-t[2])<=Nl;var Wf=TO;const SO=(e,t,n)=>{let r=n-e[1],s=t[1]-e[1];s<0&&(r=-r,s=-s);let o;return r<=0?o=0:r>=s?o=1:s<1e-10?o=.5:o=r/s,e[0]+o*(t[0]-e[0])};var xv=SO;const PO=(e,t,n,r)=>{if(e[0]===t[0]&&e[1]===t[1]||n[0]===r[0]&&n[1]===r[1])return;const s=(r[1]-n[1])*(t[0]-e[0])-(r[0]-n[0])*(t[1]-e[1]);if(Math.abs(s)<Number.MIN_VALUE)return;const o=((r[0]-n[0])*(e[1]-n[1])-(r[1]-n[1])*(e[0]-n[0]))/s,i=((t[0]-e[0])*(e[1]-n[1])-(t[1]-e[1])*(e[0]-n[0]))/s;if(o<0||o>1||i<0||i>1)return;const a=e[0]+o*(t[0]-e[0]),c=e[1]+o*(t[1]-e[1]);return[a,c]};var Av=PO;const OO=(e,t,n,r,s,o)=>{const a=1/(e*r-t*n);let c=s*r-t*o,l=-s*n+e*o;return c*=a,l*=a,[c,l]};var CO=OO,ti={aboutEqualNormals:Wf,area:Wa,cos:sn.cos,interpolateBetween2DPointsForY:xv,intersect:Av,sin:sn.sin,solve2Linear:CO};const MO=st,{solve2Linear:LO}=ti,kO=(e,t)=>{const n=LO(e[0],e[1],t[0],t[1],e[2],t[2]);return MO.clone(n)};var RO=kO;const Wd=st,FO=wv,GO=Ev,NO=(e,t)=>{const n=Wd.negate(Wd.create(),t),r=-t[2];return FO(e,GO(n[0],n[1],r))};var DO=NO;const BO=e=>`line2: (${e[0].toFixed(7)}, ${e[1].toFixed(7)}, ${e[2].toFixed(7)})`;var IO=BO;const Zd=st,VO=$v,zO=Za,UO=Yf,qO=(e,t,n)=>{const r=zO(t),s=UO(t);return Zd.transform(r,r,n),Zd.transform(s,s,n),VO(e,r,s)};var XO=qO;const jO=Za,HO=(e,t)=>{let n=(e[2]-e[1]*t)/e[0];return Number.isNaN(n)&&(n=jO(e)[0]),n};var YO=HO,Zf={clone:fO,closestPoint:pO,copy:wv,create:Hf,direction:Yf,distanceToPoint:_O,equals:$O,fromPoints:$v,fromValues:Ev,intersectPointOfLines:RO,origin:Za,reverse:DO,toString:IO,transform:XO,xAtY:YO};const Qd=Ue,WO=()=>[Qd.fromValues(0,0,0),Qd.fromValues(0,0,1)];var Tv=WO;const Kd=Ue,ZO=Tv,QO=e=>{const t=ZO();return Kd.copy(t[0],e[0]),Kd.copy(t[1],e[1]),t};var KO=QO;const Hr=Ue,JO=(e,t)=>{const n=e[0],r=e[1],s=Hr.dot(Hr.subtract(Hr.create(),t,n),r),o=Hr.dot(r,r),i=s/o,a=Hr.scale(Hr.create(),r,i);return Hr.add(a,a,n),a};var Sv=JO;const Jd=Ue,eC=(e,t)=>(Jd.copy(e[0],t[0]),Jd.copy(e[1],t[1]),e);var tC=eC;const nC=e=>e[1];var rC=nC;const Dl=Ue,sC=Sv,oC=(e,t)=>{const n=sC(e,t),r=Dl.subtract(Dl.create(),t,n);return Dl.length(r)};var iC=oC;const e0=Ue,aC=(e,t)=>!(!e0.equals(e[1],t[1])||!e0.equals(e[0],t[0]));var cC=aC;const ca=Ue,lC=(e,t,n)=>{const r=ca.normalize(ca.create(),n);return ca.copy(e[0],t),ca.copy(e[1],r),e};var ni=lC;const Yr=Ue,{solve2Linear:Bl}=ti,{EPS:fC}=at,uC=ni,dC=(e,t,n)=>{let r=Yr.cross(Yr.create(),t,n),s=Yr.length(r);if(s<fC)throw new Error("parallel planes do not intersect");s=1/s,r=Yr.scale(r,r,s);const o=Math.abs(r[0]),i=Math.abs(r[1]),a=Math.abs(r[2]);let c,l;return o>=i&&o>=a?(l=Bl(t[1],t[2],n[1],n[2],t[3],n[3]),c=Yr.fromValues(0,l[0],l[1])):i>=o&&i>=a?(l=Bl(t[0],t[2],n[0],n[2],t[3],n[3]),c=Yr.fromValues(l[0],0,l[1])):(l=Bl(t[0],t[1],n[0],n[1],t[3],n[3]),c=Yr.fromValues(l[0],l[1],0)),uC(e,c,r)};var hC=dC;const t0=Ue,mC=ni,vC=(e,t,n)=>{const r=t0.subtract(t0.create(),n,t);return mC(e,t,r)};var pC=vC;const Ss=Ue,gC=(e,t)=>{const n=t,r=t[3],s=e[0],o=e[1],i=(r-Ss.dot(n,s))/Ss.dot(n,o);return Ss.add(Ss.create(),s,Ss.scale(Ss.create(),o,i))};var yC=gC;const bC=e=>e[0];var _C=bC;const Il=Ue,wC=ni,$C=(e,t)=>{const n=Il.clone(t[0]),r=Il.negate(Il.create(),t[1]);return wC(e,n,r)};var EC=$C;const xC=e=>{const t=e[0],n=e[1];return`line3: point: (${t[0].toFixed(7)}, ${t[1].toFixed(7)}, ${t[2].toFixed(7)}) direction: (${n[0].toFixed(7)}, ${n[1].toFixed(7)}, ${n[2].toFixed(7)})`};var AC=xC;const Ps=Ue,TC=ni,SC=(e,t,n)=>{const r=t[0],s=t[1],o=Ps.add(Ps.create(),r,s),i=Ps.transform(Ps.create(),r,n),a=Ps.transform(o,o,n),c=Ps.subtract(a,a,i);return TC(e,i,c)};var PC=SC,OC={clone:KO,closestPoint:Sv,copy:tC,create:Tv,direction:rC,distanceToPoint:iC,equals:cC,fromPlanes:hC,fromPointAndDirection:ni,fromPoints:pC,intersectPointOfLineAndPlane:yC,origin:_C,reverse:EC,toString:AC,transform:PC},CC={constants:at,line2:Zf,line3:OC,mat4:wt,plane:nr,utils:ti,vec2:st,vec3:Ue,vec4:ov};const MC=Ze,Pv=Je,Ov=et,LC=pt,kC=ct,ka=new WeakMap,RC=()=>0,FC=e=>{let t=ka.get(e);return t||(t=Pv.toSides(e).reduce((r,s)=>r+(s[0][0]*s[1][1]-s[0][1]*s[1][0]),0),t*=.5,ka.set(e,t),t)},GC=e=>{let t=ka.get(e);return t||(t=Ov.toPolygons(e).reduce((r,s)=>r+kC.measureArea(s),0),ka.set(e,t),t)},NC=(...e)=>{if(e=MC(e),e.length===0)throw new Error("wrong number of arguments");const t=e.map(n=>LC.isA(n)?RC():Pv.isA(n)?FC(n):Ov.isA(n)?GC(n):0);return t.length===1?t[0]:t};var Cv=NC;const DC=Ze,BC=Cv,IC=(...e)=>{if(e=DC(e),e.length===0)throw new Error("measureAggregateArea: no geometries supplied");const t=BC(e);if(e.length===1)return t;const n=0;return t.reduce((r,s)=>r+s,n)};var VC=IC;const zC=Ze,tr=st,Co=Ue,Mv=Je,Lv=et,kv=pt,n0=ct,zs=new WeakMap,UC=e=>{let t=zs.get(e);if(t)return t;const n=kv.toPoints(e);let r;n.length===0?r=tr.create():r=tr.clone(n[0]);let s=tr.clone(r);return n.forEach(o=>{tr.min(r,r,o),tr.max(s,s,o)}),r=[r[0],r[1],0],s=[s[0],s[1],0],t=[r,s],zs.set(e,t),t},qC=e=>{let t=zs.get(e);if(t)return t;const n=Mv.toPoints(e);let r;n.length===0?r=tr.create():r=tr.clone(n[0]);let s=tr.clone(r);return n.forEach(o=>{tr.min(r,r,o),tr.max(s,s,o)}),r=[r[0],r[1],0],s=[s[0],s[1],0],t=[r,s],zs.set(e,t),t},XC=e=>{let t=zs.get(e);if(t)return t;const n=Lv.toPolygons(e);let r=Co.create();if(n.length>0){const o=n0.toPoints(n[0]);Co.copy(r,o[0])}let s=Co.clone(r);return n.forEach(o=>{n0.toPoints(o).forEach(i=>{Co.min(r,r,i),Co.max(s,s,i)})}),r=[r[0],r[1],r[2]],s=[s[0],s[1],s[2]],t=[r,s],zs.set(e,t),t},jC=(...e)=>{if(e=zC(e),e.length===0)throw new Error("wrong number of arguments");const t=e.map(n=>kv.isA(n)?UC(n):Mv.isA(n)?qC(n):Lv.isA(n)?XC(n):[[0,0,0],[0,0,0]]);return t.length===1?t[0]:t};var ss=jC;const HC=Ze,YC=Im,WC=Bm,ZC=ss,QC=(...e)=>{if(e=HC(e),e.length===0)throw new Error("measureAggregateBoundingBox: no geometries supplied");const t=ZC(e);if(e.length===1)return t;const n=[[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE]];return t.reduce((r,s)=>(r=[YC(r[0],r[0],s[0]),WC(r[1],r[1],s[1])],r),n)};var Qf=QC;const{EPS:KC}=at,JC=(e,t)=>{let n=0;for(let r=0;r<t;r++)n+=e[1][r]-e[0][r];return KC*n/t};var Rv=JC;const e8=Ze,t8=Qf,n8=Rv,{geom2:r8,geom3:s8,path2:o8}=jf,i8=(...e)=>{if(e=e8(e),e.length===0)throw new Error("measureAggregateEpsilon: no geometries supplied");const t=t8(e);let n=0;return n=e.reduce((r,s)=>o8.isA(s)||r8.isA(s)?Math.max(r,2):s8.isA(s)?Math.max(r,3):0,n),n8(t,n)};var a8=i8;const c8=Ze,l8=Je,Fv=et,f8=pt,u8=ct,r0=new WeakMap,d8=()=>0,h8=()=>0,m8=e=>{let t=r0.get(e);return t||(t=Fv.toPolygons(e).reduce((r,s)=>r+u8.measureSignedVolume(s),0),r0.set(e,t),t)},v8=(...e)=>{if(e=c8(e),e.length===0)throw new Error("wrong number of arguments");const t=e.map(n=>f8.isA(n)?d8():l8.isA(n)?h8():Fv.isA(n)?m8(n):0);return t.length===1?t[0]:t};var Gv=v8;const p8=Ze,g8=Gv,y8=(...e)=>{if(e=p8(e),e.length===0)throw new Error("measureAggregateVolume: no geometries supplied");const t=g8(e);if(e.length===1)return t;const n=0;return t.reduce((r,s)=>r+s,n)};var b8=y8;const _8=Ze,Nv=st,_n=Ue,Dv=Je,Bv=et,Iv=pt,s0=ct,Us=new WeakMap,w8=e=>{let t=Us.get(e);if(t!==void 0)return t;const n=_n.create();let r=0;const s=Iv.toPoints(e);if(s.length>0){let o=0;const i=_n.create();s.forEach(a=>{_n.add(n,n,_n.fromVec2(i,a,0)),o++}),_n.scale(n,n,1/o),s.forEach(a=>{r=Math.max(r,Nv.squaredDistance(n,a))}),r=Math.sqrt(r)}return t=[n,r],Us.set(e,t),t},$8=e=>{let t=Us.get(e);if(t!==void 0)return t;const n=_n.create();let r=0;const s=Dv.toSides(e);if(s.length>0){let o=0;const i=_n.create();s.forEach(a=>{_n.add(n,n,_n.fromVec2(i,a[0],0)),o++}),_n.scale(n,n,1/o),s.forEach(a=>{r=Math.max(r,Nv.squaredDistance(n,a[0]))}),r=Math.sqrt(r)}return t=[n,r],Us.set(e,t),t},E8=e=>{let t=Us.get(e);if(t!==void 0)return t;const n=_n.create();let r=0;const s=Bv.toPolygons(e);if(s.length>0){let o=0;s.forEach(i=>{s0.toPoints(i).forEach(a=>{_n.add(n,n,a),o++})}),_n.scale(n,n,1/o),s.forEach(i=>{s0.toPoints(i).forEach(a=>{r=Math.max(r,_n.squaredDistance(n,a))})}),r=Math.sqrt(r)}return t=[n,r],Us.set(e,t),t},x8=(...e)=>{e=_8(e);const t=e.map(n=>Iv.isA(n)?w8(n):Dv.isA(n)?$8(n):Bv.isA(n)?E8(n):[[0,0,0],0]);return t.length===1?t[0]:t};var A8=x8;const T8=Ze,S8=ss,P8=(...e)=>{e=T8(e);const t=e.map(n=>{const r=S8(n);return[r[0][0]+(r[1][0]-r[0][0])/2,r[0][1]+(r[1][1]-r[0][1])/2,r[0][2]+(r[1][2]-r[0][2])/2]});return t.length===1?t[0]:t};var O8=P8;const C8=Ze,Jn=Ue,Vv=Je,zv=et,Ra=new WeakMap,M8=e=>{let t=Ra.get(e);if(t!==void 0)return t;const n=Vv.toSides(e);let r=0,s=0,o=0;if(n.length>0){for(let a=0;a<n.length;a++){const c=n[a][0],l=n[a][1],u=c[0]*l[1]-c[1]*l[0];r+=u,s+=(c[0]+l[0])*u,o+=(c[1]+l[1])*u}r/=2;const i=1/(r*6);s*=i,o*=i}return t=Jn.fromValues(s,o,0),Ra.set(e,t),t},L8=e=>{let t=Ra.get(e);if(t!==void 0)return t;t=Jn.create();const n=zv.toPolygons(e);if(n.length===0)return t;let r=0;const s=Jn.create();return n.forEach(o=>{const i=o.vertices;for(let a=0;a<i.length-2;a++){Jn.cross(s,i[a+1],i[a+2]);const c=Jn.dot(i[0],s)/6;r+=c,Jn.add(s,i[0],i[a+1]),Jn.add(s,s,i[a+2]);const l=Jn.scale(s,s,1/4*c);Jn.add(t,t,l)}}),Jn.scale(t,t,1/r),Ra.set(e,t),t},k8=(...e)=>{e=C8(e);const t=e.map(n=>Vv.isA(n)?M8(n):zv.isA(n)?L8(n):[0,0,0]);return t.length===1?t[0]:t};var R8=k8;const F8=Ze,G8=ss,N8=(...e)=>{e=F8(e);const t=e.map(n=>{const r=G8(n);return[r[1][0]-r[0][0],r[1][1]-r[0][1],r[1][2]-r[0][2]]});return t.length===1?t[0]:t};var D8=N8;const B8=Ze,{geom2:I8,geom3:V8,path2:z8}=jf,Kf=Rv,Jf=ss,U8=e=>Kf(Jf(e),2),q8=e=>Kf(Jf(e),2),X8=e=>Kf(Jf(e),3),j8=(...e)=>{if(e=B8(e),e.length===0)throw new Error("wrong number of arguments");const t=e.map(n=>z8.isA(n)?U8(n):I8.isA(n)?q8(n):V8.isA(n)?X8(n):0);return t.length===1?t[0]:t};var Or=j8,H8={measureAggregateArea:VC,measureAggregateBoundingBox:Qf,measureAggregateEpsilon:a8,measureAggregateVolume:b8,measureArea:Cv,measureBoundingBox:ss,measureBoundingSphere:A8,measureCenter:O8,measureCenterOfMass:R8,measureDimensions:D8,measureEpsilon:Or,measureVolume:Gv};const Y8=(e,t)=>Array.isArray(e)&&e.length>=t?e.every(n=>Number.isFinite(n)):!1,W8=(e,t)=>Number.isFinite(e)&&e>t,Z8=(e,t)=>Number.isFinite(e)&&e>=t;var Yt={isNumberArray:Y8,isGT:W8,isGTE:Z8};const{EPS:o0,TAU:Os}=at,cr=st,Q8=pt,{isGT:K8,isGTE:Vl,isNumberArray:J8}=Yt,eM=e=>{const t={center:[0,0],radius:1,startAngle:0,endAngle:Os,makeTangent:!1,segments:32};let{center:n,radius:r,startAngle:s,endAngle:o,makeTangent:i,segments:a}=Object.assign({},t,e);if(!J8(n,2))throw new Error("center must be an array of X and Y values");if(!K8(r,0))throw new Error("radius must be greater than zero");if(!Vl(s,0))throw new Error("startAngle must be positive");if(!Vl(o,0))throw new Error("endAngle must be positive");if(!Vl(a,4))throw new Error("segments must be four or more");s=s%Os,o=o%Os;let c=Os;s<o&&(c=o-s),s>o&&(c=o+(Os-s));const l=Math.acos((r*r+r*r-o0*o0)/(2*r*r)),u=cr.clone(n);let d;const h=[];if(c<l)d=cr.fromAngleRadians(cr.create(),s),cr.scale(d,d,r),cr.add(d,d,u),h.push(d);else{const m=Math.max(1,Math.floor(a*(c/Os)))+1;let w=m*.5/c;w>.25&&(w=.25);const p=i?m+2:m;for(let y=0;y<=p;y++){let P=y;i&&(P=(y-1)*(m-2*w)/m+w,P<0&&(P=0),P>m&&(P=m));const F=s+P*(c/m);d=cr.fromAngleRadians(cr.create(),F),cr.scale(d,d,r),cr.add(d,d,u),h.push(d)}}return Q8.fromPoints({closed:!1},h)};var tM=eM;const{EPS:i0,TAU:Er}=at,zl=st,a0=Je,{sin:nM,cos:rM}=sn,{isGTE:Ul,isNumberArray:c0}=Yt,sM=e=>{const t={center:[0,0],radius:[1,1],startAngle:0,endAngle:Er,segments:32};let{center:n,radius:r,startAngle:s,endAngle:o,segments:i}=Object.assign({},t,e);if(!c0(n,2))throw new Error("center must be an array of X and Y values");if(!c0(r,2))throw new Error("radius must be an array of X and Y values");if(!r.every(m=>m>=0))throw new Error("radius values must be positive");if(!Ul(s,0))throw new Error("startAngle must be positive");if(!Ul(o,0))throw new Error("endAngle must be positive");if(!Ul(i,3))throw new Error("segments must be three or more");if(r[0]===0||r[1]===0)return a0.create();s=s%Er,o=o%Er;let a=Er;s<o&&(a=o-s),s>o&&(a=o+(Er-s));const c=Math.min(r[0],r[1]),l=Math.acos((c*c+c*c-i0*i0)/(2*c*c));if(a<l)throw new Error("startAngle and endAngle do not define a significant rotation");i=Math.floor(i*(a/Er));const u=zl.clone(n),d=a/i,h=[];i=a<Er?i+1:i;for(let m=0;m<i;m++){const w=d*m+s,p=zl.fromValues(r[0]*rM(w),r[1]*nM(w));zl.add(p,u,p),h.push(p)}return a<Er&&h.push(u),a0.fromPoints(h)};var Uv=sM;const{TAU:oM}=at,iM=Uv,{isGTE:aM}=Yt,cM=e=>{const t={center:[0,0],radius:1,startAngle:0,endAngle:oM,segments:32};let{center:n,radius:r,startAngle:s,endAngle:o,segments:i}=Object.assign({},t,e);if(!aM(r,0))throw new Error("radius must be positive");return r=[r,r],iM({center:n,radius:r,startAngle:s,endAngle:o,segments:i})};var qv=cM;const l0=et,lM=ct,{isNumberArray:f0}=Yt,fM=e=>{const t={center:[0,0,0],size:[2,2,2]},{center:n,size:r}=Object.assign({},t,e);if(!f0(n,3))throw new Error("center must be an array of X, Y and Z values");if(!f0(r,3))throw new Error("size must be an array of width, depth and height values");if(!r.every(o=>o>=0))throw new Error("size values must be positive");return r[0]===0||r[1]===0||r[2]===0?l0.create():l0.create([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(o=>{const i=o[0].map(a=>[n[0]+r[0]/2*(2*!!(a&1)-1),n[1]+r[1]/2*(2*!!(a&2)-1),n[2]+r[2]/2*(2*!!(a&4)-1)]);return lM.create(i)}))};var eu=fM;const uM=eu,{isGTE:dM}=Yt,hM=e=>{const t={center:[0,0,0],size:2};let{center:n,size:r}=Object.assign({},t,e);if(!dM(r,0))throw new Error("size must be positive");return r=[r,r,r],uM({center:n,size:r})};var mM=hM;const{EPS:u0,TAU:xr}=at,Jt=Ue,vM=et,pM=ct,{sin:gM,cos:yM}=sn,{isGT:bM,isGTE:ql,isNumberArray:Xl}=Yt,_M=e=>{const t={center:[0,0,0],height:2,startRadius:[1,1],startAngle:0,endRadius:[1,1],endAngle:xr,segments:32};let{center:n,height:r,startRadius:s,startAngle:o,endRadius:i,endAngle:a,segments:c}=Object.assign({},t,e);if(!Xl(n,3))throw new Error("center must be an array of X, Y and Z values");if(!bM(r,0))throw new Error("height must be greater then zero");if(!Xl(s,2))throw new Error("startRadius must be an array of X and Y values");if(!s.every(se=>se>=0))throw new Error("startRadius values must be positive");if(!Xl(i,2))throw new Error("endRadius must be an array of X and Y values");if(!i.every(se=>se>=0))throw new Error("endRadius values must be positive");if(i.every(se=>se===0)&&s.every(se=>se===0))throw new Error("at least one radius must be positive");if(!ql(o,0))throw new Error("startAngle must be positive");if(!ql(a,0))throw new Error("endAngle must be positive");if(!ql(c,4))throw new Error("segments must be four or more");o=o%xr,a=a%xr;let l=xr;o<a&&(l=a-o),o>a&&(l=a+(xr-o));const u=Math.min(s[0],s[1],i[0],i[1]),d=Math.acos((u*u+u*u-u0*u0)/(2*u*u));if(l<d)throw new Error("startAngle and endAngle do not define a significant rotation");const h=Math.floor(c*(l/xr)),m=Jt.fromValues(0,0,-(r/2)),w=Jt.fromValues(0,0,r/2),p=Jt.subtract(Jt.create(),w,m),y=Jt.fromValues(1,0,0),P=Jt.fromValues(0,1,0),F=Jt.create(),L=Jt.create(),k=Jt.create(),T=(se,fe,ce)=>{const Oe=fe*l+o;return Jt.scale(F,y,ce[0]*yM(Oe)),Jt.scale(L,P,ce[1]*gM(Oe)),Jt.add(F,F,L),Jt.scale(k,p,se),Jt.add(k,k,m),Jt.add(Jt.create(),F,k)},R=(...se)=>{const fe=se.map(ce=>Jt.add(Jt.create(),ce,n));return pM.create(fe)},B=[];for(let se=0;se<h;se++){const fe=se/h;let ce=(se+1)/h;l===xr&&se===h-1&&(ce=0),i[0]===s[0]&&i[1]===s[1]?(B.push(R(m,T(0,ce,i),T(0,fe,i))),B.push(R(T(0,ce,i),T(1,ce,i),T(1,fe,i),T(0,fe,i))),B.push(R(w,T(1,fe,i),T(1,ce,i)))):(s[0]>0&&s[1]>0&&B.push(R(m,T(0,ce,s),T(0,fe,s))),(s[0]>0||s[1]>0)&&B.push(R(T(0,fe,s),T(0,ce,s),T(1,fe,i))),i[0]>0&&i[1]>0&&B.push(R(w,T(1,fe,i),T(1,ce,i))),(i[0]>0||i[1]>0)&&B.push(R(T(1,fe,i),T(0,ce,s),T(1,ce,i))))}return l<xr&&(B.push(R(m,T(0,0,s),w)),B.push(R(T(0,0,s),T(1,0,i),w)),B.push(R(m,w,T(0,1,s))),B.push(R(T(0,1,s),w,T(1,1,i)))),vM.create(B)};var Xv=_M;const wM=et,$M=Xv,{isGTE:EM}=Yt,xM=e=>{const t={center:[0,0,0],height:2,radius:1,segments:32},{center:n,height:r,radius:s,segments:o}=Object.assign({},t,e);if(!EM(s,0))throw new Error("radius must be positive");return r===0||s===0?wM.create():$M({center:n,height:r,startRadius:[s,s],endRadius:[s,s],segments:o})};var jv=xM;const{TAU:d0}=at,qe=Ue,h0=et,m0=ct,{sin:v0,cos:p0}=sn,{isGTE:AM,isNumberArray:g0}=Yt,TM=e=>{const t={center:[0,0,0],radius:[1,1,1],segments:32,axes:[[1,0,0],[0,-1,0],[0,0,1]]},{center:n,radius:r,segments:s,axes:o}=Object.assign({},t,e);if(!g0(n,3))throw new Error("center must be an array of X, Y and Z values");if(!g0(r,3))throw new Error("radius must be an array of X, Y and Z values");if(!r.every(w=>w>=0))throw new Error("radius values must be positive");if(!AM(s,4))throw new Error("segments must be four or more");if(r[0]===0||r[1]===0||r[2]===0)return h0.create();const i=qe.scale(qe.create(),qe.normalize(qe.create(),o[0]),r[0]),a=qe.scale(qe.create(),qe.normalize(qe.create(),o[1]),r[1]),c=qe.scale(qe.create(),qe.normalize(qe.create(),o[2]),r[2]),l=Math.round(s/4);let u;const d=[],h=qe.create(),m=qe.create();for(let w=0;w<=s;w++){const p=d0*w/s,y=qe.add(qe.create(),qe.scale(h,i,p0(p)),qe.scale(m,a,v0(p)));if(w>0){let P,F;for(let L=0;L<=l;L++){const k=d0/4*L/l,T=p0(k),R=v0(k);if(L>0){let B=[],W;W=qe.subtract(qe.create(),qe.scale(h,u,P),qe.scale(m,c,F)),B.push(qe.add(W,W,n)),W=qe.subtract(qe.create(),qe.scale(h,y,P),qe.scale(m,c,F)),B.push(qe.add(W,W,n)),L<l&&(W=qe.subtract(qe.create(),qe.scale(h,y,T),qe.scale(m,c,R)),B.push(qe.add(W,W,n))),W=qe.subtract(qe.create(),qe.scale(h,u,T),qe.scale(m,c,R)),B.push(qe.add(W,W,n)),d.push(m0.create(B)),B=[],W=qe.add(qe.create(),qe.scale(h,u,P),qe.scale(m,c,F)),B.push(qe.add(qe.create(),n,W)),W=qe.add(W,qe.scale(h,y,P),qe.scale(m,c,F)),B.push(qe.add(qe.create(),n,W)),L<l&&(W=qe.add(W,qe.scale(h,y,T),qe.scale(m,c,R)),B.push(qe.add(qe.create(),n,W))),W=qe.add(W,qe.scale(h,u,T),qe.scale(m,c,R)),B.push(qe.add(qe.create(),n,W)),B.reverse(),d.push(m0.create(B))}P=T,F=R}}u=y}return h0.create(d)};var Hv=TM;const SM=et,PM=ct,{isNumberArray:y0}=Yt,OM=e=>{const t={points:[],faces:[],colors:void 0,orientation:"outward"},{points:n,faces:r,colors:s,orientation:o}=Object.assign({},t,e);if(!(Array.isArray(n)&&Array.isArray(r)))throw new Error("points and faces must be arrays");if(n.length<3)throw new Error("three or more points are required");if(r.length<1)throw new Error("one or more faces are required");if(s){if(!Array.isArray(s))throw new Error("colors must be an array");if(s.length!==r.length)throw new Error("faces and colors must have the same length")}n.forEach((a,c)=>{if(!y0(a,3))throw new Error(`point ${c} must be an array of X, Y, Z values`)}),r.forEach((a,c)=>{if(a.length<3)throw new Error(`face ${c} must contain 3 or more indexes`);if(!y0(a,a.length))throw new Error(`face ${c} must be an array of numbers`)}),o!=="outward"&&r.forEach(a=>a.reverse());const i=r.map((a,c)=>{const l=PM.create(a.map(u=>n[u]));return s&&s[c]&&(l.color=s[c]),l});return SM.create(i)};var Yv=OM;const b0=wt,_0=Ue,w0=et,CM=Yv,{isGTE:$0}=Yt,MM=e=>{const t={radius:1,frequency:6};let{radius:n,frequency:r}=Object.assign({},t,e);if(!$0(n,0))throw new Error("radius must be positive");if(!$0(r,6))throw new Error("frequency must be six or more");if(n===0)return w0.create();r=Math.floor(r/6);const s=[[.850651,0,-.525731],[.850651,-0,.525731],[-.850651,-0,.525731],[-.850651,0,-.525731],[0,-.525731,.850651],[0,.525731,.850651],[0,.525731,-.850651],[0,-.525731,-.850651],[-.525731,-.850651,-0],[.525731,-.850651,-0],[.525731,.850651,0],[-.525731,.850651,0]],o=[[0,9,1],[1,10,0],[6,7,0],[10,6,0],[7,9,0],[5,1,4],[4,1,9],[5,10,1],[2,8,3],[3,11,2],[2,5,4],[4,8,2],[2,11,5],[3,7,6],[6,11,3],[8,7,3],[9,8,4],[11,10,5],[10,11,6],[8,9,7]],i=(h,m,w)=>{const p=h[0],y=h[1],P=h[2];let F=w;const L=[],k=[];for(let T=0;T<m;T++)for(let R=0;R<m-T;R++){const B=T/m,W=(T+1)/m,se=R/(m-T),fe=(R+1)/(m-T),ce=m-T-1?R/(m-T-1):1,Oe=[];Oe[0]=a(a(p,y,se),P,B),Oe[1]=a(a(p,y,fe),P,B),Oe[2]=a(a(p,y,ce),P,W);for(let De=0;De<3;De++){const we=_0.length(Oe[De]);for(let Xe=0;Xe<3;Xe++)Oe[De][Xe]/=we}if(L.push(Oe[0],Oe[1],Oe[2]),k.push([F,F+1,F+2]),F+=3,R<m-T-1){const De=m-T-1?(R+1)/(m-T-1):1;Oe[0]=a(a(p,y,fe),P,B),Oe[1]=a(a(p,y,De),P,W),Oe[2]=a(a(p,y,ce),P,W);for(let we=0;we<3;we++){const Xe=_0.length(Oe[we]);for(let Fe=0;Fe<3;Fe++)Oe[we][Fe]/=Xe}L.push(Oe[0],Oe[1],Oe[2]),k.push([F,F+1,F+2]),F+=3}}return{points:L,triangles:k,offset:F}},a=(h,m,w)=>{const p=1-w,y=[];for(let P=0;P<3;P++)y[P]=h[P]*p+m[P]*w;return y};let c=[],l=[],u=0;for(let h=0;h<o.length;h++){const m=i([s[o[h][0]],s[o[h][1]],s[o[h][2]]],r,u);c=c.concat(m.points),l=l.concat(m.triangles),u=m.offset}let d=CM({points:c,faces:l,orientation:"inward"});return n!==1&&(d=w0.transform(b0.fromScaling(b0.create(),[n,n,n]),d)),d};var LM=MM;const kM=pt,RM=e=>{if(!Array.isArray(e))throw new Error("points must be an array");return kM.fromPoints({},e)};var FM=RM;const jl=Je,GM=e=>{const t={points:[],paths:[]},{points:n,paths:r}=Object.assign({},t,e);if(!(Array.isArray(n)&&Array.isArray(r)))throw new Error("points and paths must be arrays");let s=n;Array.isArray(n[0])&&(Array.isArray(n[0][0])||(s=[n])),s.forEach((c,l)=>{if(!Array.isArray(c))throw new Error("list of points "+l+" must be an array");if(c.length<3)throw new Error("list of points "+l+" must contain three or more points");c.forEach((u,d)=>{if(!Array.isArray(u))throw new Error("list of points "+l+", point "+d+" must be an array");if(u.length<2)throw new Error("list of points "+l+", point "+d+" must contain by X and Y values")})});let o=r;if(r.length===0){let c=0;o=s.map(l=>l.map(u=>c++))}const i=[];s.forEach(c=>c.forEach(l=>i.push(l)));let a=[];return o.forEach(c=>{const l=c.map(d=>i[d]),u=jl.fromPoints(l);a=a.concat(jl.toSides(u))}),jl.create(a)};var NM=GM;const Ar=st,E0=Je,{isNumberArray:x0}=Yt,DM=e=>{const t={center:[0,0],size:[2,2]},{center:n,size:r}=Object.assign({},t,e);if(!x0(n,2))throw new Error("center must be an array of X and Y values");if(!x0(r,2))throw new Error("size must be an array of X and Y values");if(!r.every(a=>a>=0))throw new Error("size values must be positive");if(r[0]===0||r[1]===0)return E0.create();const s=[r[0]/2,r[1]/2],o=[s[0],-s[1]],i=[Ar.subtract(Ar.create(),n,s),Ar.add(Ar.create(),n,o),Ar.add(Ar.create(),n,s),Ar.subtract(Ar.create(),n,o)];return E0.fromPoints(i)};var tu=DM;const{EPS:Pa,TAU:Mo}=at,Hl=st,It=Ue,A0=et,qs=ct,{sin:BM,cos:IM}=sn,{isGTE:T0,isNumberArray:S0}=Yt,VM=eu,P0=(e,t,n,r,s,o)=>{const i=Mo/4*s/r,a=IM(i),c=BM(i),l=r-s;let u=n*a,d=t[2]-(n-n*c);o||(d=n-n*c-t[2]),u=u>Pa?u:0;const h=It.add(It.create(),e,[t[0]-n,t[1]-n,d]),m=It.add(It.create(),e,[n-t[0],t[1]-n,d]),w=It.add(It.create(),e,[n-t[0],n-t[1],d]),p=It.add(It.create(),e,[t[0]-n,n-t[1],d]),y=[],P=[],F=[],L=[];for(let k=0;k<=l;k++){const T=l>0?Mo/4*k/l:0,R=Hl.fromAngleRadians(Hl.create(),T);Hl.scale(R,R,u);const B=It.fromVec2(It.create(),R);y.push(It.add(It.create(),h,B)),It.rotateZ(B,B,[0,0,0],Mo/4),P.push(It.add(It.create(),m,B)),It.rotateZ(B,B,[0,0,0],Mo/4),F.push(It.add(It.create(),w,B)),It.rotateZ(B,B,[0,0,0],Mo/4),L.push(It.add(It.create(),p,B))}return o?[y,P,F,L]:(y.reverse(),P.reverse(),F.reverse(),L.reverse(),[L,F,P,y])},O0=(e,t)=>{const n=[];for(let r=0;r<e.length;r++){const s=e[r],o=t[r];for(let i=0;i<s.length-1;i++)n.push(qs.create([s[i],s[i+1],o[i]])),i<o.length-1&&n.push(qs.create([o[i],s[i+1],o[i+1]]))}return n},C0=(e,t)=>{const n=[];for(let r=0;r<e.length;r++){let s=e[r],o=t[r];const i=s[s.length-1],a=o[o.length-1],c=(r+1)%e.length;s=e[c],o=t[c];const l=s[0],u=o[0];n.push(qs.create([i,l,u,a]))}return n},zM=(e,t)=>{e=[e[3],e[2],e[1],e[0]],e=e.map(o=>o.slice().reverse());const n=[];e.forEach(o=>{o.forEach(i=>n.push(i))});const r=[];t.forEach(o=>{o.forEach(i=>r.push(i))});const s=[];for(let o=0;o<r.length;o++){const i=(o+1)%r.length;s.push(qs.create([n[o],n[i],r[i],r[o]]))}return s},UM=e=>{const t={center:[0,0,0],size:[2,2,2],roundRadius:.2,segments:32};let{center:n,size:r,roundRadius:s,segments:o}=Object.assign({},t,e);if(!S0(n,3))throw new Error("center must be an array of X, Y and Z values");if(!S0(r,3))throw new Error("size must be an array of X, Y and Z values");if(!r.every(l=>l>=0))throw new Error("size values must be positive");if(!T0(s,0))throw new Error("roundRadius must be positive");if(!T0(o,4))throw new Error("segments must be four or more");if(r[0]===0||r[1]===0||r[2]===0)return A0.create();if(s===0)return VM({center:n,size:r});if(r=r.map(l=>l/2),s>r[0]-Pa||s>r[1]-Pa||s>r[2]-Pa)throw new Error("roundRadius must be smaller then the radius of all dimensions");o=Math.floor(o/4);let i=null,a=null,c=[];for(let l=0;l<=o;l++){const u=P0(n,r,s,o,l,!0),d=P0(n,r,s,o,l,!1);if(l===0&&(c=c.concat(zM(d,u))),i&&(c=c.concat(O0(i,u),C0(i,u))),a&&(c=c.concat(O0(a,d),C0(a,d))),l===o){let h=u.map(m=>m[0]);c.push(qs.create(h)),h=d.map(m=>m[0]),c.push(qs.create(h))}i=u,a=d}return A0.create(c)};var qM=UM;const{EPS:XM,TAU:M0}=at,ke=Ue,L0=et,jM=ct,{sin:k0,cos:R0}=sn,{isGTE:la,isNumberArray:HM}=Yt,YM=jv,WM=e=>{const t={center:[0,0,0],height:2,radius:1,roundRadius:.2,segments:32},{center:n,height:r,radius:s,roundRadius:o,segments:i}=Object.assign({},t,e);if(!HM(n,3))throw new Error("center must be an array of X, Y and Z values");if(!la(r,0))throw new Error("height must be positive");if(!la(s,0))throw new Error("radius must be positive");if(!la(o,0))throw new Error("roundRadius must be positive");if(o>s)throw new Error("roundRadius must be smaller then the radius");if(!la(i,4))throw new Error("segments must be four or more");if(r===0||s===0)return L0.create();if(o===0)return YM({center:n,height:r,radius:s});const a=[0,0,-(r/2)],c=[0,0,r/2],l=ke.subtract(ke.create(),c,a),u=ke.length(l);if(2*o>u-XM)throw new Error("height must be larger than twice roundRadius");let d;Math.abs(l[0])>Math.abs(l[1])?d=ke.fromValues(0,1,0):d=ke.fromValues(1,0,0);const h=ke.scale(ke.create(),ke.normalize(ke.create(),l),o),m=ke.scale(ke.create(),ke.normalize(ke.create(),ke.cross(ke.create(),h,d)),s),w=ke.scale(ke.create(),ke.normalize(ke.create(),ke.cross(ke.create(),m,h)),s);ke.add(a,a,h),ke.subtract(c,c,h);const p=Math.floor(.25*i),y=R=>{const B=R.map(W=>ke.add(W,W,n));return jM.create(B)},P=[],F=ke.create(),L=ke.create();let k;for(let R=0;R<=i;R++){const B=M0*R/i,W=ke.add(ke.create(),ke.scale(F,m,R0(B)),ke.scale(L,w,k0(B)));if(R>0){let se=[];se.push(ke.add(ke.create(),a,W)),se.push(ke.add(ke.create(),a,k)),se.push(ke.add(ke.create(),c,k)),se.push(ke.add(ke.create(),c,W)),P.push(y(se));let fe,ce;for(let Oe=0;Oe<=p;Oe++){const De=M0/4*Oe/p,we=R0(De),Xe=k0(De);if(Oe>0){se=[];let Fe;Fe=ke.add(ke.create(),a,ke.subtract(F,ke.scale(F,k,fe),ke.scale(L,h,ce))),se.push(Fe),Fe=ke.add(ke.create(),a,ke.subtract(F,ke.scale(F,W,fe),ke.scale(L,h,ce))),se.push(Fe),Oe<p&&(Fe=ke.add(ke.create(),a,ke.subtract(F,ke.scale(F,W,we),ke.scale(L,h,Xe))),se.push(Fe)),Fe=ke.add(ke.create(),a,ke.subtract(F,ke.scale(F,k,we),ke.scale(L,h,Xe))),se.push(Fe),P.push(y(se)),se=[],Fe=ke.add(ke.create(),ke.scale(F,k,fe),ke.scale(L,h,ce)),ke.add(Fe,Fe,c),se.push(Fe),Fe=ke.add(ke.create(),ke.scale(F,W,fe),ke.scale(L,h,ce)),ke.add(Fe,Fe,c),se.push(Fe),Oe<p&&(Fe=ke.add(ke.create(),ke.scale(F,W,we),ke.scale(L,h,Xe)),ke.add(Fe,Fe,c),se.push(Fe)),Fe=ke.add(ke.create(),ke.scale(F,k,we),ke.scale(L,h,Xe)),ke.add(Fe,Fe,c),se.push(Fe),se.reverse(),P.push(y(se))}fe=we,ce=Xe}}k=W}return L0.create(P)};var ZM=WM;const{EPS:F0,TAU:fa}=at,Ot=st,G0=Je,{isGTE:N0,isNumberArray:D0}=Yt,QM=tu,KM=e=>{const t={center:[0,0],size:[2,2],roundRadius:.2,segments:32};let{center:n,size:r,roundRadius:s,segments:o}=Object.assign({},t,e);if(!D0(n,2))throw new Error("center must be an array of X and Y values");if(!D0(r,2))throw new Error("size must be an array of X and Y values");if(!r.every(p=>p>=0))throw new Error("size values must be positive");if(!N0(s,0))throw new Error("roundRadius must be positive");if(!N0(o,4))throw new Error("segments must be four or more");if(r[0]===0||r[1]===0)return G0.create();if(s===0)return QM({center:n,size:r});if(r=r.map(p=>p/2),s>r[0]-F0||s>r[1]-F0)throw new Error("roundRadius must be smaller then the radius of all dimensions");const i=Math.floor(o/4),a=Ot.add(Ot.create(),n,[r[0]-s,r[1]-s]),c=Ot.add(Ot.create(),n,[s-r[0],r[1]-s]),l=Ot.add(Ot.create(),n,[s-r[0],s-r[1]]),u=Ot.add(Ot.create(),n,[r[0]-s,s-r[1]]),d=[],h=[],m=[],w=[];for(let p=0;p<=i;p++){const y=fa/4*p/i,P=Ot.fromAngleRadians(Ot.create(),y);Ot.scale(P,P,s),d.push(Ot.add(Ot.create(),a,P)),Ot.rotate(P,P,Ot.create(),fa/4),h.push(Ot.add(Ot.create(),c,P)),Ot.rotate(P,P,Ot.create(),fa/4),m.push(Ot.add(Ot.create(),l,P)),Ot.rotate(P,P,Ot.create(),fa/4),w.push(Ot.add(Ot.create(),u,P))}return G0.fromPoints(d.concat(h,m,w))};var JM=KM;const eL=Hv,{isGTE:tL}=Yt,nL=e=>{const t={center:[0,0,0],radius:1,segments:32,axes:[[1,0,0],[0,-1,0],[0,0,1]]};let{center:n,radius:r,segments:s,axes:o}=Object.assign({},t,e);if(!tL(r,0))throw new Error("radius must be positive");return r=[r,r,r],eL({center:n,radius:r,segments:s,axes:o})};var Wv=nL;const rL=tu,{isGTE:sL}=Yt,oL=e=>{const t={center:[0,0],size:2};let{center:n,size:r}=Object.assign({},t,e);if(!sL(r,0))throw new Error("size must be positive");return r=[r,r],rL({center:n,size:r})};var iL=oL;const{TAU:Zv}=at,Io=st,aL=Je,{isGT:cL,isGTE:ua,isNumberArray:lL}=Yt,fL=(e,t)=>e>0&&t>1&&t<e/2?Math.cos(Math.PI*t/e)/Math.cos(Math.PI*(t-1)/e):0,B0=(e,t,n,r)=>{const s=Zv/e,o=[];for(let i=0;i<e;i++){const a=Io.fromAngleRadians(Io.create(),s*i+n);Io.scale(a,a,t),Io.add(a,r,a),o.push(a)}return o},uL=e=>{const t={center:[0,0],vertices:5,outerRadius:1,innerRadius:0,density:2,startAngle:0};let{center:n,vertices:r,outerRadius:s,innerRadius:o,density:i,startAngle:a}=Object.assign({},t,e);if(!lL(n,2))throw new Error("center must be an array of X and Y values");if(!ua(r,2))throw new Error("vertices must be two or more");if(!cL(s,0))throw new Error("outerRadius must be greater than zero");if(!ua(o,0))throw new Error("innerRadius must be greater than zero");if(!ua(a,0))throw new Error("startAngle must be greater than zero");if(r=Math.floor(r),i=Math.floor(i),a=a%Zv,o===0){if(!ua(i,2))throw new Error("density must be two or more");o=s*fL(r,i)}const c=Io.clone(n),l=B0(r,s,a,c),u=B0(r,o,a+Math.PI/r,c),d=[];for(let h=0;h<r;h++)d.push(l[h]),d.push(u[h]);return aL.fromPoints(d)};var dL=uL;const hL=Ze,I0=wt,V0=nr,z0=Je,U0=et,q0=pt,Qa=(e,...t)=>{const n={origin:[0,0,0],normal:[0,0,1]},{origin:r,normal:s}=Object.assign({},n,e);if(t=hL(t),t.length===0)throw new Error("wrong number of arguments");const o=V0.fromNormalAndPoint(V0.create(),s,r);if(Number.isNaN(o[0]))throw new Error("the given origin and normal do not define a proper plane");const i=I0.mirrorByPlane(I0.create(),o),a=t.map(c=>q0.isA(c)?q0.transform(i,c):z0.isA(c)?z0.transform(i,c):U0.isA(c)?U0.transform(i,c):c);return a.length===1?a[0]:a},mL=(...e)=>Qa({normal:[1,0,0]},e),vL=(...e)=>Qa({normal:[0,1,0]},e),pL=(...e)=>Qa({normal:[0,0,1]},e);var Vo={mirror:Qa,mirrorX:mL,mirrorY:vL,mirrorZ:pL};const X0=nr,Wr=Ue,gL=e=>{const t=e.edges;if(t.length<3)throw new Error("slices must have 3 or more edges to calculate a plane");const n=t.reduce((i,a)=>Wr.add(Wr.create(),i,a[0]),Wr.create());Wr.scale(n,n,1/t.length);let r,s=0;t.forEach(i=>{if(!Wr.equals(i[0],i[1])){const a=Wr.squaredDistance(n,i[0]);a>s&&(r=i,s=a)}});const o=t.find(i=>Wr.equals(i[1],r[0]));return X0.fromPoints(X0.create(),o[0],r[0],r[1])};var Qv=gL;const yL=e=>(e||(e=[]),{edges:e});var os=yL;const bL=os,j0=Ue,_L=(...e)=>{let t,n;return e.length===1?(t=bL(),n=e[0]):(t=e[0],n=e[1]),t.edges=n.edges.map(r=>[j0.clone(r[0]),j0.clone(r[1])]),t};var wL=_L;const $L=Ue,EL=(e,t)=>{const n=e.edges,r=t.edges;return n.length!==r.length?!1:n.reduce((o,i,a)=>{const c=r[a],l=$L.squaredDistance(i[0],c[0]);return o&&l<Number.EPSILON},!0)};var xL=EL;const da=Ue,AL=os,TL=e=>{if(!Array.isArray(e))throw new Error("the given points must be an array");if(e.length<3)throw new Error("the given points must contain THREE or more points");const t=[];let n=e[e.length-1];return e.forEach(r=>{r.length===2&&t.push([da.fromVec2(da.create(),n),da.fromVec2(da.create(),r)]),r.length===3&&t.push([n,r]),n=r}),AL(t)};var SL=TL;const ha=Ue,PL=os,OL=e=>{if(!Array.isArray(e))throw new Error("the given sides must be an array");const t=[];return e.forEach(n=>{t.push([ha.fromVec2(ha.create(),n[0]),ha.fromVec2(ha.create(),n[1])])}),PL(t)};var CL=OL;const ML=e=>!!(e&&typeof e=="object"&&"edges"in e&&Array.isArray(e.edges));var LL=ML;const kL=os,RL=(...e)=>{let t,n;return e.length===1?(t=kL(),n=e[0]):(t=e[0],n=e[1]),t.edges=n.edges.map(r=>[r[1],r[0]]),t};var FL=RL;const GL=e=>e.edges;var NL=GL;const DL=(e,t)=>{let n,r,s,o,i,a=1;do{r=e,e=null;let c=null;for(i=0;r;){i++,s=r;let l=0;for(n=0;n<a&&(l++,s=s.nextZ,!!s);n++);let u=a;for(;l>0||u>0&&s;)l!==0&&(u===0||!s||t(r)<=t(s))?(o=r,r=r.nextZ,l--):(o=s,s=s.nextZ,u--),c?c.nextZ=o:e=o,o.prevZ=c,c=o;r=s}c.nextZ=null,a*=2}while(i>1);return e};var BL=DL;const IL=BL;let Kv=class{constructor(t,n,r){this.i=t,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}};const VL=(e,t,n,r)=>{const s=new Kv(e,t,n);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s},zL=e=>{e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)};var Jv={Node:Kv,insertNode:VL,removeNode:zL,sortLinked:IL};const UL=(e,t,n,r,s,o,i,a)=>(s-i)*(t-a)-(e-i)*(o-a)>=0&&(e-i)*(r-a)-(n-i)*(t-a)>=0&&(n-i)*(o-a)-(s-i)*(r-a)>=0,qL=(e,t,n)=>(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y);var nu={area:qL,pointInTriangle:UL};const{Node:H0,insertNode:Y0,removeNode:Fa}=Jv,{area:wn}=nu,XL=(e,t,n,r,s)=>{let o;if(s===QL(e,t,n,r)>0)for(let i=t;i<n;i+=r)o=Y0(i,e[i],e[i+1],o);else for(let i=n-r;i>=t;i-=r)o=Y0(i,e[i],e[i+1],o);return o&&Ka(o,o.next)&&(Fa(o),o=o.next),o},ep=(e,t)=>{if(!e)return e;t||(t=e);let n=e,r;do if(r=!1,!n.steiner&&(Ka(n,n.next)||wn(n.prev,n,n.next)===0)){if(Fa(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t},jL=(e,t,n)=>{let r=e;do{const s=r.prev,o=r.next.next;!Ka(s,o)&&tp(s,r,r.next,o)&&Wo(s,o)&&Wo(o,s)&&(t.push(s.i/n),t.push(r.i/n),t.push(o.i/n),Fa(r),Fa(r.next),r=e=o),r=r.next}while(r!==e);return ep(r)},HL=(e,t)=>{let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&tp(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1},Wo=(e,t)=>wn(e.prev,e,e.next)<0?wn(e,t,e.next)>=0&&wn(e,e.prev,t)>=0:wn(e,t,e.prev)<0||wn(e,e.next,t)<0,YL=(e,t)=>{let n=e,r=!1;const s=(e.x+t.x)/2,o=(e.y+t.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&s<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r},WL=(e,t)=>{const n=new H0(e.i,e.x,e.y),r=new H0(t.i,t.x,t.y),s=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=s,s.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r},ZL=(e,t)=>e.next.i!==t.i&&e.prev.i!==t.i&&!HL(e,t)&&(Wo(e,t)&&Wo(t,e)&&YL(e,t)&&(wn(e.prev,e,t.prev)||wn(e,t.prev,t))||Ka(e,t)&&wn(e.prev,e,e.next)>0&&wn(t.prev,t,t.next)>0),tp=(e,t,n,r)=>{const s=Math.sign(wn(e,t,n)),o=Math.sign(wn(e,t,r)),i=Math.sign(wn(n,r,e)),a=Math.sign(wn(n,r,t));return!!(s!==o&&i!==a||s===0&&ma(e,n,t)||o===0&&ma(e,r,t)||i===0&&ma(n,e,r)||a===0&&ma(n,t,r))},ma=(e,t,n)=>t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y),QL=(e,t,n,r)=>{let s=0;for(let o=t,i=n-r;o<n;o+=r)s+=(e[i]-e[o])*(e[o+1]+e[i+1]),i=o;return s},Ka=(e,t)=>e.x===t.x&&e.y===t.y;var np={cureLocalIntersections:jL,filterPoints:ep,isValidDiagonal:ZL,linkedPolygon:XL,locallyInside:Wo,splitPolygon:WL};const{filterPoints:Tf,linkedPolygon:KL,locallyInside:JL,splitPolygon:e6}=np,{area:W0,pointInTriangle:t6}=nu,n6=(e,t,n,r)=>{const s=[];for(let o=0,i=t.length;o<i;o++){const a=t[o]*r,c=o<i-1?t[o+1]*r:e.length,l=KL(e,a,c,r,!1);l===l.next&&(l.steiner=!0),s.push(i6(l))}s.sort((o,i)=>o.x-i.x);for(let o=0;o<s.length;o++)n=r6(s[o],n),n=Tf(n,n.next);return n},r6=(e,t)=>{const n=s6(e,t);if(!n)return t;const r=e6(n,e),s=Tf(n,n.next);return Tf(r,r.next),t===n?s:t},s6=(e,t)=>{let n=t;const r=e.x,s=e.y;let o=-1/0,i;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){const d=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=r&&d>o){if(o=d,d===r){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===o)return i;const a=i,c=i.x,l=i.y;let u=1/0;n=i;do{if(r>=n.x&&n.x>=c&&r!==n.x&&t6(s<l?r:o,s,c,l,s<l?o:r,s,n.x,n.y)){const d=Math.abs(s-n.y)/(r-n.x);JL(n,e)&&(d<u||d===u&&(n.x>i.x||n.x===i.x&&o6(i,n)))&&(i=n,u=d)}n=n.next}while(n!==a);return i},o6=(e,t)=>W0(e.prev,e,t.prev)<0&&W0(t.next,e,e.next)<0,i6=e=>{let t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n};var a6=n6;const c6=a6,{removeNode:l6,sortLinked:f6}=Jv,{cureLocalIntersections:u6,filterPoints:Ga,isValidDiagonal:d6,linkedPolygon:h6,splitPolygon:m6}=np,{area:Kr,pointInTriangle:zo}=nu,v6=(e,t,n=2)=>{const r=t&&t.length,s=r?t[0]*n:e.length;let o=h6(e,0,s,n,!0);const i=[];if(!o||o.next===o.prev)return i;let a,c,l,u,d;if(r&&(o=c6(e,t,o,n)),e.length>80*n){a=l=e[0],c=u=e[1];for(let h=n;h<s;h+=n){const m=e[h],w=e[h+1];m<a&&(a=m),w<c&&(c=w),m>l&&(l=m),w>u&&(u=w)}d=Math.max(l-a,u-c),d=d!==0?1/d:0}return Zo(o,i,n,a,c,d),i},Zo=(e,t,n,r,s,o,i)=>{if(!e)return;!i&&o&&b6(e,r,s,o);let a=e,c,l;for(;e.prev!==e.next;){if(c=e.prev,l=e.next,o?g6(e,r,s,o):p6(e)){t.push(c.i/n),t.push(e.i/n),t.push(l.i/n),l6(e),e=l.next,a=l.next;continue}if(e=l,e===a){i?i===1?(e=u6(Ga(e),t,n),Zo(e,t,n,r,s,o,2)):i===2&&y6(e,t,n,r,s,o):Zo(Ga(e),t,n,r,s,o,1);break}}},p6=e=>{const t=e.prev,n=e,r=e.next;if(Kr(t,n,r)>=0)return!1;let s=e.next.next;for(;s!==e.prev;){if(zo(t.x,t.y,n.x,n.y,r.x,r.y,s.x,s.y)&&Kr(s.prev,s,s.next)>=0)return!1;s=s.next}return!0},g6=(e,t,n,r)=>{const s=e.prev,o=e,i=e.next;if(Kr(s,o,i)>=0)return!1;const a=s.x<o.x?s.x<i.x?s.x:i.x:o.x<i.x?o.x:i.x,c=s.y<o.y?s.y<i.y?s.y:i.y:o.y<i.y?o.y:i.y,l=s.x>o.x?s.x>i.x?s.x:i.x:o.x>i.x?o.x:i.x,u=s.y>o.y?s.y>i.y?s.y:i.y:o.y>i.y?o.y:i.y,d=Sf(a,c,t,n,r),h=Sf(l,u,t,n,r);let m=e.prevZ,w=e.nextZ;for(;m&&m.z>=d&&w&&w.z<=h;){if(m!==e.prev&&m!==e.next&&zo(s.x,s.y,o.x,o.y,i.x,i.y,m.x,m.y)&&Kr(m.prev,m,m.next)>=0||(m=m.prevZ,w!==e.prev&&w!==e.next&&zo(s.x,s.y,o.x,o.y,i.x,i.y,w.x,w.y)&&Kr(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;m&&m.z>=d;){if(m!==e.prev&&m!==e.next&&zo(s.x,s.y,o.x,o.y,i.x,i.y,m.x,m.y)&&Kr(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;w&&w.z<=h;){if(w!==e.prev&&w!==e.next&&zo(s.x,s.y,o.x,o.y,i.x,i.y,w.x,w.y)&&Kr(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0},y6=(e,t,n,r,s,o)=>{let i=e;do{let a=i.next.next;for(;a!==i.prev;){if(i.i!==a.i&&d6(i,a)){let c=m6(i,a);i=Ga(i,i.next),c=Ga(c,c.next),Zo(i,t,n,r,s,o),Zo(c,t,n,r,s,o);return}a=a.next}i=i.next}while(i!==e)},b6=(e,t,n,r)=>{let s=e;do s.z===null&&(s.z=Sf(s.x,s.y,t,n,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,f6(s,o=>o.z)},Sf=(e,t,n,r,s)=>(e=32767*(e-n)*s,t=32767*(t-r)*s,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1);var _6=v6;const{area:w6}=ti,{toOutlines:$6}=Je,{arePointsInside:E6}=Xf,x6=e=>{const t=$6(e),n=[],r=[];t.forEach((i,a)=>{const c=w6(i);c<0?r.push(a):c>0&&n.push(a)});const s=[],o=[];return n.forEach((i,a)=>{const c=t[i];s[a]=[],r.forEach((l,u)=>{const d=t[l];E6([d[0]],{vertices:c})&&(s[a].push(l),o[u]||(o[u]=[]),o[u].push(a))})}),r.forEach((i,a)=>{if(o[a]&&o[a].length>1){const c=A6(o[a],l=>s[l].length);o[a].forEach((l,u)=>{u!==c&&(s[l]=s[l].filter(d=>d!==i))})}}),s.map((i,a)=>({solid:t[n[a]],holes:i.map(c=>t[c])}))},A6=(e,t)=>{let n,r;return e.forEach((s,o)=>{const i=t(s);(r===void 0||i<r)&&(n=o,r=i)}),n};var T6=x6;const S6=Je,Z0=nr,P6=st,nn=Ue,O6=Qv,C6=T6;let M6=class{constructor(t){this.plane=O6(t);const n=nn.orthogonal(nn.create(),this.plane),r=nn.cross(nn.create(),this.plane,n);this.v=nn.normalize(r,r),this.u=nn.cross(nn.create(),this.v,this.plane),this.basisMap=new Map;const s=t.edges.map(i=>i.map(a=>this.to2D(a))),o=S6.create(s);this.roots=C6(o)}to2D(t){const n=P6.fromValues(nn.dot(t,this.u),nn.dot(t,this.v));return this.basisMap.set(n,t),n}to3D(t){const n=this.basisMap.get(t);if(n)return n;{console.log("Warning: point not in original slice");const r=nn.scale(nn.create(),this.u,t[0]),s=nn.scale(nn.create(),this.v,t[1]),o=nn.scale(nn.create(),Z0,Z0[3]),i=nn.add(r,r,o);return nn.add(s,s,i)}}};var L6=M6;const k6=ct,R6=_6,F6=L6,G6=e=>{const t=new F6(e),n=[];return t.roots.forEach(({solid:r,holes:s})=>{let o=r.length;const i=[];s.forEach((d,h)=>{i.push(o),o+=d.length});const a=[r,...s].flat(),c=a.flat(),l=d=>t.to3D(a[d]),u=R6(c,i);for(let d=0;d<u.length;d+=3){const h=u.slice(d,d+3).map(l);n.push(k6.fromPointsAndPlane(h,t.plane))}}),n};var N6=G6;const Q0=Ue,D6=e=>e.reduce((t,n)=>t+=`[${Q0.toString(n[0])}, ${Q0.toString(n[1])}], `,""),B6=e=>`[${D6(e.edges)}]`;var I6=B6;const va=Ue,V6=os,z6=(e,t)=>{const n=t.edges.map(r=>[va.transform(va.create(),r[0],e),va.transform(va.create(),r[1],e)]);return V6(n)};var U6=z6,Ys={calculatePlane:Qv,clone:wL,create:os,equals:xL,fromPoints:SL,fromSides:CL,isA:LL,reverse:FL,toEdges:NL,toPolygons:N6,toString:I6,transform:U6};const K0=Ue,q6=os,X6=e=>{if(!e.edges)return e;let t=e.edges;const n=new Map,r=new Map;t=t.filter(i=>!K0.equals(i[0],i[1])),t.forEach(i=>{const a=i[0].toString(),c=i[1].toString();n.set(a,i[0]),n.set(c,i[1]),r.set(a,(r.get(a)||0)+1),r.set(c,(r.get(c)||0)-1)});const s=[],o=[];return r.forEach((i,a)=>{i<0&&s.push(a),i>0&&o.push(a)}),s.forEach(i=>{const a=n.get(i);let c=1/0,l;o.forEach(u=>{const d=n.get(u),h=K0.distance(a,d);h<c&&(c=h,l=d)}),console.warn(`slice.repair: repairing vertex gap ${a} to ${l} distance ${c}`),t=t.map(u=>u[0].toString()===i?[l,u[1]]:u[1].toString()===i?[u[0],l]:u)}),q6(t)};var j6=X6;const{EPS:J0}=at,Cs=Ue,pa=ct,eh=Ys,Pf=(e,t)=>e===t?e:e<t?Pf(t,e):t===1?1:t===0?e:Pf(t,e%t),H6=(e,t)=>e*t/Pf(e,t),th=(e,t)=>{const n=e/t.length;if(n===1)return t;const r=Cs.fromValues(n,n,n),s=[];return t.forEach(o=>{const i=Cs.subtract(Cs.create(),o[1],o[0]);Cs.divide(i,i,r);let a=o[0];for(let c=1;c<=n;++c){const l=Cs.add(Cs.create(),a,i);s.push([a,l]),a=l}}),s},nh=J0*J0/2*Math.sin(Math.PI/3),Y6=(e,t)=>{let n=eh.toEdges(e),r=eh.toEdges(t);if(n.length!==r.length){const o=H6(n.length,r.length);o!==n.length&&(n=th(o,n)),o!==r.length&&(r=th(o,r))}const s=[];return n.forEach((o,i)=>{const a=r[i],c=pa.create([o[0],o[1],a[1]]),l=pa.measureArea(c);Number.isFinite(l)&&l>nh&&s.push(c);const u=pa.create([o[0],a[1],a[0]]),d=pa.measureArea(u);Number.isFinite(d)&&d>nh&&s.push(u)}),s};var W6=Y6;const rh=wt,sh=Je,Z6=et,Of=ct,Pr=Ys,Q6=j6,oh=W6,K6=(e,t,n)=>{let r=null;return sh.isA(n)&&(r=Pr.fromSides(sh.toSides(n))),Of.isA(n)&&(r=Pr.fromPoints(Of.toPoints(n))),e===0||e===1?Pr.transform(rh.fromTranslation(rh.create(),[0,0,e]),r):null},J6=(e,t)=>{const n={numberOfSlices:2,capStart:!0,capEnd:!0,close:!1,repair:!0,callback:K6},{numberOfSlices:r,capStart:s,capEnd:o,close:i,repair:a,callback:c}=Object.assign({},n,e);if(r<2)throw new Error("numberOfSlices must be 2 or more");a&&(t=Q6(t));const l=r-1;let u=null,d=null,h=null,m=[];for(let w=0;w<r;w++){const p=c(w/l,w,t);if(p){if(!Pr.isA(p))throw new Error("the callback function must return slice objects");if(Pr.toEdges(p).length===0)throw new Error("the callback function must return slices with one or more edges");h&&(m=m.concat(oh(h,p))),w===0&&(u=p),w===r-1&&(d=p),h=p}}if(o){const w=Pr.toPolygons(d);m=m.concat(w)}if(s){const w=Pr.toPolygons(u).map(Of.invert);m=m.concat(w)}return!s&&!o&&i&&!Pr.equals(d,u)&&(m=m.concat(oh(d,u))),Z6.create(m)};var Ja=J6;const{TAU:Sn}=at,Lo=wt,{mirrorX:ek}=Vo,ko=Je,Yl=Ys,tk=Ja,nk=(e,t)=>{const n={segments:12,startAngle:0,angle:Sn,overflow:"cap"};let{segments:r,startAngle:s,angle:o,overflow:i}=Object.assign({},n,e);if(r<3)throw new Error("segments must be greater then 3");s=Math.abs(s)>Sn?s%Sn:s,o=Math.abs(o)>Sn?o%Sn:o;let a=s+o;if(a=Math.abs(a)>Sn?a%Sn:a,a<s){const F=s;s=a,a=F}let c=a-s;if(c<=0&&(c=Sn),Math.abs(c)<Sn){const F=Sn/r;r=Math.floor(Math.abs(c)/F),Math.abs(c)>r*F&&r++}let l=ko.toSides(t);if(l.length===0)throw new Error("the given geometry cannot be empty");const u=l.filter(F=>F[0][0]<0),d=l.filter(F=>F[0][0]>=0);u.length>0&&d.length>0&&i==="cap"&&(u.length>d.length?(l=l.map(F=>{let L=F[0],k=F[1];return L=[Math.min(L[0],0),L[1]],k=[Math.min(k[0],0),k[1]],[L,k]}),t=ko.reverse(ko.create(l)),t=ek(t)):d.length>=u.length&&(l=l.map(F=>{let L=F[0],k=F[1];return L=[Math.max(L[0],0),L[1]],k=[Math.max(k[0],0),k[1]],[L,k]}),t=ko.create(l)));const m=c/r,w=Math.abs(c)<Sn,p=Yl.fromSides(ko.toSides(t));Yl.reverse(p,p);const y=Lo.create(),P=(F,L,k)=>{let T=m*L+s;return c===Sn&&L===r&&(T=s),Lo.multiply(y,Lo.fromZRotation(y,T),Lo.fromXRotation(Lo.create(),Sn/4)),Yl.transform(y,k)};return e={numberOfSlices:r+1,capStart:w,capEnd:w,close:!w,callback:P},tk(e,p)};var rp=nk;const rk=Ze,ih=wt,ah=Je,ch=et,lh=pt,ec=(e,...t)=>{if(!Array.isArray(e))throw new Error("angles must be an array");if(t=rk(t),t.length===0)throw new Error("wrong number of arguments");for(e=e.slice();e.length<3;)e.push(0);const n=e[2],r=e[1],s=e[0],o=ih.fromTaitBryanRotation(ih.create(),n,r,s),i=t.map(a=>lh.isA(a)?lh.transform(o,a):ah.isA(a)?ah.transform(o,a):ch.isA(a)?ch.transform(o,a):a);return i.length===1?i[0]:i},sk=(e,...t)=>ec([e,0,0],t),ok=(e,...t)=>ec([0,e,0],t),ik=(e,...t)=>ec([0,0,e],t);var Uo={rotate:ec,rotateX:sk,rotateY:ok,rotateZ:ik};const ak=Ze,fh=wt,uh=Je,dh=et,hh=pt,tc=(e,...t)=>{if(!Array.isArray(e))throw new Error("offset must be an array");if(t=ak(t),t.length===0)throw new Error("wrong number of arguments");for(e=e.slice();e.length<3;)e.push(0);const n=fh.fromTranslation(fh.create(),e),r=t.map(s=>hh.isA(s)?hh.transform(n,s):uh.isA(s)?uh.transform(n,s):dh.isA(s)?dh.transform(n,s):s);return r.length===1?r[0]:r},ck=(e,...t)=>tc([e,0,0],t),lk=(e,...t)=>tc([0,e,0],t),fk=(e,...t)=>tc([0,0,e],t);var ts={translate:tc,translateX:ck,translateY:lk,translateZ:fk};const{TAU:uk}=at,dk=rp,{rotate:hk}=Uo,{translate:mk}=ts,vk=qv,{isGT:Wl,isGTE:Zl}=Yt,pk=e=>{const t={innerRadius:1,innerSegments:32,outerRadius:4,outerSegments:32,innerRotation:0,startAngle:0,outerRotation:uk},{innerRadius:n,innerSegments:r,outerRadius:s,outerSegments:o,innerRotation:i,startAngle:a,outerRotation:c}=Object.assign({},t,e);if(!Wl(n,0))throw new Error("innerRadius must be greater than zero");if(!Zl(r,3))throw new Error("innerSegments must be three or more");if(!Wl(s,0))throw new Error("outerRadius must be greater than zero");if(!Zl(o,3))throw new Error("outerSegments must be three or more");if(!Zl(a,0))throw new Error("startAngle must be positive");if(!Wl(c,0))throw new Error("outerRotation must be greater than zero");if(n>=s)throw new Error("inner circle is two large to rotate about the outer circle");let l=vk({radius:n,segments:r});return i!==0&&(l=hk([0,0,i],l)),l=mk([s,0],l),dk({startAngle:a,angle:c,segments:o},l)};var gk=pk;const{NEPS:Xs}=at,Ro=st,yk=Je,{isNumberArray:bk}=Yt,Cf=(e,t,n)=>Math.acos((e*e+t*t-n*n)/(2*e*t)),_k=(e,t,n)=>t>Xs?Math.sqrt(e*e+n*n-2*e*n*Math.cos(t)):Math.sqrt((e-n)*(e-n)+e*n*t*t*(1-t*t/12)),wk=e=>{if(Math.abs(e[0]+e[1]+e[2]-Math.PI)>Xs)throw new Error("AAA triangles require angles that sum to PI");const n=e[0],r=e[1],s=Math.PI-n-r,o=1,i=o/Math.sin(s)*Math.sin(n),a=o/Math.sin(s)*Math.sin(r);return Ws(n,r,s,i,a,o)},$k=e=>{const t=e[0],n=e[1],r=Math.PI+Xs-t-n;if(r<Xs)throw new Error("AAS triangles require angles that sum to PI");const s=e[2],o=s/Math.sin(t)*Math.sin(n),i=s/Math.sin(t)*Math.sin(r);return Ws(t,n,r,s,o,i)},Ek=e=>{const t=e[0],n=e[2],r=Math.PI+Xs-t-n;if(r<Xs)throw new Error("ASA triangles require angles that sum to PI");const s=e[1],o=s/Math.sin(r)*Math.sin(t),i=s/Math.sin(r)*Math.sin(n);return Ws(t,n,r,o,i,s)},xk=e=>{const t=e[0],n=e[1],r=e[2],s=_k(t,n,r),o=Cf(s,t,r),i=Math.PI-o-n;return Ws(o,n,i,r,s,t)},Ak=e=>{const t=e[0],n=e[1],r=e[2],s=Math.asin(n*Math.sin(r)/t),o=Math.PI-s-r,i=t/Math.sin(r)*Math.sin(o);return Ws(s,o,r,n,i,t)},Tk=e=>{const t=e[1],n=e[2],r=e[0];if(t+n<=r||n+r<=t||r+t<=n)throw new Error("SSS triangle is incorrect, as the longest side is longer than the sum of the other sides");const s=Cf(n,r,t),o=Cf(r,t,n),i=Math.PI-s-o;return Ws(s,o,i,t,n,r)},Ws=(e,t,n,r,s,o)=>{const i=Ro.fromValues(0,0),a=Ro.fromValues(o,0),c=Ro.fromValues(r,0);return Ro.add(c,Ro.rotate(c,c,[0,0],Math.PI-t),a),yk.fromPoints([i,a,c])},Sk=e=>{const t={type:"SSS",values:[1,1,1]};let{type:n,values:r}=Object.assign({},t,e);if(typeof n!="string")throw new Error("triangle type must be a string");if(n=n.toUpperCase(),!((n[0]==="A"||n[0]==="S")&&(n[1]==="A"||n[1]==="S")&&(n[2]==="A"||n[2]==="S")))throw new Error("triangle type must contain three letters; A or S");if(!bk(r,3))throw new Error("triangle values must contain three values");if(!r.every(s=>s>0))throw new Error("triangle values must be greater than zero");switch(n){case"AAA":return wk(r);case"AAS":return $k(r);case"ASA":return Ek(r);case"SAS":return xk(r);case"SSA":return Ak(r);case"SSS":return Tk(r);default:throw new Error("invalid triangle type, try again")}};var Pk=Sk,Ok={arc:tM,circle:qv,cube:mM,cuboid:eu,cylinder:jv,cylinderElliptic:Xv,ellipse:Uv,ellipsoid:Hv,geodesicSphere:LM,line:FM,polygon:NM,polyhedron:Yv,rectangle:tu,roundedCuboid:qM,roundedCylinder:ZM,roundedRectangle:JM,sphere:Wv,square:iL,star:dL,torus:gk,triangle:Pk},Ck={height:14,32:[16],33:[10,5,21,5,7,void 0,5,2,4,1,5,0,6,1,5,2],34:[16,4,21,4,14,void 0,12,21,12,14],35:[21,11,25,4,-7,void 0,17,25,10,-7,void 0,4,12,18,12,void 0,3,6,17,6],36:[20,8,25,8,-4,void 0,12,25,12,-4,void 0,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3],37:[24,21,21,3,0,void 0,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,void 0,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7],38:[26,23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2],39:[10,5,19,4,20,5,21,6,20,6,18,5,16,4,15],40:[14,11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7],41:[14,3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7],42:[16,8,21,8,9,void 0,3,18,13,12,void 0,13,18,3,12],43:[26,13,18,13,0,void 0,4,9,22,9],44:[10,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4],45:[26,4,9,22,9],46:[10,5,2,4,1,5,0,6,1,5,2],47:[22,20,25,2,-7],48:[20,9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21],49:[20,6,17,8,18,11,21,11,0],50:[20,4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0],51:[20,5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4],52:[20,13,21,3,7,18,7,void 0,13,21,13,0],53:[20,15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4],54:[20,16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7],55:[20,17,21,7,0,void 0,3,21,17,21],56:[20,8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21],57:[20,16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3],58:[10,5,14,4,13,5,12,6,13,5,14,void 0,5,2,4,1,5,0,6,1,5,2],59:[10,5,14,4,13,5,12,6,13,5,14,void 0,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4],60:[24,20,18,4,9,20,0],61:[26,4,12,22,12,void 0,4,6,22,6],62:[24,4,18,20,9,4,0],63:[18,3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,void 0,9,2,8,1,9,0,10,1,9,2],64:[27,18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,void 0,12,16,10,14,9,11,9,8,10,6,11,5,void 0,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,void 0,19,16,18,8,18,6,19,5],65:[18,9,21,1,0,void 0,9,21,17,0,void 0,4,7,14,7],66:[21,4,21,4,0,void 0,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,void 0,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0],67:[21,18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5],68:[21,4,21,4,0,void 0,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0],69:[19,4,21,4,0,void 0,4,21,17,21,void 0,4,11,12,11,void 0,4,0,17,0],70:[18,4,21,4,0,void 0,4,21,17,21,void 0,4,11,12,11],71:[21,18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,void 0,13,8,18,8],72:[22,4,21,4,0,void 0,18,21,18,0,void 0,4,11,18,11],73:[8,4,21,4,0],74:[16,12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7],75:[21,4,21,4,0,void 0,18,21,4,7,void 0,9,12,18,0],76:[17,4,21,4,0,void 0,4,0,16,0],77:[24,4,21,4,0,void 0,4,21,12,0,void 0,20,21,12,0,void 0,20,21,20,0],78:[22,4,21,4,0,void 0,4,21,18,0,void 0,18,21,18,0],79:[22,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21],80:[21,4,21,4,0,void 0,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10],81:[22,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,void 0,12,4,18,-2],82:[21,4,21,4,0,void 0,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,void 0,11,11,18,0],83:[20,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3],84:[16,8,21,8,0,void 0,1,21,15,21],85:[22,4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21],86:[18,1,21,9,0,void 0,17,21,9,0],87:[24,2,21,7,0,void 0,12,21,7,0,void 0,12,21,17,0,void 0,22,21,17,0],88:[20,3,21,17,0,void 0,17,21,3,0],89:[18,1,21,9,11,9,0,void 0,17,21,9,11],90:[20,17,21,3,0,void 0,3,21,17,21,void 0,3,0,17,0],91:[14,4,25,4,-7,void 0,5,25,5,-7,void 0,4,25,11,25,void 0,4,-7,11,-7],92:[14,0,21,14,-3],93:[14,9,25,9,-7,void 0,10,25,10,-7,void 0,3,25,10,25,void 0,3,-7,10,-7],94:[16,6,15,8,18,10,15,void 0,3,12,8,17,13,12,void 0,8,17,8,0],95:[16,0,-2,16,-2],96:[10,6,21,5,20,4,18,4,16,5,15,6,16,5,17],97:[19,15,14,15,0,void 0,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],98:[19,4,21,4,0,void 0,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3],99:[18,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],100:[19,15,21,15,0,void 0,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],101:[18,3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],102:[12,10,21,8,21,6,20,5,17,5,0,void 0,2,14,9,14],103:[19,15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,void 0,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],104:[19,4,21,4,0,void 0,4,10,7,13,9,14,12,14,14,13,15,10,15,0],105:[8,3,21,4,20,5,21,4,22,3,21,void 0,4,14,4,0],106:[10,5,21,6,20,7,21,6,22,5,21,void 0,6,14,6,-3,5,-6,3,-7,1,-7],107:[17,4,21,4,0,void 0,14,14,4,4,void 0,8,8,15,0],108:[8,4,21,4,0],109:[30,4,14,4,0,void 0,4,10,7,13,9,14,12,14,14,13,15,10,15,0,void 0,15,10,18,13,20,14,23,14,25,13,26,10,26,0],110:[19,4,14,4,0,void 0,4,10,7,13,9,14,12,14,14,13,15,10,15,0],111:[19,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14],112:[19,4,14,4,-7,void 0,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3],113:[19,15,14,15,-7,void 0,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],114:[13,4,14,4,0,void 0,4,8,5,11,7,13,9,14,12,14],115:[17,14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3],116:[12,5,21,5,4,6,1,8,0,10,0,void 0,2,14,9,14],117:[19,4,14,4,4,5,1,7,0,10,0,12,1,15,4,void 0,15,14,15,0],118:[16,2,14,8,0,void 0,14,14,8,0],119:[22,3,14,7,0,void 0,11,14,7,0,void 0,11,14,15,0,void 0,19,14,15,0],120:[17,3,14,14,0,void 0,14,14,3,0],121:[16,2,14,8,0,void 0,14,14,8,0,6,-4,4,-6,2,-7,1,-7],122:[17,14,14,3,0,void 0,3,14,14,14,void 0,3,0,14,0],123:[14,9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,void 0,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,void 0,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7],124:[8,4,25,4,-7],125:[14,5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,void 0,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,void 0,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7],126:[24,3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,void 0,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]};const Mk=Ck,Lk={xOffset:0,yOffset:0,input:"?",align:"left",font:Mk,height:14,lineSpacing:2.142857142857143,letterSpacing:1,extrudeOffset:0},kk=(e,t)=>{!t&&typeof e=="string"&&(e={input:e}),e=e||{};const n=Object.assign({},Lk,e);return n.input=t||n.input,n};var sp=kk;const Rk=sp,Fk=(e,t)=>{const{xOffset:n,yOffset:r,input:s,font:o,height:i,extrudeOffset:a}=Rk(e,t);let c=s.charCodeAt(0);(!c||!o[c])&&(c=63);const l=[].concat(o[c]),u=(i-a)/o.height,d=a/2,h=l.shift()*u,m=[];let w=[];for(let p=0,y=l.length;p<y;p+=2){const P=u*l[p]+n,F=u*l[p+1]+r+d;if(l[p]!==void 0){w.push([P,F]);continue}m.push(w),w=[],p--}return w.length&&m.push(w),{width:h,height:i,segments:m}};var op=Fk;const Gk=op,Nk=sp,mh=(e,t)=>{const{x:n,y:r}=Object.assign({x:0,y:0},e||{}),s=t.segments;let o=null,i=null;for(let a=0,c=s.length;a<c;a++){o=s[a];for(let l=0,u=o.length;l<u;l++)i=o[l],o[l]=[i[0]+n,i[1]+r]}return t},Dk=(e,t)=>{const{xOffset:n,yOffset:r,input:s,font:o,height:i,align:a,extrudeOffset:c,lineSpacing:l,letterSpacing:u}=Nk(e,t);let[d,h]=[n,r],m,w,p,y,P,F,L={width:0,segments:[]};const k=[];let T=[],R=0;const B=d,W=()=>{k.push(L),R=Math.max(R,L.width),L={width:0,segments:[]}};for(m=0,w=s.length;m<w;m++){if(p=s[m],y=Gk({xOffset:d,yOffset:h,font:o,height:i,extrudeOffset:c},p),p===`
`){d=B,h-=y.height*l,W();continue}P=y.width*u,L.width+=P,d+=P,p!==" "&&(L.segments=L.segments.concat(y.segments))}for(L.segments.length&&W(),m=0,w=k.length;m<w;m++)L=k[m],R>L.width&&(F=R-L.width,a==="right"?L=mh({x:F},L):a==="center"&&(L=mh({x:F/2},L))),T=T.concat(L.segments);return T};var Bk=Dk,Ik={vectorChar:op,vectorText:Bk};const Vk=Je,zk=et,Uk=pt,qk=e=>{let t;for(const n of e){let r=0;if(Vk.isA(n)&&(r=1),zk.isA(n)&&(r=2),Uk.isA(n)&&(r=3),t&&r!==t)return!1;t=r}return!0};var ri=qk;const Xk=e=>e*.017453292519943295;var jk=Xk;const Hk=(e,t)=>e-t;var ip=Hk;const Yk=(e,t,n)=>{let r=0,s=e.length;for(;s>r;){const o=Math.floor((r+s)/2),i=e[o];n(t,i)>0?r=o+1:s=o}e.splice(r,0,t)};var Wk=Yk;const{TAU:vh}=at,Zk=(e,t,n)=>{const r=t>0?e*vh/t:0,s=n>0?vh/n:0;return Math.ceil(Math.max(r,s,4))};var Qk=Zk;const Kk=e=>e*57.29577951308232;var Jk=Kk,ap={areAllShapesTheSameType:ri,degToRad:jk,flatten:Ze,fnNumberSort:ip,insertSorted:Wk,radiusToSegments:Qk,radToDeg:Jk};const ph=st,eR=Je,tR=(e,t)=>{if(t.vertices.length<4)return null;const n=[],r=t.vertices.filter((i,a)=>i[2]>0?(n.push(a),!0):!1);if(r.length!==2)throw new Error("Assertion failed: fromFakePolygon: not enough points found");const s=r.map(i=>{const a=Math.round(i[0]/e)*e+0,c=Math.round(i[1]/e)*e+0;return ph.fromValues(a,c)});if(ph.equals(s[0],s[1]))return null;const o=n[1]-n[0];if(o===1||o===3)o===1&&s.reverse();else throw new Error("Assertion failed: fromFakePolygon: unknown index ordering");return s},nR=(e,t)=>{const n=t.map(r=>tR(e,r)).filter(r=>r!==null);return eR.create(n)};var ru=nR;const Tr=Ue,rR=Je,sR=et,oR=ct,iR=(e,t,n)=>{const r=[Tr.fromVec2(Tr.create(),n[0],e),Tr.fromVec2(Tr.create(),n[1],e),Tr.fromVec2(Tr.create(),n[1],t),Tr.fromVec2(Tr.create(),n[0],t)];return oR.create(r)},aR=(e,t)=>{const r=rR.toSides(t).map(o=>iR(e.z0,e.z1,o));return sR.create(r)};var su=aR;const gh=wt,cR=st,Ut=Ue,rs=function(e,t){arguments.length<2&&(t=Ut.orthogonal(Ut.create(),e)),this.v=Ut.normalize(Ut.create(),Ut.cross(Ut.create(),e,t)),this.u=Ut.cross(Ut.create(),this.v,e),this.plane=e,this.planeorigin=Ut.scale(Ut.create(),e,e[3])};rs.GetCartesian=function(e,t){const n=e+"/"+t;let r,s;if(n==="X/Y")r=[0,0,1],s=[1,0,0];else if(n==="Y/-X")r=[0,0,1],s=[0,1,0];else if(n==="-X/-Y")r=[0,0,1],s=[-1,0,0];else if(n==="-Y/X")r=[0,0,1],s=[0,-1,0];else if(n==="-X/Y")r=[0,0,-1],s=[-1,0,0];else if(n==="-Y/-X")r=[0,0,-1],s=[0,-1,0];else if(n==="X/-Y")r=[0,0,-1],s=[1,0,0];else if(n==="Y/X")r=[0,0,-1],s=[0,1,0];else if(n==="X/Z")r=[0,-1,0],s=[1,0,0];else if(n==="Z/-X")r=[0,-1,0],s=[0,0,1];else if(n==="-X/-Z")r=[0,-1,0],s=[-1,0,0];else if(n==="-Z/X")r=[0,-1,0],s=[0,0,-1];else if(n==="-X/Z")r=[0,1,0],s=[-1,0,0];else if(n==="-Z/-X")r=[0,1,0],s=[0,0,-1];else if(n==="X/-Z")r=[0,1,0],s=[1,0,0];else if(n==="Z/X")r=[0,1,0],s=[0,0,1];else if(n==="Y/Z")r=[1,0,0],s=[0,1,0];else if(n==="Z/-Y")r=[1,0,0],s=[0,0,1];else if(n==="-Y/-Z")r=[1,0,0],s=[0,-1,0];else if(n==="-Z/Y")r=[1,0,0],s=[0,0,-1];else if(n==="-Y/Z")r=[-1,0,0],s=[0,-1,0];else if(n==="-Z/-Y")r=[-1,0,0],s=[0,0,-1];else if(n==="Y/-Z")r=[-1,0,0],s=[0,1,0];else if(n==="Z/Y")r=[-1,0,0],s=[0,0,1];else throw new Error("OrthoNormalBasis.GetCartesian: invalid combination of axis identifiers. Should pass two string arguments from [X,Y,Z,-X,-Y,-Z], being two different axes.");return new rs(new Plane(new Vector3D(r),0),new Vector3D(s))};rs.Z0Plane=function(){const e=new Plane(new Vector3D([0,0,1]),0);return new rs(e,new Vector3D([1,0,0]))};rs.prototype={getProjectionMatrix:function(){return gh.fromValues(this.u[0],this.v[0],this.plane[0],0,this.u[1],this.v[1],this.plane[1],0,this.u[2],this.v[2],this.plane[2],0,0,0,-this.plane[3],1)},getInverseProjectionMatrix:function(){const e=Ut.scale(Ut.create(),this.plane,this.plane[3]);return gh.fromValues(this.u[0],this.u[1],this.u[2],0,this.v[0],this.v[1],this.v[2],0,this.plane[0],this.plane[1],this.plane[2],0,e[0],e[1],e[2],1)},to2D:function(e){return cR.fromValues(Ut.dot(e,this.u),Ut.dot(e,this.v))},to3D:function(e){const t=Ut.scale(Ut.create(),this.u,e[0]),n=Ut.scale(Ut.create(),this.v,e[1]),r=Ut.add(t,t,this.planeorigin);return Ut.add(n,n,r)},line3Dto2D:function(e){const t=e.point,n=e.direction.plus(t),r=this.to2D(t),s=this.to2D(n);return Line2D.fromPoints(r,s)},line2Dto3D:function(e){const t=e.origin(),n=e.direction().plus(t),r=this.to3D(t),s=this.to3D(n);return Line3D.fromPoints(r,s)},transform:function(e){const t=this.plane.transform(e),n=this.u.transform(e),r=new Vector3D(0,0,0).transform(e),s=n.minus(r);return new rs(t,s)}};var lR=rs;const{EPS:lr}=at,Sr=Zf,Gn=st,fR=lR,Ms=xv,{insertSorted:uR,fnNumberSort:dR}=ap,yh=ct,hR=e=>{if(e.length<2)return e;const t=[],n=e.length,r=yh.plane(e[0]),s=new fR(r),o=[],i=[],a=new Map,c=new Map,l=new Map,u=10/lr;for(let w=0;w<n;w++){const p=e[w];let y=[],P=p.vertices.length,F=-1;if(P>0){let L,k;for(let T=0;T<P;T++){let R=s.to2D(p.vertices[T]);const B=Math.floor(R[1]*u);let W;l.has(B)?W=l.get(B):l.has(B+1)?W=l.get(B+1):l.has(B-1)?W=l.get(B-1):(W=R[1],l.set(B,R[1])),R=Gn.fromValues(R[0],W),y.push(R);const se=R[1];(T===0||se<L)&&(L=se,F=T),(T===0||se>k)&&(k=se);let fe=c.get(se);fe||(fe={},c.set(se,fe)),fe[w]=!0}if(L>=k)y=[],P=0,F=-1;else{let T=a.get(L);T||(T=[],a.set(L,T)),T.push(w)}}y.reverse(),F=P-F-1,o.push(y),i.push(F)}const d=[];c.forEach((w,p)=>d.push(p)),d.sort(dR);let h=[],m=[];for(let w=0;w<d.length;w++){const p=[],y=d[w],P=c.get(y);for(let L=0;L<h.length;++L){const k=h[L],T=k.polygonindex;if(P[T]){const R=o[T],B=R.length;let W=k.leftvertexindex,se=k.rightvertexindex;for(;;){let ce=W+1;if(ce>=B&&(ce=0),R[ce][1]!==y)break;W=ce}let fe=se-1;if(fe<0&&(fe=B-1),R[fe][1]===y&&(se=fe),W!==k.leftvertexindex&&W===se)h.splice(L,1),--L;else{k.leftvertexindex=W,k.rightvertexindex=se,k.topleft=R[W],k.topright=R[se];let ce=W+1;ce>=B&&(ce=0),k.bottomleft=R[ce];let Oe=se-1;Oe<0&&(Oe=B-1),k.bottomright=R[Oe]}}}let F;if(w>=d.length-1)h=[],F=null;else{F=Number(d[w+1]);const L=.5*(y+F),k=a.get(y);for(const T in k){const R=k[T],B=o[R],W=B.length,se=i[R];let fe=se;for(;;){let Xe=fe+1;if(Xe>=W&&(Xe=0),B[Xe][1]!==y||Xe===se)break;fe=Xe}let ce=se;for(;;){let Xe=ce-1;if(Xe<0&&(Xe=W-1),B[Xe][1]!==y||Xe===fe)break;ce=Xe}let Oe=fe+1;Oe>=W&&(Oe=0);let De=ce-1;De<0&&(De=W-1);const we={polygonindex:R,leftvertexindex:fe,rightvertexindex:ce,topleft:B[fe],topright:B[ce],bottomleft:B[Oe],bottomright:B[De]};uR(h,we,(Xe,Fe)=>{const gt=Ms(Xe.topleft,Xe.bottomleft,L),kt=Ms(Fe.topleft,Fe.bottomleft,L);return gt>kt?1:gt<kt?-1:0})}}for(const L in h){const k=h[L];let T=Ms(k.topleft,k.bottomleft,y);const R=Gn.fromValues(T,y);T=Ms(k.topright,k.bottomright,y);const B=Gn.fromValues(T,y);T=Ms(k.topleft,k.bottomleft,F);const W=Gn.fromValues(T,F);T=Ms(k.topright,k.bottomright,F);const se=Gn.fromValues(T,F),fe={topleft:R,topright:B,bottomleft:W,bottomright:se,leftline:Sr.fromPoints(Sr.create(),R,W),rightline:Sr.fromPoints(Sr.create(),se,B)};if(p.length>0){const ce=p[p.length-1],Oe=Gn.distance(fe.topleft,ce.topright),De=Gn.distance(fe.bottomleft,ce.bottomright);Oe<lr&&De<lr&&(fe.topleft=ce.topleft,fe.leftline=ce.leftline,fe.bottomleft=ce.bottomleft,p.splice(p.length-1,1))}p.push(fe)}if(w>0){const L=new Set,k=new Set;for(let T=0;T<p.length;T++){const R=p[T];for(let B=0;B<m.length;B++)if(!k.has(B)){const W=m[B];if(Gn.distance(W.bottomleft,R.topleft)<lr&&Gn.distance(W.bottomright,R.topright)<lr){k.add(B);const se=Sr.direction(R.leftline),fe=Sr.direction(W.leftline),ce=se[0]-fe[0],Oe=Sr.direction(R.rightline),De=Sr.direction(W.rightline),we=Oe[0]-De[0],Xe=Math.abs(ce)<lr,Fe=Math.abs(we)<lr,gt=Xe||ce>=0,kt=Fe||we>=0;gt&&kt&&(R.outpolygon=W.outpolygon,R.leftlinecontinues=Xe,R.rightlinecontinues=Fe,L.add(B));break}}}for(let T=0;T<m.length;T++)if(!L.has(T)){const R=m[T];R.outpolygon.rightpoints.push(R.bottomright),Gn.distance(R.bottomright,R.bottomleft)>lr&&R.outpolygon.leftpoints.push(R.bottomleft),R.outpolygon.leftpoints.reverse();const W=R.outpolygon.rightpoints.concat(R.outpolygon.leftpoints).map(fe=>s.to3D(fe)),se=yh.fromPointsAndPlane(W,r);se.vertices.length&&t.push(se)}}for(let L=0;L<p.length;L++){const k=p[L];k.outpolygon?(k.leftlinecontinues||k.outpolygon.leftpoints.push(k.topleft),k.rightlinecontinues||k.outpolygon.rightpoints.push(k.topright)):(k.outpolygon={leftpoints:[],rightpoints:[]},k.outpolygon.leftpoints.push(k.topleft),Gn.distance(k.topleft,k.topright)>lr&&k.outpolygon.rightpoints.push(k.topright))}m=p}return t};var mR=hR;const bh=et,vR=ct,{NEPS:pR}=at,gR=mR,yR=e=>{if(e.isRetesselated)return e;const t=bh.toPolygons(e).map((o,i)=>({vertices:o.vertices,plane:vR.plane(o),index:i})),n=bR(t),r=[];n.forEach(o=>{if(Array.isArray(o)){const i=gR(o);r.push(...i)}else r.push(o)});const s=bh.create(r);return s.isRetesselated=!0,s},bR=e=>{let t=[e];const n=[];for(let s=3;s>=0;s--){const o=[],i=s===3?15e-9:pR;t.forEach(a=>{a.sort(_R(s,i));let c=0;for(let l=1;l<a.length;l++)a[l].plane[s]-a[c].plane[s]>i&&(l-c===1?n.push(a[c]):o.push(a.slice(c,l)),c=l);a.length-c===1?n.push(a[c]):o.push(a.slice(c))}),t=o}const r=[];return t.forEach(s=>{s[0]&&(r[s[0].index]=s)}),n.forEach(s=>{r[s.index]=s}),r},_R=(e,t)=>(n,r)=>n.plane[e]-r.plane[e]>t?1:r.plane[e]-n.plane[e]>t?-1:0;var si=yR;const{EPS:Ls}=at,_h=ss,wR=(e,t)=>{if(e.polygons.length===0||t.polygons.length===0)return!1;const n=_h(e),r=n[0],s=n[1],o=_h(t),i=o[0],a=o[1];return!(i[0]-s[0]>Ls||r[0]-a[0]>Ls||i[1]-s[1]>Ls||r[1]-a[1]>Ls||i[2]-s[2]>Ls||r[2]-a[2]>Ls)};var ou=wR;const wh=nr,$R=ct;let ER=class Mf{constructor(t){this.plane=null,this.front=null,this.back=null,this.polygontreenodes=[],this.parent=t}invert(){const t=[this];let n;for(let r=0;r<t.length;r++){n=t[r],n.plane&&(n.plane=wh.flip(wh.create(),n.plane)),n.front&&t.push(n.front),n.back&&t.push(n.back);const s=n.front;n.front=n.back,n.back=s}}clipPolygons(t,n){let r={node:this,polygontreenodes:t},s;const o=[];do{if(s=r.node,t=r.polygontreenodes,s.plane){const i=s.plane,a=[],c=[],l=n?a:c,u=t.length;for(let h=0;h<u;h++){const m=t[h];m.isRemoved()||m.splitByPlane(i,l,a,c,a)}s.front&&c.length>0&&o.push({node:s.front,polygontreenodes:c});const d=a.length;if(s.back&&d>0)o.push({node:s.back,polygontreenodes:a});else for(let h=0;h<d;h++)a[h].remove()}r=o.pop()}while(r!==void 0)}clipTo(t,n){let r=this;const s=[];do r.polygontreenodes.length>0&&t.rootnode.clipPolygons(r.polygontreenodes,n),r.front&&s.push(r.front),r.back&&s.push(r.back),r=s.pop();while(r!==void 0)}addPolygonTreeNodes(t){let n={node:this,polygontreenodes:t};const r=[];do{const s=n.node,o=n.polygontreenodes;if(o.length===0){n=r.pop();continue}if(!s.plane){let l=0;l=Math.floor(o.length/2);const u=o[l].getPolygon();s.plane=$R.plane(u)}const i=[],a=[],c=o.length;for(let l=0;l<c;++l)o[l].splitByPlane(s.plane,s.polygontreenodes,a,i,a);i.length>0&&(s.front||(s.front=new Mf(s)),c===i.length&&a.length===0?s.front.polygontreenodes=i:r.push({node:s.front,polygontreenodes:i})),a.length>0&&(s.back||(s.back=new Mf(s)),c===a.length&&i.length===0?s.back.polygontreenodes=a:r.push({node:s.back,polygontreenodes:a})),n=r.pop()}while(n!==void 0)}};var xR=ER;const ks=Ue,AR=(e,t,n)=>{const r=ks.subtract(ks.create(),n,t);let s=(e[3]-ks.dot(e,t))/ks.dot(e,r);return Number.isNaN(s)&&(s=0),s>1&&(s=1),s<0&&(s=0),ks.scale(r,r,s),ks.add(r,t,r),r};var TR=AR;const{EPS:ga}=at,SR=nr,ya=Ue,Ql=ct,PR=TR,OR=(e,t)=>{const n={type:null,front:null,back:null},r=t.vertices,s=r.length,o=Ql.plane(t);if(SR.equals(o,e))n.type=0;else{let i=!1,a=!1;const c=[],l=-ga;for(let u=0;u<s;u++){const d=ya.dot(e,r[u])-e[3],h=d<l;c.push(h),d>ga&&(i=!0),d<l&&(a=!0)}if(!i&&!a){const u=ya.dot(e,o);n.type=u>=0?0:1}else if(!a)n.type=2;else if(!i)n.type=3;else{n.type=4;const u=[],d=[];let h=c[0];for(let w=0;w<s;w++){const p=r[w];let y=w+1;y>=s&&(y=0);const P=c[y];if(h===P)h?d.push(p):u.push(p);else{const F=r[y],L=PR(e,p,F);h?(d.push(p),d.push(L),u.push(L)):(u.push(p),u.push(L),d.push(L))}h=P}const m=ga*ga;if(d.length>=3){let w=d[d.length-1];for(let p=0;p<d.length;p++){const y=d[p];ya.squaredDistance(y,w)<m&&(d.splice(p,1),p--),w=y}}if(u.length>=3){let w=u[u.length-1];for(let p=0;p<u.length;p++){const y=u[p];ya.squaredDistance(y,w)<m&&(u.splice(p,1),p--),w=y}}u.length>=3&&(n.front=Ql.fromPointsAndPlane(u,o)),d.length>=3&&(n.back=Ql.fromPointsAndPlane(d,o))}}return n};var CR=OR;const{EPS:MR}=at,LR=Ue,$h=ct,kR=CR;let RR=class cp{constructor(t,n){this.parent=t,this.children=[],this.polygon=n,this.removed=!1}addPolygons(t){if(!this.isRootNode())throw new Error("Assertion failed");const n=this;t.forEach(r=>{n.addChild(r)})}remove(){if(!this.removed){this.removed=!0,this.polygon=null;const t=this.parent.children,n=t.indexOf(this);if(n<0)throw new Error("Assertion failed");t.splice(n,1),this.parent.recursivelyInvalidatePolygon()}}isRemoved(){return this.removed}isRootNode(){return!this.parent}invert(){if(!this.isRootNode())throw new Error("Assertion failed");this.invertSub()}getPolygon(){if(!this.polygon)throw new Error("Assertion failed");return this.polygon}getPolygons(t){let n=[this];const r=[n];let s,o,i,a;for(s=0;s<r.length;++s)for(n=r[s],o=0,i=n.length;o<i;o++)a=n[o],a.polygon?t.push(a.polygon):a.children.length>0&&r.push(a.children)}splitByPlane(t,n,r,s,o){if(this.children.length){const i=[this.children];let a,c,l,u,d;for(a=0;a<i.length;a++)for(d=i[a],c=0,l=d.length;c<l;c++)u=d[c],u.children.length>0?i.push(u.children):u._splitByPlane(t,n,r,s,o)}else this._splitByPlane(t,n,r,s,o)}_splitByPlane(t,n,r,s,o){const i=this.polygon;if(i){const a=$h.measureBoundingSphere(i),c=a[3]+MR,l=a,u=LR.dot(t,l)-t[3];if(u>c)s.push(this);else if(u<-c)o.push(this);else{const d=kR(t,i);switch(d.type){case 0:n.push(this);break;case 1:r.push(this);break;case 2:s.push(this);break;case 3:o.push(this);break;case 4:if(d.front){const h=this.addChild(d.front);s.push(h)}if(d.back){const h=this.addChild(d.back);o.push(h)}break}}}}addChild(t){const n=new cp(this,t);return this.children.push(n),n}invertSub(){let t=[this];const n=[t];let r,s,o,i;for(r=0;r<n.length;r++)for(t=n[r],s=0,o=t.length;s<o;s++)i=t[s],i.polygon&&(i.polygon=$h.invert(i.polygon)),i.children.length>0&&n.push(i.children)}recursivelyInvalidatePolygon(){this.polygon=null,this.parent&&this.parent.recursivelyInvalidatePolygon()}clear(){let t=[this];const n=[t];for(let r=0;r<n.length;++r){t=n[r];const s=t.length;for(let o=0;o<s;o++){const i=t[o];i.polygon&&(i.polygon=null),i.parent&&(i.parent=null),i.children.length>0&&n.push(i.children),i.children=[]}}}toString(){let t="",n=[this];const r=[n];let s,o,i,a;for(s=0;s<r.length;++s){n=r[s];const c=" ".repeat(s);for(o=0,i=n.length;o<i;o++)a=n[o],t+=`${c}PolygonTreeNode (${a.isRootNode()}): ${a.children.length}`,a.polygon?t+=`
 ${c}polygon: ${a.polygon.vertices}
`:t+=`
`,a.children.length>0&&r.push(a.children)}return t}};var FR=RR;const GR=xR,NR=FR;let DR=class{constructor(t){this.polygonTree=new NR,this.rootnode=new GR(null),t&&this.addPolygons(t)}invert(){this.polygonTree.invert(),this.rootnode.invert()}clipTo(t,n=!1){this.rootnode.clipTo(t,n)}allPolygons(){const t=[];return this.polygonTree.getPolygons(t),t}addPolygons(t){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=this.polygonTree.addChild(t[r]);this.rootnode.addPolygonTreeNodes(n)}clear(){this.polygonTree.clear()}toString(){return"Tree: "+this.polygonTree.toString("")}};var BR=DR,iu={Tree:BR};const ba=et,IR=ou,{Tree:Eh}=iu,VR=(e,t)=>{if(!IR(e,t))return ba.create();const n=new Eh(ba.toPolygons(e)),r=new Eh(ba.toPolygons(t));n.invert(),r.clipTo(n),r.invert(),n.clipTo(r),r.clipTo(n),n.addPolygons(r.allPolygons()),n.invert();const s=n.allPolygons();return ba.create(s)};var zR=VR;const UR=Ze,qR=si,XR=zR,jR=(...e)=>{e=UR(e);let t=e.shift();return e.forEach(n=>{t=XR(t,n)}),t=qR(t),t};var lp=jR;const HR=Ze,YR=et,WR=Or,ZR=ru,QR=su,KR=lp,JR=(...e)=>{e=HR(e);const t=e.map(s=>QR({z0:-1,z1:1},s)),n=KR(t),r=WR(n);return ZR(r,YR.toPolygons(n))};var eF=JR;const tF=Ze,nF=ri,rF=Je,sF=et,oF=eF,iF=lp,aF=(...e)=>{if(e=tF(e),e.length===0)throw new Error("wrong number of arguments");if(!nF(e))throw new Error("only intersect of the types are supported");const t=e[0];return rF.isA(t)?oF(e):sF.isA(t)?iF(e):t};var cF=aF;const Kl=Ue,lF=Or,xh=et,fF=e=>e.sort((t,n)=>t-n).filter((t,n,r)=>!n||t!==r[n-1]),uF=(e,t,n)=>{const r=`${t}`,s=e.get(r);s===void 0?e.set(r,[n]):s.push(n)},dF=(e,t)=>{const n=`${t}`;return e.get(n)},hF=e=>{const t=lF(e),n=xh.toPolygons(e),r=n.length,s=new Map,o=Kl.create();n.forEach((u,d)=>{u.vertices.forEach(h=>{uF(s,Kl.snap(o,h,t),d)})});const i=n.map(u=>{let d=[];return u.vertices.forEach(h=>{d=d.concat(dF(s,Kl.snap(o,h,t)))}),{e:1,d:fF(d)}});s.clear();let a=0;const c=i.length;for(let u=0;u<c;u++){const d=i[u];if(d.e>0){const h=new Array(r);h[u]=!0;do a=0,h.forEach((m,w)=>{const p=i[w];if(p.e>0){p.e=-1;for(let y=0;y<p.d.length;y++)h[p.d[y]]=!0;a++}});while(a>0);d.indexes=h}}const l=[];for(let u=0;u<c;u++)if(i[u].indexes){const d=[];i[u].indexes.forEach((h,m)=>d.push(n[m])),l.push(xh.create(d))}return l};var mF=hF;const vF=Ze,pF=et,gF=mF,yF=(...e)=>{if(e=vF(e),e.length===0)throw new Error("wrong number of arguments");const t=e.map(n=>pF.isA(n)?gF(n):n);return t.length===1?t[0]:t};var bF=yF;const _a=et,_F=ou,{Tree:Ah}=iu,wF=(e,t)=>{if(!_F(e,t))return _a.clone(e);const n=new Ah(_a.toPolygons(e)),r=new Ah(_a.toPolygons(t));n.invert(),n.clipTo(r),r.clipTo(n,!0),n.addPolygons(r.allPolygons()),n.invert();const s=n.allPolygons();return _a.create(s)};var $F=wF;const EF=Ze,xF=si,AF=$F,TF=(...e)=>{e=EF(e);let t=e.shift();return e.forEach(n=>{t=AF(t,n)}),t=xF(t),t};var fp=TF;const SF=Ze,PF=et,OF=Or,CF=ru,MF=su,LF=fp,kF=(...e)=>{e=SF(e);const t=e.map(s=>MF({z0:-1,z1:1},s)),n=LF(t),r=OF(n);return CF(r,PF.toPolygons(n))};var RF=kF;const FF=Ze,GF=ri,NF=Je,DF=et,BF=RF,IF=fp,VF=(...e)=>{if(e=FF(e),e.length===0)throw new Error("wrong number of arguments");if(!GF(e))throw new Error("only subtract of the types are supported");const t=e[0];return NF.isA(t)?BF(e):DF.isA(t)?IF(e):t};var zF=VF;const Vs=et,UF=ou,{Tree:Th}=iu,qF=(e,t)=>{if(!UF(e,t))return XF(e,t);const n=new Th(Vs.toPolygons(e)),r=new Th(Vs.toPolygons(t));n.clipTo(r,!1),r.clipTo(n),r.invert(),r.clipTo(n),r.invert();const s=n.allPolygons().concat(r.allPolygons());return Vs.create(s)},XF=(e,t)=>{let n=Vs.toPolygons(e);return n=n.concat(Vs.toPolygons(t)),Vs.create(n)};var up=qF;const jF=Ze,HF=si,YF=up,WF=(...e)=>{e=jF(e);let t;for(t=1;t<e.length;t+=2)e.push(YF(e[t-1],e[t]));let n=e[t-1];return n=HF(n),n};var dp=WF;const ZF=Ze,QF=et,KF=Or,JF=ru,eG=su,tG=dp,nG=(...e)=>{e=ZF(e);const t=e.map(s=>eG({z0:-1,z1:1},s)),n=tG(t),r=KF(n);return JF(r,QF.toPolygons(n))};var hp=nG;const rG=Ze,sG=ri,oG=Je,iG=et,aG=hp,cG=dp,lG=(...e)=>{if(e=rG(e),e.length===0)throw new Error("wrong number of arguments");if(!sG(e))throw new Error("only unions of the same type are supported");const t=e[0];return oG.isA(t)?aG(e):iG.isA(t)?cG(e):t};var au=lG,fG={intersect:cF,scission:bF,subtract:zF,union:au};const{EPS:uG,TAU:dG}=at,Sh=Av,Fo=Zf,Lt=st,hG=Wa,mG=(e,t)=>{const n={delta:1,corners:"edge",closed:!1,segments:16};let{delta:r,corners:s,closed:o,segments:i}=Object.assign({},n,e);if(Math.abs(r)<uG)return t;let a=e.closed?hG(t):1;a===0&&(a=1);const c=a>0&&r>=0||a<0&&r<0;r=Math.abs(r);let l=null,u=[];const d=[],h=Lt.create(),m=t.length;for(let w=0;w<m;w++){const p=(w+1)%m,y=t[w],P=t[p];c?Lt.subtract(h,y,P):Lt.subtract(h,P,y),Lt.normal(h,h),Lt.normalize(h,h),Lt.scale(h,h,r);const F=Lt.add(Lt.create(),y,h),L=Lt.add(Lt.create(),P,h),k=[F,L];if(l!=null&&(o||!o&&p!==0)){const T=Sh(l[0],l[1],k[0],k[1]);T?(u.pop(),k[0]=T):d.push({c:y,s0:l,s1:k})}l=[F,L],!(p===0&&!o)&&(u.push(k[0]),u.push(k[1]))}if(o&&l!=null){const w=u[0],p=u[1],y=Sh(l[0],l[1],w,p);if(y)u[0]=y,u.pop();else{const P=t[0],F=[w,p];d.push({c:P,s0:l,s1:F})}}if(s==="edge"){const w=new Map;u.forEach((P,F)=>w.set(P,F));const p=Fo.create(),y=Fo.create();d.forEach(P=>{Fo.fromPoints(p,P.s0[0],P.s0[1]),Fo.fromPoints(y,P.s1[0],P.s1[1]);const F=Fo.intersectPointOfLines(p,y);if(Number.isFinite(F[0])&&Number.isFinite(F[1])){const L=P.s0[1],k=w.get(L);u[k]=F,u[(k+1)%u.length]=void 0}else{const L=P.s1[0],k=w.get(L);u[k]=void 0}}),u=u.filter(P=>P!==void 0)}if(s==="round"){let w=Math.floor(i/4);const p=Lt.create();d.forEach(y=>{let P=Lt.angle(Lt.subtract(p,y.s1[0],y.c));if(P-=Lt.angle(Lt.subtract(p,y.s0[1],y.c)),c&&P<0&&(P=P+Math.PI,P<0&&(P=P+Math.PI)),!c&&P>0&&(P=P-Math.PI,P>0&&(P=P-Math.PI)),P!==0){w=Math.floor(i*(Math.abs(P)/dG));const F=P/w,L=Lt.angle(Lt.subtract(p,y.s0[1],y.c)),k=[];for(let T=1;T<w;T++){const R=L+F*T,B=Lt.fromAngleRadians(Lt.create(),R);Lt.scale(B,B,r),Lt.add(B,B,y.c),k.push(B)}if(k.length>0){const T=y.s0[1];let R=u.findIndex(B=>Lt.equals(T,B));R=(R+1)%u.length,u.splice(R,0,...k)}}else{const F=y.s1[0],L=u.findIndex(k=>Lt.equals(F,k));u.splice(L,1)}})}return u};var nc=mG;const wa=Je,vG=nc,pG=(e,t)=>{const n={delta:1,corners:"edge",segments:16},{delta:r,corners:s,segments:o}=Object.assign({},n,e);if(!(s==="edge"||s==="chamfer"||s==="round"))throw new Error('corners must be "edge", "chamfer", or "round"');const c=wa.toOutlines(t).map(l=>(e={delta:r,corners:s,closed:!0,segments:o},vG(e,l))).reduce((l,u)=>l.concat(wa.toSides(wa.fromPoints(u))),[]);return wa.create(c)};var gG=pG;const Ph=wt,yG=Ue,bG=et,Go=ct,_G=(e,t)=>{yG.dot(Go.plane(t),e)>0&&(t=Go.invert(t));const r=[t],s=Go.transform(Ph.fromTranslation(Ph.create(),e),t),o=t.vertices.length;for(let i=0;i<o;i++){const a=i<o-1?i+1:0,c=Go.create([t.vertices[i],s.vertices[i],s.vertices[a],t.vertices[a]]);r.push(c)}return r.push(Go.invert(s)),bG.create(r)};var wG=_G;const{EPS:$G,TAU:Jl}=at,Oh=wt,$t=Ue,EG=ip,ef=et,Zr=ct,xG=Wv,AG=si,tf=up,TG=wG,SG=(e,t,n)=>{const r=t.toString();if(e.has(r))e.get(r)[1].push(n);else{const s=[t,[n]];e.set(r,s)}},PG=(e,t,n)=>{const r=t[0].toString(),s=t[1].toString(),o=r<s?`${r},${s}`:`${s},${r}`;if(e.has(o))e.get(o)[1].push(n);else{const i=[t,[n]];e.set(o,i)}},nf=(e,t)=>{e.findIndex(r=>r===t)<0&&e.push(t)},OG=(e,t)=>{const n={delta:1,segments:12},{delta:r,segments:s}=Object.assign({},n,e);let o=ef.create();const i=new Map,a=new Map,c=$t.create(),l=$t.create();return ef.toPolygons(t).forEach((d,h)=>{const m=$t.scale($t.create(),Zr.plane(d),2*r),w=Zr.transform(Oh.fromTranslation(Oh.create(),$t.scale($t.create(),m,-.5)),d),p=TG(m,w);o=tf(o,p);const y=d.vertices;for(let P=0;P<y.length;P++){SG(i,y[P],Zr.plane(d));const F=(P+1)%y.length,L=[y[P],y[F]];PG(a,L,Zr.plane(d))}}),a.forEach(d=>{const h=d[0],m=d[1],w=h[0],p=h[1],y=$t.subtract($t.create(),p,w);$t.normalize(y,y);const P=m[0],F=$t.cross($t.create(),P,y);let L=[];for(let ce=0;ce<s;ce++)nf(L,ce*Jl/s);for(let ce=0,Oe=m.length;ce<Oe;ce++){const De=m[ce],we=$t.dot(F,De),Xe=$t.dot(P,De);let Fe=Math.atan2(we,Xe);Fe<0&&(Fe+=Jl),nf(L,Fe),Fe=Math.atan2(-we,-Xe),Fe<0&&(Fe+=Jl),nf(L,Fe)}L=L.sort(EG);const k=L.length;let T,R;const B=[],W=[],se=[];for(let ce=-1;ce<k;ce++){const Oe=L[ce<0?ce+k:ce],De=Math.sin(Oe),we=Math.cos(Oe);$t.scale(c,P,we*r),$t.scale(l,F,De*r),$t.add(c,c,l);const Xe=$t.add($t.create(),w,c),Fe=$t.add($t.create(),p,c);let gt=!1;if(ce>=0&&$t.distance(Xe,T)<$G&&(gt=!0),!gt){if(ce>=0){B.push(Xe),W.push(Fe);const kt=[R,Fe,Xe,T],Ln=Zr.create(kt);se.push(Ln)}T=Xe,R=Fe}}W.reverse(),se.push(Zr.create(B)),se.push(Zr.create(W));const fe=ef.create(se);o=tf(o,fe)}),i.forEach(d=>{const h=d[0],m=d[1],w=m[0];let p=null,y=0;for(let k=1;k<m.length;k++){const T=m[k],R=$t.cross(c,w,T),B=$t.length(R);B>.05&&B>y&&(y=B,p=T)}p||(p=$t.orthogonal(c,w));const P=$t.cross(c,w,p);$t.normalize(P,P);const F=$t.cross(l,P,w),L=xG({center:[h[0],h[1],h[2]],radius:r,segments:s,axes:[w,P,F]});o=tf(o,L)}),AG(o)};var CG=OG;const MG=et,LG=au,kG=CG,RG=(e,t)=>{const n={delta:1,corners:"round",segments:12},{delta:r,corners:s,segments:o}=Object.assign({},n,e);if(s!=="round")throw new Error('corners must be "round" for 3D geometries');if(MG.toPolygons(t).length===0)throw new Error("the given geometry cannot be empty");e={delta:r,corners:s,segments:o};const a=kG(e,t);return LG(t,a)};var FG=RG;const GG=Wa,yn=st,Ns=Je,qo=pt,Ch=nc,NG=e=>{let{external:t,internal:n}=e;GG(t)<0?t=t.reverse():n=n.reverse();const r=qo.fromPoints({closed:!0},t),s=qo.fromPoints({closed:!0},n),o=Ns.toSides(Ns.fromPoints(qo.toPoints(r))),i=Ns.toSides(Ns.fromPoints(qo.toPoints(s)));return o.push(...i),Ns.create(o)},DG=(e,t,n,r)=>{const{points:s,external:o,internal:i}=e,a=Math.floor(t/2),c=[],l=[];if(n==="round"&&a>0){const d=Math.PI/a,h=s[s.length-1],m=yn.angle(yn.subtract(yn.create(),o[o.length-1],h)),w=s[0],p=yn.angle(yn.subtract(yn.create(),i[0],w));for(let y=1;y<a;y++){let P=m+d*y,F=yn.fromAngleRadians(yn.create(),P);yn.scale(F,F,r),yn.add(F,F,h),c.push(F),P=p+d*y,F=yn.fromAngleRadians(yn.create(),P),yn.scale(F,F,r),yn.add(F,F,w),l.push(F)}}const u=[];return u.push(...o,...c,...i.reverse(),...l),Ns.fromPoints(u)},BG=(e,t)=>{e=Object.assign({},{delta:1,corners:"edge",segments:16},e);const{delta:r,corners:s,segments:o}=e;if(r<=0)throw new Error("the given delta must be positive for paths");if(!(s==="edge"||s==="chamfer"||s==="round"))throw new Error('corners must be "edge", "chamfer", or "round"');const i=t.isClosed,a=qo.toPoints(t);if(a.length===0)throw new Error("the given geometry cannot be empty");const c={points:a,external:Ch({delta:r,corners:s,segments:o,closed:i},a),internal:Ch({delta:-r,corners:s,segments:o,closed:i},a)};return t.isClosed?NG(c):DG(c,o,s,r)};var IG=BG;const VG=Ze,zG=Je,UG=et,qG=pt,XG=gG,jG=FG,HG=IG,YG=(e,...t)=>{if(t=VG(t),t.length===0)throw new Error("wrong number of arguments");const n=t.map(r=>qG.isA(r)?HG(e,r):zG.isA(r)?XG(e,r):UG.isA(r)?jG(e,r):r);return n.length===1?n[0]:n};var cu=YG;const $a=Je,Mh=Xf,WG=nc,ZG=(e,t)=>{const n={delta:1,corners:"edge",segments:0},{delta:r,corners:s,segments:o}=Object.assign({},n,e);if(!(s==="edge"||s==="chamfer"||s==="round"))throw new Error('corners must be "edge", "chamfer", or "round"');const i=$a.toOutlines(t),c=i.map(l=>(e={delta:i.reduce((h,m)=>h+Mh.arePointsInside(l,Mh.create(m)),0)%2===0?r:-r,corners:s,closed:!0,segments:o},WG(e,l))).reduce((l,u)=>l.concat($a.toSides($a.fromPoints(u))),[]);return $a.create(c)};var QG=ZG;const Lh=pt,KG=nc,JG=(e,t)=>{const n={delta:1,corners:"edge",closed:t.isClosed,segments:16},{delta:r,corners:s,closed:o,segments:i}=Object.assign({},n,e);if(!(s==="edge"||s==="chamfer"||s==="round"))throw new Error('corners must be "edge", "chamfer", or "round"');e={delta:r,corners:s,closed:o,segments:i};const a=KG(e,Lh.toPoints(t));return Lh.fromPoints({closed:o},a)};var eN=JG;const tN=Ze,nN=Je,rN=pt,sN=QG,oN=eN,iN=(e,...t)=>{if(t=tN(t),t.length===0)throw new Error("wrong number of arguments");const n=t.map(r=>rN.isA(r)?oN(e,r):nN.isA(r)?sN(e,r):r);return n.length===1?n[0]:n};var aN=iN,cN={expand:cu,offset:aN};const No=wt,rf=Ue,lN=Je,sf=Ys,fN=Ja,uN=(e,t)=>{const n={offset:[0,0,1],twistAngle:0,twistSteps:12,repair:!0};let{offset:r,twistAngle:s,twistSteps:o,repair:i}=Object.assign({},n,e);if(o<1)throw new Error("twistSteps must be 1 or more");s===0&&(o=1);const a=rf.clone(r),c=lN.toSides(t);if(c.length===0)throw new Error("the given geometry cannot be empty");const l=sf.fromSides(c);a[2]<0&&sf.reverse(l,l);const u=No.create(),d=(h,m,w)=>{const p=m/o*s,y=rf.scale(rf.create(),a,m/o);return No.multiply(u,No.fromZRotation(u,p),No.fromTranslation(No.create(),y)),sf.transform(u,w)};return e={numberOfSlices:o+1,capStart:!0,capEnd:!0,repair:i,callback:d},fN(e,l)};var rc=uN;const dN=Je,hN=pt,mN=rc,vN=(e,t)=>{if(!t.isClosed)throw new Error("extruded path must be closed");const n=hN.toPoints(t),r=dN.fromPoints(n);return mN(e,r)};var pN=vN;const gN=Ze,yN=Je,bN=pt,_N=rc,wN=pN,$N=(e,...t)=>{const n={height:1,twistAngle:0,twistSteps:1,repair:!0},{height:r,twistAngle:s,twistSteps:o,repair:i}=Object.assign({},n,e);if(t=gN(t),t.length===0)throw new Error("wrong number of arguments");e={offset:[0,0,r],twistAngle:s,twistSteps:o,repair:i};const a=t.map(c=>bN.isA(c)?wN(e,c):yN.isA(c)?_N(e,c):c);return a.length===1?a[0]:a};var EN=$N;const xN=pt,AN=cu,TN=rc,SN=(e,t)=>{const n={size:1,height:1},{size:r,height:s}=Object.assign({},n,e);if(e.delta=r,e.offset=[0,0,s],xN.toPoints(t).length===0)throw new Error("the given geometry cannot be empty");const i=AN(e,t);return TN(e,i)};var PN=SN;const{area:ON}=ti,of=Je,CN=pt,MN=cu,LN=rc,kN=(e,t)=>{const n={size:1,height:1},{size:r,height:s}=Object.assign({},n,e);e.delta=r,e.offset=[0,0,s];const o=of.toOutlines(t);if(o.length===0)throw new Error("the given geometry cannot be empty");const a=o.map(l=>(ON(l)<0&&l.reverse(),MN(e,CN.fromPoints({closed:!0},l)))).reduce((l,u)=>l.concat(of.toSides(u)),[]),c=of.create(a);return LN(e,c)};var RN=kN;const FN=Ze,GN=Je,NN=pt,DN=PN,BN=RN,IN=(e,...t)=>{const n={size:1,height:1},{size:r,height:s}=Object.assign({},n,e);if(t=FN(t),t.length===0)throw new Error("wrong number of arguments");if(r<=0)throw new Error("size must be positive");if(s<=0)throw new Error("height must be positive");const o=t.map(i=>NN.isA(i)?DN(e,i):GN.isA(i)?BN(e,i):i);return o.length===1?o[0]:o};var VN=IN;const{TAU:Do}=at,af=Ys,Qn=wt,zN=Ja,UN=Je,qN=(e,t)=>{const n={angle:Do,startAngle:0,pitch:10,endOffset:0,segmentsPerRotation:32},{angle:r,endOffset:s,segmentsPerRotation:o,startAngle:i}=Object.assign({},n,e);let a;if(!e.pitch&&e.height?a=e.height/(r/Do):a=e.pitch?e.pitch:n.pitch,o<3)throw new Error("The number of segments per rotation needs to be at least 3.");const l=UN.toSides(t);if(l.length===0)throw new Error("the given geometry cannot be empty");const u=l.filter(P=>P[0][0]>=0);let d=af.fromSides(l);u.length===0&&(d=af.reverse(d));const h=Math.round(o/Do*Math.abs(r)),m=h>=2?h:2,w=Qn.create();let p;const y=(P,F,L)=>{const k=i+r/m*F,T=s/m*F,R=(k-i)/Do*a;return Qn.multiply(w,Qn.fromTranslation(Qn.create(),[T,0,R*Math.sign(r)]),Qn.fromXRotation(Qn.create(),-Do/4*Math.sign(r))),p=Qn.create(),Qn.multiply(p,Qn.fromZRotation(Qn.create(),k),w),af.transform(p,L)};return zN({numberOfSlices:m+1,callback:y},d)};var XN=qN;const jN=Ze,kh=Wf,cf=nr,Rh=wt,Fh=Je,mp=et,Rs=ct,HN=Or,YN=hp,WN=(e,t)=>{const n=cf.fromNormalAndPoint(cf.create(),e.axis,e.origin);if(Number.isNaN(n[0])||Number.isNaN(n[1])||Number.isNaN(n[2])||Number.isNaN(n[3]))throw new Error("project: invalid axis or origin");const r=HN(t),s=r*r*Math.sqrt(3)/4;if(r===0)return Fh.create();const o=mp.toPolygons(t);let i=[];for(let c=0;c<o.length;c++){const l=o[c].vertices.map(h=>cf.projectionOfPoint(n,h)),u=Rs.create(l),d=Rs.plane(u);kh(n,d)&&(Rs.measureArea(u)<s||i.push(u))}if(!kh(n,[0,0,1])){const c=Rh.fromVectorRotation(Rh.create(),n,[0,0,1]);i=i.map(l=>Rs.transform(c,l))}i=i.sort((c,l)=>Rs.measureArea(l)-Rs.measureArea(c));const a=i.map(c=>Fh.fromPoints(c.vertices));return YN(a)},ZN=(e,...t)=>{const n={axis:[0,0,1],origin:[0,0,0]},{axis:r,origin:s}=Object.assign({},n,e);if(t=jN(t),t.length===0)throw new Error("wrong number of arguments");e={axis:r,origin:s};const o=t.map(i=>mp.isA(i)?WN(e,i):i);return o.length===1?o[0]:o};var QN=ZN,KN={extrudeFromSlices:Ja,extrudeLinear:EN,extrudeRectangular:VN,extrudeRotate:rp,extrudeHelical:XN,project:QN,slice:Ys};const Gh=st,JN=e=>{let t=Gh.fromValues(1/0,1/0);e.forEach(s=>{(s[1]<t[1]||s[1]===t[1]&&s[0]<t[0])&&(t=s)});const n=[];e.forEach(s=>{const o=tD(s[1]-t[1],s[0]-t[0]),i=Gh.squaredDistance(s,t);n.push({point:s,angle:o,distSq:i})}),n.sort((s,o)=>s.angle!==o.angle?s.angle-o.angle:s.distSq-o.distSq);const r=[];return n.forEach(s=>{let o=r.length;for(;o>1&&eD(r[o-2],r[o-1],s.point)<=Number.EPSILON;)r.pop(),o=r.length;r.push(s.point)}),r},eD=(e,t,n)=>(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0]),tD=(e,t)=>e===0&&t===0?-1/0:-t/e;var vp=JN;const Nh=Je,Dh=et,Bh=pt,nD=e=>{const t=new Set,n=[],r=s=>{const o=s.toString();t.has(o)||(n.push(s),t.add(o))};return e.forEach(s=>{Nh.isA(s)?Nh.toPoints(s).forEach(r):Dh.isA(s)?Dh.toPoints(s).forEach(o=>o.forEach(r)):Bh.isA(s)&&Bh.toPoints(s).forEach(r)}),n};var lu=nD;const rD=Ze,sD=pt,oD=vp,iD=lu,aD=(...e)=>{e=rD(e);const t=iD(e),n=oD(t);return sD.fromPoints({closed:!0},n)};var cD=aD;const lD=Ze,Ih=Je,fD=vp,uD=lu,dD=(...e)=>{e=lD(e);const t=uD(e),n=fD(t);return n.length<3?Ih.create():Ih.fromPoints(n)};var hD=dD;const mD=Jo,Vh=za,zh=Um,vD=(e,t,n)=>{const r=[],s=[],o=[];Vh(r,n,t),Vh(s,e,t);const i=zh(mD(o,s,r)),a=zh(r);if(a===0)throw Error("a and b are the same point");return i/a},pD=(e,t,n)=>Math.sqrt(vD(e,t,n));var gD=pD;const yD=Jo,bD=Bf,Uh=za,_D=(e,t,n,r)=>{const s=[0,0,0];return Uh(e,t,n),Uh(s,n,r),yD(e,e,s),bD(e,e)};var wD=_D;let $D=class{constructor(){this.head=null,this.tail=null}clear(){this.head=this.tail=null}insertBefore(t,n){n.prev=t.prev,n.next=t,n.prev?n.prev.next=n:this.head=n,t.prev=n}insertAfter(t,n){n.prev=t,n.next=t.next,n.next?n.next.prev=n:this.tail=n,t.next=n}add(t){this.head?this.tail.next=t:this.head=t,t.prev=this.tail,t.next=null,this.tail=t}addAll(t){for(this.head?this.tail.next=t:this.head=t,t.prev=this.tail;t.next;)t=t.next;this.tail=t}remove(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev}removeChain(t,n){t.prev?t.prev.next=n.next:this.head=n.next,n.next?n.next.prev=t.prev:this.tail=t.prev}first(){return this.head}isEmpty(){return!this.head}};var ED=$D;let xD=class{constructor(t,n){this.point=t,this.index=n,this.next=null,this.prev=null,this.face=null}};var AD=xD;const TD=Nm,SD=zm;let PD=class{constructor(t,n){this.vertex=t,this.face=n,this.next=null,this.prev=null,this.opposite=null}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){return this.tail()?TD(this.tail().point,this.head().point):-1}lengthSquared(){return this.tail()?SD(this.tail().point,this.head().point):-1}setOpposite(t){this.opposite=t,t.opposite=this}};var OD=PD;const lf=Fm,CD=Gm,MD=Jo,ff=Ia,LD=Dm,kD=Bf,Ea=Vm,uf=za,df=OD,pp=0,RD=1,Lf=2;let FD=class gp{constructor(){this.normal=[],this.centroid=[],this.offset=0,this.outside=null,this.mark=pp,this.edge=null,this.nVertices=0}getEdge(t){if(typeof t!="number")throw Error("requires a number");let n=this.edge;for(;t>0;)n=n.next,t-=1;for(;t<0;)n=n.prev,t+=1;return n}computeNormal(){const t=this.edge,n=t.next;let r=n.next;const s=uf([],n.head().point,t.head().point),o=[],i=[];for(this.nVertices=2,this.normal=[0,0,0];r!==t;)CD(i,s),uf(s,r.head().point,t.head().point),lf(this.normal,this.normal,MD(o,i,s)),r=r.next,this.nVertices+=1;this.area=LD(this.normal),this.normal=Ea(this.normal,this.normal,1/this.area)}computeNormalMinArea(t){if(this.computeNormal(),this.area<t){let n,r=0,s=this.edge;do{const u=s.lengthSquared();u>r&&(n=s,r=u),s=s.next}while(s!==this.edge);const o=n.tail().point,i=n.head().point,a=uf([],i,o),c=Math.sqrt(r);Ea(a,a,1/c);const l=ff(this.normal,a);Ea(a,a,-l),lf(this.normal,this.normal,a),kD(this.normal,this.normal)}}computeCentroid(){this.centroid=[0,0,0];let t=this.edge;do lf(this.centroid,this.centroid,t.head().point),t=t.next;while(t!==this.edge);Ea(this.centroid,this.centroid,1/this.nVertices)}computeNormalAndCentroid(t){typeof t<"u"?this.computeNormalMinArea(t):this.computeNormal(),this.computeCentroid(),this.offset=ff(this.normal,this.centroid)}distanceToPlane(t){return ff(this.normal,t)-this.offset}connectHalfEdges(t,n){let r;if(t.opposite.face===n.opposite.face){const s=n.opposite.face;let o;t===this.edge&&(this.edge=n),s.nVertices===3?(o=n.opposite.prev.opposite,s.mark=Lf,r=s):(o=n.opposite.next,s.edge===o.prev&&(s.edge=o),o.prev=o.prev.prev,o.prev.next=o),n.prev=t.prev,n.prev.next=n,n.setOpposite(o),s.computeNormalAndCentroid()}else t.next=n,n.prev=t;return r}mergeAdjacentFaces(t,n){const r=t.opposite,s=r.face;n.push(s),s.mark=Lf;let o=t.prev,i=t.next,a=r.prev,c=r.next;for(;o.opposite.face===s;)o=o.prev,c=c.next;for(;i.opposite.face===s;)i=i.next,a=a.prev;let l;for(l=c;l!==a.next;l=l.next)l.face=this;this.edge=i;let u;return u=this.connectHalfEdges(a,i),u&&n.push(u),u=this.connectHalfEdges(o,c),u&&n.push(u),this.computeNormalAndCentroid(),n}collectIndices(){const t=[];let n=this.edge;do t.push(n.head().index),n=n.next;while(n!==this.edge);return t}static createTriangle(t,n,r,s=0){const o=new gp,i=new df(t,o),a=new df(n,o),c=new df(r,o);return i.next=c.prev=a,a.next=i.prev=c,c.next=a.prev=i,o.edge=i,o.computeNormalAndCentroid(s),o}};var GD={VISIBLE:pp,NON_CONVEX:RD,DELETED:Lf,Face:FD};const hf=Ia,ND=gD,DD=wD,qh=ED,BD=AD,{Face:fr,VISIBLE:Fs,NON_CONVEX:Xh,DELETED:ID}=GD,VD=1,jh=2;let zD=class{constructor(t){if(!Array.isArray(t))throw TypeError("input is not a valid array");if(t.length<4)throw Error("cannot build a simplex out of <4 points");this.tolerance=-1,this.nFaces=0,this.nPoints=t.length,this.faces=[],this.newFaces=[],this.claimed=new qh,this.unclaimed=new qh,this.vertices=[];for(let n=0;n<t.length;n+=1)this.vertices.push(new BD(t[n],n));this.discardedFaces=[],this.vertexPointIndices=[]}addVertexToFace(t,n){t.face=n,n.outside?this.claimed.insertBefore(n.outside,t):this.claimed.add(t),n.outside=t}removeVertexFromFace(t,n){t===n.outside&&(t.next&&t.next.face===n?n.outside=t.next:n.outside=null),this.claimed.remove(t)}removeAllVerticesFromFace(t){if(t.outside){let n=t.outside;for(;n.next&&n.next.face===t;)n=n.next;return this.claimed.removeChain(t.outside,n),n.next=null,t.outside}}deleteFaceVertices(t,n){const r=this.removeAllVerticesFromFace(t);if(r)if(!n)this.unclaimed.addAll(r);else{let s;for(let o=r;o;o=s)s=o.next,n.distanceToPlane(o.point)>this.tolerance?this.addVertexToFace(o,n):this.unclaimed.add(o)}}resolveUnclaimedPoints(t){let n=this.unclaimed.first();for(let r=n;r;r=n){n=r.next;let s=this.tolerance,o;for(let i=0;i<t.length;i+=1){const a=t[i];if(a.mark===Fs){const c=a.distanceToPlane(r.point);if(c>s&&(s=c,o=a),s>1e3*this.tolerance)break}}o&&this.addVertexToFace(r,o)}}computeExtremes(){const t=[],n=[],r=[],s=[];let o,i;for(o=0;o<3;o+=1)r[o]=s[o]=this.vertices[0];for(o=0;o<3;o+=1)t[o]=n[o]=this.vertices[0].point[o];for(o=1;o<this.vertices.length;o+=1){const a=this.vertices[o],c=a.point;for(i=0;i<3;i+=1)c[i]<t[i]&&(t[i]=c[i],r[i]=a);for(i=0;i<3;i+=1)c[i]>n[i]&&(n[i]=c[i],s[i]=a)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(t[0]),Math.abs(n[0]))+Math.max(Math.abs(t[1]),Math.abs(n[1]))+Math.max(Math.abs(t[2]),Math.abs(n[2]))),[r,s]}createInitialSimplex(){const t=this.vertices,[n,r]=this.computeExtremes();let s,o,i,a,c=0,l=0;for(i=0;i<3;i+=1){const p=r[i].point[i]-n[i].point[i];p>c&&(c=p,l=i)}const u=n[l],d=r[l];for(c=0,i=0;i<this.vertices.length;i+=1){const p=this.vertices[i];if(p!==u&&p!==d){const y=ND(p.point,u.point,d.point);y>c&&(c=y,s=p)}}const h=DD([],u.point,d.point,s.point),m=hf(u.point,h);for(c=-1,i=0;i<this.vertices.length;i+=1){const p=this.vertices[i];if(p!==u&&p!==d&&p!==s){const y=Math.abs(hf(h,p.point)-m);y>c&&(c=y,o=p)}}const w=[];if(hf(o.point,h)-m<0)for(w.push(fr.createTriangle(u,d,s),fr.createTriangle(o,d,u),fr.createTriangle(o,s,d),fr.createTriangle(o,u,s)),i=0;i<3;i+=1){const p=(i+1)%3;w[i+1].getEdge(2).setOpposite(w[0].getEdge(p)),w[i+1].getEdge(1).setOpposite(w[p+1].getEdge(0))}else for(w.push(fr.createTriangle(u,s,d),fr.createTriangle(o,u,d),fr.createTriangle(o,d,s),fr.createTriangle(o,s,u)),i=0;i<3;i+=1){const p=(i+1)%3;w[i+1].getEdge(2).setOpposite(w[0].getEdge((3-i)%3)),w[i+1].getEdge(0).setOpposite(w[p+1].getEdge(1))}for(i=0;i<4;i+=1)this.faces.push(w[i]);for(i=0;i<t.length;i+=1){const p=t[i];if(p!==u&&p!==d&&p!==s&&p!==o){c=this.tolerance;let y;for(a=0;a<4;a+=1){const P=w[a].distanceToPlane(p.point);P>c&&(c=P,y=w[a])}y&&this.addVertexToFace(p,y)}}}reindexFaceAndVertices(){const t=[];for(let n=0;n<this.faces.length;n+=1){const r=this.faces[n];r.mark===Fs&&t.push(r)}this.faces=t}collectFaces(t){const n=[];for(let r=0;r<this.faces.length;r+=1){if(this.faces[r].mark!==Fs)throw Error("attempt to include a destroyed face in the hull");const s=this.faces[r].collectIndices();if(t)n.push(s);else for(let o=0;o<s.length-2;o+=1)n.push([s[0],s[o+1],s[o+2]])}return n}nextVertexToAdd(){if(!this.claimed.isEmpty()){let t,n,r=0;const s=this.claimed.first().face;for(n=s.outside;n&&n.face===s;n=n.next){const o=s.distanceToPlane(n.point);o>r&&(r=o,t=n)}return t}}computeHorizon(t,n,r,s){this.deleteFaceVertices(r),r.mark=ID;let o;n?o=n.next:o=n=r.getEdge(0);do{const i=o.opposite,a=i.face;a.mark===Fs&&(a.distanceToPlane(t)>this.tolerance?this.computeHorizon(t,i,a,s):s.push(o)),o=o.next}while(o!==n)}addAdjoiningFace(t,n){const r=fr.createTriangle(t,n.tail(),n.head());return this.faces.push(r),r.getEdge(-1).setOpposite(n.opposite),r.getEdge(0)}addNewFaces(t,n){this.newFaces=[];let r,s;for(let o=0;o<n.length;o+=1){const i=n[o],a=this.addAdjoiningFace(t,i);r?a.next.setOpposite(s):r=a,this.newFaces.push(a.face),s=a}r.next.setOpposite(s)}oppositeFaceDistance(t){return t.face.distanceToPlane(t.opposite.face.centroid)}doAdjacentMerge(t,n){let r=t.edge,s=!0,o=0;do{if(o>=t.nVertices)throw Error("merge recursion limit exceeded");const i=r.opposite.face;let a=!1;if(n===jh?(this.oppositeFaceDistance(r)>-this.tolerance||this.oppositeFaceDistance(r.opposite)>-this.tolerance)&&(a=!0):t.area>i.area?this.oppositeFaceDistance(r)>-this.tolerance?a=!0:this.oppositeFaceDistance(r.opposite)>-this.tolerance&&(s=!1):this.oppositeFaceDistance(r.opposite)>-this.tolerance?a=!0:this.oppositeFaceDistance(r)>-this.tolerance&&(s=!1),a){const c=t.mergeAdjacentFaces(r,[]);for(let l=0;l<c.length;l+=1)this.deleteFaceVertices(c[l],t);return!0}r=r.next,o+=1}while(r!==t.edge);return s||(t.mark=Xh),!1}addVertexToHull(t){const n=[];this.unclaimed.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,n),this.addNewFaces(t,n);for(let r=0;r<this.newFaces.length;r+=1){const s=this.newFaces[r];if(s.mark===Fs)for(;this.doAdjacentMerge(s,VD););}for(let r=0;r<this.newFaces.length;r+=1){const s=this.newFaces[r];if(s.mark===Xh)for(s.mark=Fs;this.doAdjacentMerge(s,jh););}this.resolveUnclaimedPoints(this.newFaces)}build(){let t;for(this.createInitialSimplex();t=this.nextVertexToAdd();)this.addVertexToHull(t);this.reindexFaceAndVertices()}};var UD=zD;const qD=UD,XD=(e,t={})=>{const n=new qD(e);return n.build(),n.collectFaces(t.skipTriangulation)};var jD=XD;const HD=Ze,YD=et,WD=ct,ZD=jD,QD=lu,KD=(...e)=>{if(e=HD(e),e.length===1)return e[0];const t=QD(e),r=ZD(t,{skipTriangulation:!0}).map(s=>{const o=s.map(i=>t[i]);return WD.create(o)});return YD.create(r)};var JD=KD;const e7=Ze,t7=ri,n7=Je,r7=et,s7=pt,o7=cD,i7=hD,a7=JD,c7=(...e)=>{if(e=e7(e),e.length===0)throw new Error("wrong number of arguments");if(!t7(e))throw new Error("only hulls of the same type are supported");const t=e[0];return s7.isA(t)?o7(e):n7.isA(t)?i7(e):r7.isA(t)?a7(e):t};var yp=c7;const l7=Ze,f7=au,u7=yp,d7=(...e)=>{if(e=l7(e),e.length<2)throw new Error("wrong number of arguments");const t=[];for(let n=1;n<e.length;n++)t.push(u7(e[n-1],e[n]));return f7(t)};var h7=d7,m7={hull:yp,hullChain:h7};const mf=Ue,bp=ct,v7=(e,t)=>{const n=Math.abs(bp.measureArea(t));return Number.isFinite(n)&&n>e},p7=(e,t)=>{let n=t.map(s=>{const o=s.vertices.map(c=>mf.snap(mf.create(),c,e)),i=[];for(let c=0;c<o.length;c++){const l=(c+1)%o.length;mf.equals(o[c],o[l])||i.push(o[c])}const a=bp.create(i);return s.color&&(a.color=s.color),a});const r=e*e*Math.sqrt(3)/4;return n=n.filter(s=>v7(r,s)),n};var _p=p7;const g7=Wf,Ds=Ue,Na=ct,y7=e=>{const t=Na.toPoints(e),n=[];for(let r=0;r<t.length;r++){const s=(r+1)%t.length,o={v1:t[r],v2:t[s]};n.push(o)}for(let r=0;r<n.length;r++){const s=(r+1)%t.length;n[r].next=n[s],n[s].prev=n[r]}return n},b7=(e,t)=>{const n=`${t.v1}:${t.v2}`;e.set(n,t)},vf=(e,t)=>{const n=`${t.v1}:${t.v2}`;e.delete(n)},_7=(e,t)=>{const n=`${t.v2}:${t.v1}`;return e.get(n)},w7=(e,t,n)=>{let r=e.prev.v1,s=e.prev.v2,o=t.next.v2;const i=Hh(r,s,o,n);r=t.prev.v1,s=t.prev.v2,o=e.next.v2;const a=Hh(r,s,o,n);return[i,a]},$7=Ds.create(),E7=Ds.create(),Hh=(e,t,n,r)=>{const s=Ds.subtract($7,t,e),o=Ds.subtract(E7,n,t);return Ds.cross(s,s,o),Ds.dot(s,r)},x7=e=>{let t;const n=[];for(;e.next;){const r=e.next;n.push(e.v1),e.v1=null,e.v2=null,e.next=null,e.prev=null,e=r}return n.length>0&&(t=Na.create(n)),t},A7=e=>{if(e.length<2)return e;const t=e[0].plane,n=e.slice(),r=new Map;for(;n.length>0;){const o=n.shift(),i=y7(o);for(let a=0;a<i.length;a++){const c=i[a],l=_7(r,c);if(l){const u=w7(c,l,t);if(u[0]>=0&&u[1]>=0){const d=l.next,h=c.next;c.prev.next=l.next,c.next.prev=l.prev,l.prev.next=c.next,l.next.prev=c.prev,c.v1=null,c.v2=null,c.next=null,c.prev=null,vf(r,l),l.v1=null,l.v2=null,l.next=null,l.prev=null;const m=(w,p,y)=>{const P={v1:y.v1,v2:p.v2,next:p.next,prev:y.prev};y.prev.next=P,p.next.prev=P,vf(w,p),p.v1=null,p.v2=null,p.next=null,p.prev=null,vf(w,y),y.v1=null,y.v2=null,y.next=null,y.prev=null};u[0]===0&&m(r,d,d.prev),u[1]===0&&m(r,h,h.prev)}}else c.next&&b7(r,c)}}const s=[];return r.forEach(o=>{const i=x7(o);i&&s.push(i)}),r.clear(),s},T7=(e,t)=>Math.abs(e[3]-t[3])<15e-8?g7(e,t):!1,S7=(e,t)=>{const n=[];t.forEach(s=>{const o=n.find(i=>T7(i[0],Na.plane(s)));o?o[1].push(s):n.push([Na.plane(s),[s]])});let r=[];return n.forEach(s=>{const o=s[1],i=A7(o);r=r.concat(i)}),r};var P7=S7;const Yh=at,Kn=Ue,O7=ct,hn=e=>`${e}`,Wh=(e,t,n,r,s,o)=>{const i=hn(r),a=hn(s),c=`${i}/${a}`,l=`${a}/${i}`;if(e.has(l))return Oa(e,t,n,s,r,null),null;const u={vertex0:r,vertex1:s,polygonindex:o};return e.has(c)?e.get(c).push(u):e.set(c,[u]),t.has(i)?t.get(i).push(c):t.set(i,[c]),n.has(a)?n.get(a).push(c):n.set(a,[c]),c},Oa=(e,t,n,r,s,o)=>{const i=hn(r),a=hn(s),c=`${i}/${a}`;let l=-1;const u=e.get(c);for(let d=0;d<u.length;d++){const h=u[d];let m=hn(h.vertex0);if(m===i&&(m=hn(h.vertex1),m===a&&!(o!==null&&h.polygonindex!==o))){l=d;break}}u.splice(l,1),u.length===0&&e.delete(c),l=t.get(i).indexOf(c),t.get(i).splice(l,1),t.get(i).length===0&&t.delete(i),l=n.get(a).indexOf(c),n.get(a).splice(l,1),n.get(a).length===0&&n.delete(a)},C7=e=>{const t=new Map;for(let n=0;n<e.length;n++){const r=e[n],s=r.vertices.length;if(s>=3){let o=r.vertices[0],i=hn(o);for(let a=0;a<s;a++){let c=a+1;c===s&&(c=0);const l=r.vertices[c],u=hn(l),d=`${i}/${u}`,h=`${u}/${i}`;if(t.has(h)){const m=t.get(h);m.splice(-1,1),m.length===0&&t.delete(h)}else{const m={vertex0:o,vertex1:l,polygonindex:n};t.has(d)?t.get(d).push(m):t.set(d,[m])}o=l,i=u}}else console.warn("warning: invalid polygon found during insertTjunctions")}if(t.size>0){const n=new Map,r=new Map,s=new Map;for(const[i,a]of t)s.set(i,!0),a.forEach(c=>{const l=hn(c.vertex0),u=hn(c.vertex1);n.has(l)?n.get(l).push(i):n.set(l,[i]),r.has(u)?r.get(u).push(i):r.set(u,[i])});const o=e.slice(0);for(;t.size!==0;){for(const a of t.keys())s.set(a,!0);let i=!1;for(;;){const a=Array.from(s.keys());if(a.length===0)break;const c=a[0];let l=!0;if(t.has(c)){const d=t.get(c)[0];for(let h=0;h<2;h++){const m=h===0?d.vertex0:d.vertex1,w=h===0?d.vertex1:d.vertex0,p=hn(m),y=hn(w);let P=[];h===0?r.has(p)&&(P=r.get(p)):n.has(p)&&(P=n.get(p));for(let F=0;F<P.length;F++){const L=P[F],k=t.get(L)[0],T=h===0?k.vertex0:k.vertex1;if(h===0?k.vertex1:k.vertex0,hn(T)===y){Oa(t,n,r,m,w,null),Oa(t,n,r,w,m,null),l=!1,h=2,i=!0;break}else{const B=m,W=w,se=T,fe=Kn.subtract(Kn.create(),se,B),ce=Kn.dot(Kn.subtract(Kn.create(),W,B),fe)/Kn.dot(fe,fe);if(ce>0&&ce<1){const Oe=Kn.scale(Kn.create(),fe,ce);if(Kn.add(Oe,Oe,B),Kn.squaredDistance(Oe,W)<Yh.EPS*Yh.EPS){const we=k.polygonindex,Xe=o[we],Fe=hn(k.vertex1);let gt=-1;for(let $n=0;$n<Xe.vertices.length;$n++)if(hn(Xe.vertices[$n])===Fe){gt=$n;break}const kt=Xe.vertices.slice(0);kt.splice(gt,0,w);const Ln=O7.create(kt);o[we]=Ln,Oa(t,n,r,k.vertex0,k.vertex1,we);const qt=Wh(t,n,r,k.vertex0,w,we),Pn=Wh(t,n,r,w,k.vertex1,we);qt!==null&&s.set(qt,!0),Pn!==null&&s.set(Pn,!0),l=!1,h=2,i=!0;break}}}}}}l&&s.delete(c)}if(!i)break}e=o}return t.clear(),e};var M7=C7;const pf=Ue,gf=ct,L7=(e,t,n)=>{const r=t.vertices.length;if(r>3){if(r>4){const i=[0,0,0];t.vertices.forEach(a=>pf.add(i,i,a)),pf.snap(i,pf.divide(i,i,[r,r,r]),e);for(let a=0;a<r;a++){const c=gf.create([i,t.vertices[a],t.vertices[(a+1)%r]]);t.color&&(c.color=t.color),n.push(c)}return}const s=gf.create([t.vertices[0],t.vertices[1],t.vertices[2]]),o=gf.create([t.vertices[0],t.vertices[2],t.vertices[3]]);t.color&&(s.color=t.color,o.color=t.color),n.push(s,o);return}n.push(t)},k7=(e,t)=>{const n=[];return t.forEach(r=>{L7(e,r,n)}),n};var R7=k7;const F7=Ze,G7=Or,N7=Je,wp=et,D7=pt,B7=_p,I7=P7,V7=M7,z7=R7,U7=(e,t)=>t,q7=(e,t)=>t,X7=(e,t)=>{const n={snap:!1,simplify:!1,triangulate:!1},{snap:r,simplify:s,triangulate:o}=Object.assign({},n,e),i=G7(t);let a=wp.toPolygons(t);r&&(a=B7(i,a)),s&&(a=I7(i,a)),o&&(a=V7(a),a=z7(i,a));const c=Object.assign({},t);return c.polygons=a,c},j7=(e,...t)=>{if(t=F7(t),t.length===0)throw new Error("wrong number of arguments");const n=t.map(r=>{if(D7.isA(r))return U7(e,r);if(N7.isA(r))return q7(e,r);if(wp.isA(r))return X7(e,r);throw new Error("invalid geometry")});return n.length===1?n[0]:n};var H7=j7;const Y7=Ze,Jr=st,kf=Je,Rf=et,Ff=pt,fu=Or,W7=_p,Z7=e=>{const t=fu(e),r=Ff.toPoints(e).map(s=>Jr.snap(Jr.create(),s,t));return Ff.create(r)},Q7=e=>{const t=fu(e);let r=kf.toSides(e).map(s=>[Jr.snap(Jr.create(),s[0],t),Jr.snap(Jr.create(),s[1],t)]);return r=r.filter(s=>!Jr.equals(s[0],s[1])),kf.create(r)},K7=e=>{const t=fu(e),n=Rf.toPolygons(e),r=W7(t,n);return Rf.create(r)},J7=(...e)=>{if(e=Y7(e),e.length===0)throw new Error("wrong number of arguments");const t=e.map(n=>Ff.isA(n)?Z7(n):kf.isA(n)?Q7(n):Rf.isA(n)?K7(n):n);return t.length===1?t[0]:t};var eB=J7,tB={generalize:H7,snap:eB,retessellate:si};const nB=(e,t,n)=>{for(e=e.slice();e.length<n;)e.push(t);return e};var rB=nB;const sB=Ze,Zh=rB,$p=Qf,{translate:oB}=ts,iB=e=>{if(!Array.isArray(e.modes)||e.modes.length>3)throw new Error("align(): modes must be an array of length <= 3");if(e.modes=Zh(e.modes,"none",3),e.modes.filter(t=>["center","max","min","none"].includes(t)).length!==3)throw new Error('align(): all modes must be one of "center", "max" or "min"');if(!Array.isArray(e.relativeTo)||e.relativeTo.length>3)throw new Error("align(): relativeTo must be an array of length <= 3");if(e.relativeTo=Zh(e.relativeTo,0,3),e.relativeTo.filter(t=>Number.isFinite(t)||t==null).length!==3)throw new Error("align(): all relativeTo values must be a number, or null.");if(typeof e.grouped!="boolean")throw new Error("align(): grouped must be a boolean value.");return e},aB=(e,t,n)=>{for(let r=0;r<3;r++)e[r]==null&&(t[r]==="center"?e[r]=(n[0][r]+n[1][r])/2:t[r]==="max"?e[r]=n[1][r]:t[r]==="min"&&(e[r]=n[0][r]));return e},Qh=(e,t,n)=>{const r=$p(e),s=[0,0,0];for(let o=0;o<3;o++)t[o]==="center"?s[o]=n[o]-(r[0][o]+r[1][o])/2:t[o]==="max"?s[o]=n[o]-r[1][o]:t[o]==="min"&&(s[o]=n[o]-r[0][o]);return oB(s,e)},cB=(e,...t)=>{e=Object.assign({},{modes:["center","center","min"],relativeTo:[0,0,0],grouped:!1},e),e=iB(e);let{modes:r,relativeTo:s,grouped:o}=e;if(t=sB(t),t.length===0)throw new Error("align(): No geometries were provided to act upon");if(s.filter(i=>i==null).length){const i=$p(t);s=aB(s,r,i)}return o?t=Qh(t,r,s):t=t.map(i=>Qh(i,r,s)),t.length===1?t[0]:t};var lB=cB;const fB=Ze,uB=Je,dB=et,hB=pt,mB=ss,{translate:vB}=ts,yf=(e,t)=>{const n={axes:[!0,!0,!0],relativeTo:[0,0,0]},{axes:r,relativeTo:s}=Object.assign({},n,e),o=mB(t),i=[0,0,0];return r[0]&&(i[0]=s[0]-(o[0][0]+(o[1][0]-o[0][0])/2)),r[1]&&(i[1]=s[1]-(o[0][1]+(o[1][1]-o[0][1])/2)),r[2]&&(i[2]=s[2]-(o[0][2]+(o[1][2]-o[0][2])/2)),vB(i,t)},sc=(e,...t)=>{const n={axes:[!0,!0,!0],relativeTo:[0,0,0]},{axes:r,relativeTo:s}=Object.assign({},n,e);if(t=fB(t),t.length===0)throw new Error("wrong number of arguments");if(s.length!==3)throw new Error("relativeTo must be an array of length 3");e={axes:r,relativeTo:s};const o=t.map(i=>hB.isA(i)||uB.isA(i)||dB.isA(i)?yf(e,i):i);return o.length===1?o[0]:o},pB=(...e)=>sc({axes:[!0,!1,!1]},e),gB=(...e)=>sc({axes:[!1,!0,!1]},e),yB=(...e)=>sc({axes:[!1,!1,!0]},e);var xa={center:sc,centerX:pB,centerY:gB,centerZ:yB};const bB=Ze,Kh=wt,Jh=Je,em=et,tm=pt,oc=(e,...t)=>{if(!Array.isArray(e))throw new Error("factors must be an array");if(t=bB(t),t.length===0)throw new Error("wrong number of arguments");for(e=e.slice();e.length<3;)e.push(1);if(e[0]<=0||e[1]<=0||e[2]<=0)throw new Error("factors must be positive");const n=Kh.fromScaling(Kh.create(),e),r=t.map(s=>tm.isA(s)?tm.transform(n,s):Jh.isA(s)?Jh.transform(n,s):em.isA(s)?em.transform(n,s):s);return r.length===1?r[0]:r},_B=(e,...t)=>oc([e,1,1],t),wB=(e,...t)=>oc([1,e,1],t),$B=(e,...t)=>oc([1,1,e],t);var Aa={scale:oc,scaleX:_B,scaleY:wB,scaleZ:$B};const EB=Ze,nm=Je,rm=et,sm=pt,xB=(e,...t)=>{if(t=EB(t),t.length===0)throw new Error("wrong number of arguments");const n=t.map(r=>sm.isA(r)?sm.transform(e,r):nm.isA(r)?nm.transform(e,r):rm.isA(r)?rm.transform(e,r):r);return n.length===1?n[0]:n};var AB=xB,TB={align:lB,center:xa.center,centerX:xa.centerX,centerY:xa.centerY,centerZ:xa.centerZ,mirror:Vo.mirror,mirrorX:Vo.mirrorX,mirrorY:Vo.mirrorY,mirrorZ:Vo.mirrorZ,rotate:Uo.rotate,rotateX:Uo.rotateX,rotateY:Uo.rotateY,rotateZ:Uo.rotateZ,scale:Aa.scale,scaleX:Aa.scaleX,scaleY:Aa.scaleY,scaleZ:Aa.scaleZ,transform:AB,translate:ts.translate,translateX:ts.translateX,translateY:ts.translateY,translateZ:ts.translateZ},xt={colors:kP,curves:WP,geometries:jf,maths:CC,measurements:H8,primitives:Ok,text:Ik,utils:ap,booleans:fG,expansions:cN,extrusions:KN,hulls:m7,modifiers:tB,transforms:TB};const{geometries:bf}=xt,SB=(e,t)=>{t.statusCallback&&t.statusCallback({progress:0});const n=new ArrayBuffer(4),r=new Int32Array(n,0,1),s=new Int8Array(n,0,4);if(r[0]=287454020,s[0]!==68)throw new Error("Binary STL output is currently only supported on little-endian (Intel) processors");let o=0,i=0;e.forEach((y,P)=>{bf.geom3.toPolygons(y).forEach(L=>{const k=L.vertices.length,T=k>=3?k-2:0;o+=T,i+=1})});const a=new Uint8Array(80);for(let y=0;y<80;y++)a[y]=65;const c=new Uint32Array(1);c[0]=o;const l=new ArrayBuffer(50*o),u=new Int8Array(l),d=new ArrayBuffer(50),h=new Int8Array(d),m=new Float32Array(d,0,12),w=new Uint16Array(d,48,1);let p=0;return e.forEach(y=>{bf.geom3.toPolygons(y).forEach((F,L)=>{const k=F.vertices,T=k.length,R=bf.poly3.plane(F);for(let B=0;B<T-2;B++){m[0]=R[0],m[1]=R[1],m[2]=R[2];let W=3;for(let se=0;se<3;se++){const fe=se+(se>0?B:0),ce=k[fe];m[W++]=ce[0],m[W++]=ce[1],m[W++]=ce[2]}w[0]=0,u.set(h,p),p+=50}t.statusCallback&&t.statusCallback({progress:100*L/i})})}),t.statusCallback&&t.statusCallback({progress:100}),[a.buffer,c.buffer,l]};var PB={serializeBinary:SB};const{geometries:Ep}=xt,OB=(e,t)=>{t.statusCallback&&t.statusCallback({progress:0});const n=`solid JSCAD
${CB(e,t)}
endsolid JSCAD
`;return t.statusCallback&&t.statusCallback({progress:100}),[n]},CB=(e,t)=>{const n=[];return e.forEach((r,s)=>{n.push(MB(r)),t.statusCallback&&t.statusCallback({progress:100*s/e.length})}),n.join(`
`)},MB=(e,t)=>{const n=[];return Ep.geom3.toPolygons(e).forEach((s,o)=>{n.push(LB(s))}),n.join(`
`)},xp=e=>`${e[0]} ${e[1]} ${e[2]}`,_f=e=>`vertex ${xp(e)}`,LB=e=>{const t=[];if(e.vertices.length>=3){const n=_f(e.vertices[0]);for(let r=0;r<e.vertices.length-2;r++){const s=`facet normal ${xp(Ep.poly3.plane(e))}
outer loop
${n}
${_f(e.vertices[r+1])}
${_f(e.vertices[r+2])}
endloop
endfacet`;t.push(s)}}return t.join(`
`)};var kB={serializeText:OB};const{geometries:RB,modifiers:FB}=xt,{flatten:GB,toArray:NB}=Gf,{serializeBinary:DB}=PB,{serializeText:BB}=kB,IB="application/sla",VB=(e,...t)=>{e=Object.assign({},{binary:!0,statusCallback:null},e),t=GB(t);let r=t.filter(s=>RB.geom3.isA(s));if(r.length===0)throw new Error("only 3D geometries can be serialized to STL");return t.length!==r.length&&console.warn("some objects could not be serialized to STL"),r=NB(FB.generalize({snap:!0,triangulate:!0},r)),e.binary?DB(r,e):BB(r,e)};var zB={mimeType:IB,serialize:VB};const UB=Iy(zB),om=e=>{const t=UB.serialize({binary:!0},e);return new Blob(t)},Ap=e=>Sp(e)?xt.booleans.subtract(XB(e),jB(e)):void 0,Tp=e=>Sp(e)?xt.booleans.union(HB(e),YB(e)):void 0,qB=e=>{let t=Ap(e);if(!e.generateLid)return t;let n=Tp(e),r=xt.transforms.translate([e.length+e.wallThickness+50,0,e.height/2],n);return xt.booleans.union(t,r)},XB=e=>e.usingOuterDimensions?xt.primitives.cuboid({size:[e.length,e.width,e.height-(e.generateLid?e.lidOuterThickness:0)]}):xt.primitives.cuboid({size:[e.wallThickness*2+e.length,e.wallThickness*2+e.width,e.bottomThickness+e.height+(e.generateLid?e.lidInnerThickness:0)]}),jB=e=>e.usingOuterDimensions?xt.primitives.cuboid({size:[e.length-e.wallThickness*2,e.width-e.wallThickness*2,e.height-e.bottomThickness-(e.generateLid?e.lidOuterThickness:0)],center:[0,0,e.bottomThickness/2]}):xt.primitives.cuboid({size:[e.length,e.width,e.height+(e.generateLid?e.lidInnerThickness:0)],center:[0,0,e.bottomThickness/2]}),HB=e=>e.usingOuterDimensions?xt.primitives.cuboid({size:[e.length,e.width,e.lidOuterThickness]}):xt.primitives.cuboid({size:[e.length+2*e.wallThickness,e.width+2*e.wallThickness,e.lidOuterThickness]}),YB=e=>e.usingOuterDimensions?xt.primitives.cuboid({size:[e.length-2*(e.toleranceGap+e.wallThickness),e.width-2*(e.toleranceGap+e.wallThickness),e.lidInnerThickness],center:[0,0,e.lidOuterThickness/2+e.lidInnerThickness/2]}):xt.primitives.cuboid({size:[e.length-2*e.toleranceGap,e.width-2*e.toleranceGap,e.lidInnerThickness],center:[0,0,e.lidOuterThickness/2+e.lidInnerThickness/2]}),Sp=e=>Mp(e)&&e.length>0&&e.width>0&&(e.usingOuterDimensions?e.wallThickness<e.length/2&&e.wallThickness<e.width/2:!0),Pp=e=>Cp(e)?xt.booleans.subtract(ZB(e),QB(e)):void 0,Op=e=>Cp(e)?xt.booleans.union(KB(e),JB(e)):void 0,WB=e=>{let t=Pp(e);if(!e.generateLid)return t;let n=Op(e),r=xt.transforms.translate([e.diameter+e.wallThickness+50,0,e.height/2],n);return xt.booleans.union(t,r)},ZB=e=>e.usingOuterDimensions?xt.primitives.cylinder({height:e.height,radius:e.diameter/2,segments:e.segments}):xt.primitives.cylinder({height:e.height+e.bottomThickness+(e.generateLid?e.lidInnerThickness:0),radius:e.diameter/2+e.wallThickness,segments:e.segments}),QB=e=>e.usingOuterDimensions?xt.primitives.cylinder({height:e.height-e.bottomThickness,radius:e.diameter/2-e.wallThickness,center:[0,0,e.bottomThickness/2],segments:e.segments}):xt.primitives.cylinder({height:e.height+(e.generateLid?e.lidInnerThickness:0),radius:e.diameter/2,center:[0,0,e.bottomThickness/2],segments:e.segments}),KB=e=>e.usingOuterDimensions?xt.primitives.cylinder({height:e.lidOuterThickness,radius:e.diameter/2,segments:e.segments}):xt.primitives.cylinder({height:e.lidOuterThickness,radius:e.diameter/2+e.wallThickness,segments:e.segments}),JB=e=>e.usingOuterDimensions?xt.primitives.cylinder({height:e.lidInnerThickness,radius:e.diameter/2-(e.toleranceGap+e.wallThickness),center:[0,0,e.lidOuterThickness/2+e.lidInnerThickness/2],segments:e.segments}):xt.primitives.cylinder({height:e.lidInnerThickness,radius:e.diameter/2,center:[0,0,e.lidOuterThickness/2+e.lidInnerThickness/2],segments:e.segments}),Cp=e=>Mp(e)&&e.diameter>0&&e.segments>=4&&(e.usingOuterDimensions?e.wallThickness<e.diameter/2:!0),eI=e=>{if(e.containerType===bn.Box)return Ap(e);if(e.containerType===bn.Cylinder)return Pp(e)},tI=e=>{if(e.containerType===bn.Box)return Tp(e);if(e.containerType===bn.Cylinder)return Op(e)},nI=e=>{if(e.containerType===bn.Box)return qB(e);if(e.containerType===bn.Cylinder)return WB(e)},Mp=e=>e.height>0&&e.wallThickness>0&&e.bottomThickness>0&&(e.usingOuterDimensions?e.bottomThickness<e.height:!0)&&(e.generateLid?e.lidOuterThickness>0&&e.lidInnerThickness>0&&e.toleranceGap>=0&&(e.usingOuterDimensions?e.lidOuterThickness<e.height:!0):!0),im=(e,t="model")=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)};function rI(e){let t,n,r,s,o,i,a,c,l;n=new Dy({});function u(h){e[4](h)}let d={generateBox:e[2],generateLid:e[3]};return e[0]!==void 0&&(d.parameters=e[0]),o=new d3({props:d}),jt.push(()=>cn(o,"parameters",u)),c=new Uw({props:{model:e[1]}}),{c(){t=Et("main"),_t(n.$$.fragment),r=bt(),s=Et("div"),_t(o.$$.fragment),a=bt(),_t(c.$$.fragment),dt(s,"class","container svelte-1xvngkg"),dt(t,"class","svelte-1xvngkg")},m(h,m){en(h,t,m),mt(n,t,null),Qe(t,r),Qe(t,s),mt(o,s,null),Qe(s,a),mt(c,s,null),l=!0},p(h,[m]){const w={};!i&&m&1&&(i=!0,w.parameters=h[0],an(()=>i=!1)),o.$set(w);const p={};m&2&&(p.model=h[1]),c.$set(p)},i(h){l||(it(n.$$.fragment,h),it(o.$$.fragment,h),it(c.$$.fragment,h),l=!0)},o(h){ut(n.$$.fragment,h),ut(o.$$.fragment,h),ut(c.$$.fragment,h),l=!1},d(h){h&&Ht(t),vt(n),vt(o),vt(c)}}}function sI(e,t,n){let r,s={containerType:bn.Box,length:50,width:50,height:50,diameter:50,segments:72,usingOuterDimensions:!1,wallThickness:5,bottomThickness:5,generateLid:!1,lidInnerThickness:5,lidOuterThickness:5,toleranceGap:.25};const o=()=>{const c=om(eI(s));im(c,"Container.stl")},i=()=>{const c=om(tI(s));im(c,"Lid.stl")};function a(c){s=c,n(0,s)}return e.$$.update=()=>{e.$$.dirty&1&&n(1,r=nI(s))},[s,r,o,i,a]}class oI extends In{constructor(t){super(),Bn(this,t,sI,rI,Dn,{})}}new oI({target:document.getElementById("app")});
